/*! For license information please see module.js.LICENSE.txt */
define(["lodash","app/plugins/sdk","app/core/utils/kbn","@grafana/data","app/core/time_series2","app/core/app_events"],(function(__WEBPACK_EXTERNAL_MODULE__4__,__WEBPACK_EXTERNAL_MODULE__7__,__WEBPACK_EXTERNAL_MODULE__11__,__WEBPACK_EXTERNAL_MODULE__12__,__WEBPACK_EXTERNAL_MODULE__15__,__WEBPACK_EXTERNAL_MODULE__16__){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=30)}([function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return _})),n.d(e,"g",(function(){return k})),n.d(e,"c",(function(){return x})),n.d(e,"d",(function(){return E})),n.d(e,"a",(function(){return T})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return O}));var r,a=n(1),i=n(4),s=n.n(i),o=n(6),l=n.n(o),u=n(2),c=n(10);function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,a,i=[],s=!0,o=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){o=!0,a=t}finally{try{s||null==n.return||n.return()}finally{if(o)throw a}}return i}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var y=n(13),b=["data_updated","data_processed","variables_changed","editmode_opened","editmode_closed","debug_asked","panel_closed","mapping_enabled","mapping_disabled","xcell_clicked"],_=g((function t(){m(this,t)}));r=_,_.CONF_PATH_LIBS="libs/",_.CONF_PATH_DRAWIO="libs/drawio/",_.CONF_PATH_DRAWIOJS="libs/drawio/js",_.CONF_PATH_STATIC="static/",_.CONF_PATH_PARTIALS="partials/",_.CONF_PATH_STYLES="styles/",_.CONF_FILE_PLUGINJSON="./plugin.json",_.CONF_FILE_DEFAULTDIO="static/defaultGraph.drawio",_.CONF_FILE_DEFAULTCSV="static/defaultGraph.csv",_.CONF_FILE_SHAPESTXT="static/shapes.txt",_.CONF_NAME_APPJS="app.min.js",_.CONF_NAME_INTEGRATEJS="app.min.js",_.CONF_NAME_SHAPESJS="shapes.min.js",_.CONF_NAME_VIEWERJS="viewer.min.js",_.CONF_NAME_STATIC_VIEWERJS="viewer-static.min.js",_.CONF_DEFAULT_DRAWIOJS=r.CONF_NAME_STATIC_VIEWERJS,_.CONF_FILE_DRAWIOLIB="".concat(r.CONF_PATH_DRAWIOJS,"/").concat(r.CONF_DEFAULT_DRAWIOJS),_.CONF_FILE_PRECONFIGJS="libs/drawio/js/PreConfig.js",_.CONF_FILE_POSTCONFIGJS="libs/drawio/js/PostConfig.js",_.CONF_FILE_VERSION="VERSION",_.CONF_TOOLTIPS_DELAY=200,_.CONF_GRAPHHOVER_DELAY=50,_.CONF_COLORS_STEPS=5,_.CONF_COLORS_MS=50,_.CONF_ANIMS_STEP=10,_.CONF_ANIMS_MS=50,_.CONF_GFMESSAGE_MS=5e3,_.CONF_BLINK_COLOR="#f5f242",_.CONF_HIGHTLIGHT_COLOR="#99ff33",_.CONF_EDITOR_URL="https://embed.diagrams.net/",_.CONF_EDITOR_THEME="kennedy",_.VAR_STG_SHAPES="shapestext",_.VAR_TBL_SHAPES="shapesarray",_.VAR_STR_VIEWERJS="viewer.min.js",_.VAR_STR_SHAPESJS="shapes.min.js",_.VAR_NUM_GHTIMESTAMP="graph-hover-timestamp",_.VAR_MAP_INTERVAL="interval",_.VAR_MAP_TIMEOUT="timeout",_.VAR_STR_RULENAME="_rule",_.VAR_NUM_LEVEL="_level",_.VAR_NUM_VALUE="_value",_.VAR_STR_FORMATED="_formated",_.VAR_STR_COLOR="_color",_.VAR_STR_DATE="_date",_.VAR_STR_METRIC="_metric",_.VAR_GF_TRACE_PERF=!0,_.MXGRAPH_STYLES_COLOR=["fillColor","strokeColor","gradientColor","fontColor","labelBackgroundColor","labelBorderColor","imageBorder","imageBackground"],_.MXGRAPH_STYLES_EVENT_ANIM=["barPos","gaugePos","fontSize","opacity","textOpacity","rotation"],_.MXGRAPH_STYLES_EVENT_STATIC=["shape","endArrow","startArrow","flipH","flipV","gradientDirection","image"],_.MXGRAPH_STYLES_EVENT=[].concat(d(r.MXGRAPH_STYLES_EVENT_ANIM),d(r.MXGRAPH_STYLES_EVENT_STATIC)),_.MXGRAPH_STYLES_ANIM=[].concat(d(r.MXGRAPH_STYLES_COLOR),d(r.MXGRAPH_STYLES_EVENT_ANIM)),_.MXGRAPH_STYLES_STATIC=d(r.MXGRAPH_STYLES_EVENT_STATIC),_.MXGRAPH_STYLES=[].concat(d(r.MXGRAPH_STYLES_ANIM),d(r.MXGRAPH_STYLES_STATIC)),_.COMP_LT="lt",_.COMP_LE="le",_.COMP_EQ="eq",_.COMP_NE="ne",_.COMP_GE="ge",_.COMP_GT="gt",_.COMP_AL="al",_.TOOLTIP_APPLYON=[{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],_.COLOR_APPLYON=[{text:"Never",value:"n"},{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],_.TEXT_APPLYON=[{text:"Never",value:"n"},{text:"When Metric Displayed",value:"wmd"},{text:"Warning / Critical",value:"wc"},{text:"Critical Only",value:"co"}],_.LINK_APPLYON=[{text:"Warning / Critical",value:"wc"},{text:"Always",value:"a"}],_.VALUE_TYPES=[{text:"Number",value:"number"},{text:"String",value:"string"},{text:"Date",value:"date"}],_.METRIC_TYPES=[{text:"Series",value:"serie"},{text:"Table",value:"table"}],_.SOURCE_TYPES=[{text:"XML",value:"xml"},{text:"CSV",value:"csv"}],_.DIOTHEME_TYPES=[{text:"Dark",value:"dark"},{text:"Light",value:"kennedy"},{text:"Mobile",value:"minimal"},{text:"atlas",value:"atlas"}],_.IDENT_TYPES=[{text:"Id",value:"id"},{text:"Label",value:"value"},{text:"Metadata",value:"metadata"}],_.AGGREGATION_TYPES=[{text:"First",value:"first"},{text:"First (not null)",value:"first_notnull"},{text:"Last",value:"current"},{text:"Last (not null)",value:"current_notnull"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Sum",value:"total"},{text:"Avg",value:"avg"},{text:"Count",value:"count"},{text:"Delta",value:"delta"},{text:"Range",value:"range"},{text:"Diff",value:"diff"},{text:"Time of last point",value:"last_time"}],_.TOOLTIP_GRAPH_TYPES=[{text:"Line",value:"line"},{text:"Histogram",value:"bar"}],_.TOOLTIP_GRAPH_SCALE_TYPES=[{text:"Linear",value:"linear"},{text:"Logarithmic",value:"log"}],_.TOOLTIP_GRAPH_SIZE_TYPES=[{text:"Adjustable",value:"100%"},{text:"Small",value:"100px"},{text:"Medium",value:"200px"},{text:"Large",value:"400px"}],_.TOOLTIP_DIRECTION_TYPES=[{text:"Vertical",value:"v"},{text:"Horizontal ",value:"h"}],_.COMPARATOR_TYPES=[{text:"Always",value:"al"},{text:"Less than",value:"lt"},{text:"Less than or equal to",value:"le"},{text:"Equal to",value:"eq"},{text:"Not equal to",value:"ne"},{text:"Greater than or equal to",value:"ge"},{text:"Greater than ",value:"gt"}],_.VALUE_DATEFORMAT_TYPES=[{text:"YYYY-MM-DD HH:mm:ss",value:"YYYY-MM-DD HH:mm:ss"},{text:"YYYY-MM-DD HH:mm:ss.SSS",value:"YYYY-MM-DD HH:mm:ss.SSS"},{text:"MM/DD/YY h:mm:ss a",value:"MM/DD/YY h:mm:ss a"},{text:"MMMM D, YYYY LT",value:"MMMM D, YYYY LT"},{text:"YYYY-MM-DD",value:"YYYY-MM-DD"}],_.VALUEMAPPINGTYPES=[{text:"Value to text",value:1},{text:"Range to text",value:2}],_.TEXTMETHODS=[{text:"All content",value:"content"},{text:"Substring",value:"pattern",placeholder:"/RegEx/"},{text:"Append (Space) ",value:"as"},{text:"Append (New line) ",value:"anl"}],_.COLORMETHODS=[{text:"Shape Stroke/Border",value:"strokeColor"},{text:"Shape Fill",value:"fillColor"},{text:"Shape Gradient",value:"gradientColor"},{text:"Label font color",value:"fontColor"},{text:"Label background color",value:"labelBackgroundColor"},{text:"Label border color",value:"labelBorderColor"},{text:"Image background",value:"imageBackground"},{text:"Image border",value:"imageBorder"}],_.EVENTMETHODS=[{text:"Shape : Change form (text)",value:"shape",type:"text",placeholder:"Shape name"},{text:"Shape : Rotate Shape (0-360)",value:"rotation",type:"number",placeholder:"0-360",default:0},{text:"Shape : Blink (frequence ms)",value:"blink",type:"number",placeholder:"Number in ms",default:500},{text:"Shape : Hide/Show (0|1)",value:"visibility",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Shape : Height (number)",value:"height",type:"number",placeholder:"Number of px"},{text:"Shape : Width (number)",value:"width",type:"number",placeholder:"Number of px"},{text:"Shape : Resize (percent)",value:"size",type:"number",placeholder:"percent"},{text:"Shape : Opacity (0-100)",value:"opacity",type:"number",placeholder:"0-100",default:100},{text:"Shape : Gradient direction",value:"gradientDirection",type:"text",placeholder:"Direction name",default:"south",typeahead:"south|east|north|west"},{text:"Shape : Collapse/Expande (0|1)",value:"fold",type:"number",placeholder:"0 or 1",typeahead:"0|1",default:"1"},{text:"Shape : Change position in Bar (0-100)",value:"barPos",type:"number",placeholder:"0-100"},{text:"Shape : Change position in Gauge (0-100)",value:"gaugePos",type:"number",placeholder:"0-100"},{text:"Shape : Flip horizontally (0|1)",value:"flipH",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Shape : Flip vertically (0|1)",value:"flipV",type:"number",placeholder:"0 or 1",typeahead:"0|1"},{text:"Arrow : change start marker (text)",value:"startArrow",type:"text",placeholder:"Marker",typeahead:"none|classic|classicThin|block|blockThin|open|openThin|oval|diamond|diamondThin|openAsync|async|box|halfCircle|dash|cross|circlePlus|circle|ERone|ERmandOne|ERoneToMany|ERzeroToOne"},{text:"Arrow : change end marker (text)",value:"endArrow",type:"text",placeholder:"Marker",typeahead:"none|classic|classicThin|block|blockThin|open|openThin|oval|diamond|diamondThin|openAsync|async|box|halfCircle|dash|cross|circlePlus|circle|ERone|ERmandOne|ERoneToMany|ERzeroToOne"},{text:"Arrow : Anime flow (frequence ms)",value:"class_mxEdgeFlow",type:"number",placeholder:"Number in ms"},{text:"Label : Replace text (text)",value:"text",type:"text",placeholder:"Text"},{text:"Label : Font Size (numeric)",value:"fontSize",type:"number",placeholder:"Number"},{text:"Label : Opacity (numeric)",value:"textOpacity",type:"number",placeholder:"0-100",default:100},{text:"Image : Change URL (text)",value:"image",type:"text",placeholder:"Url"},{text:"Tooltip : Add/Change tooltip text",value:"tpText",type:"text",placeholder:"text"},{text:"Tooltip : Add/Change metadata key and value",value:"tpMetadata",type:"text",placeholder:"key@value"}],_.LOCALVARIABLENAMES=[{text:"Name of the rule",value:r.VAR_STR_RULENAME},{text:"Current date",value:r.VAR_STR_DATE},{text:"Current color according to the thresholds",value:r.VAR_STR_COLOR},{text:"Current raw value according to the aggregation",value:r.VAR_NUM_VALUE},{text:"Current level according to the thresholds",value:r.VAR_NUM_LEVEL},{text:"Current formated value accordingto the type",value:r.VAR_STR_FORMATED}];var w,k=function(){function t(){m(this,t),this._variables=new Map}return g(t,[{key:"set",value:function(t,e){return this._variables.set(t,e),this}},{key:"unset",value:function(t){return this._variables.delete(t),this}},{key:"get",value:function(t){return this._variables.get(t)}},{key:"keys",value:function(){return Array.from(this._variables.keys())}},{key:"getFullVarsNames",value:function(t){return t.getGrafanaVars().concat(this.getVarsNames())}},{key:"getVarsNames",value:function(){return this.keys().map((function(t){return"${"+t+"}"}))}},{key:"clear",value:function(){return this._variables.clear(),this}},{key:"replaceText",value:function(t){try{var e=E.getTemplateSrv();t=e&&e.replace?e.replace(t):t;var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}(this._variables);try{for(r.s();!(n=r.n()).done;){var a=h(n.value,2),i=a[0],s=a[1];t=t.replace("${"+i+"}",s)}}catch(t){r.e(t)}finally{r.f()}}catch(e){return t}return t}},{key:"eval",value:function(t){var e=this.replaceText(t);try{return y(e)}catch(t){return e}}}],[{key:"create",value:function(){return new t}},{key:"getAvailableLocalVarNames",value:function(){return _.LOCALVARIABLENAMES.map((function(t){return"${"+t.value+"}"}))}}]),t}();!function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR"}(w||(w={}));var x=function(){function t(){m(this,t)}return g(t,null,[{key:"isEnable",value:function(e){return void 0!==t.logEnable&&!0===t.logEnable&&void 0!==t.logLevel&&e>=t.logLevel}},{key:"debug",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isEnable(w.DEBUG)&&(a=n.shift(),(r=console).log.apply(r,["GF DEBUG : ".concat(a)].concat(n)));case 1:case"end":return e.stop()}}),e)})))}},{key:"warn",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isEnable(w.WARN)&&(a=n.shift(),(r=console).log.apply(r,["GF WARN : ".concat(a)].concat(n)));case 1:case"end":return e.stop()}}),e)})))}},{key:"info",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isEnable(w.INFO)&&(a=n.shift(),(r=console).log.apply(r,["GF INFO : ".concat(a)].concat(n)));case 1:case"end":return e.stop()}}),e)})))}},{key:"error",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isEnable(w.ERROR)&&(a=n.shift(),(r=console).log.apply(r,["GF ERROR : ".concat(a)].concat(n)));case 1:case"end":return e.stop()}}),e)})))}}]),t}();x.logLevel=w.WARN,x.logEnable=!0,x.tagEnable=!1;var E=function(){function e(){m(this,e)}return g(e,null,[{key:"init",value:function(n,r,a){n.GFPlugin=this,a.GFPlugin=this,e.contextRoot=e.defaultContextRoot,e.templateSrv=r,void 0===n?e.contextRoot=t:this.contextRoot=n.$root.appSubUrl+this.defaultContextRoot}},{key:"getTemplateSrv",value:function(){return e.templateSrv}},{key:"getRepo",value:function(){var t="";return e.data.info.links.forEach((function(e){"Documentation"===e.name&&(t=e.url)})),t}},{key:"getVersion",value:function(){return e.data.info.version}},{key:"getRootPath",value:function(){return e.contextRoot}},{key:"getLibsPath",value:function(){return"".concat(e.getRootPath(),"libs")}},{key:"getDrawioPath",value:function(){return"".concat(e.getLibsPath(),"/drawio/")}},{key:"getStaticPath",value:function(){return"".concat(e.getRootPath(),"/static/")}},{key:"getMxBasePath",value:function(){return"".concat(e.getDrawioPath(),"mxgraph/")}},{key:"getMxStylePath",value:function(){return"".concat(e.getDrawioPath(),"styles/")}},{key:"getShapesPath",value:function(){return"".concat(e.getDrawioPath(),"/shapes/")}},{key:"getPartialPath",value:function(){return"".concat(e.getRootPath(),"partials/")}},{key:"getStencilsPath",value:function(){return"".concat(e.getDrawioPath(),"/stencils/")}},{key:"getMxCssPath",value:function(){return"".concat(e.getDrawioPath(),"styles/")}},{key:"getMxResourcePath",value:function(){return"".concat(e.getMxBasePath(),"css/")}},{key:"getMxImagePath",value:function(){return"".concat(e.getMxBasePath(),"images/")}}]),e}();E.data=n(19),E.defaultContextRoot="/public/plugins/agenty-flowcharting-panel/",E.initialized=!1;var T=function(){function t(){m(this,t),this.uid="GFGlobal-".concat(Object(c.a)()),this._globalvars=k.create(),this.DEBUG=!1,this.notify=function(t,e){},this.clearNotify=function(){},this.$refresh=function(){},this.events=u.a.create(b),this.callBackMapping=null,this.init()}return g(t,[{key:"debug",value:function(){this.events.emit("debug_asked")}},{key:"init",value:function(){this.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),this.events.connect("panel_closed",this,this._on_global_panel_closed.bind(this))}},{key:"free",value:function(){this.events.disconnect("debug_asked",this),this.events.disconnect("panel_closed",this)}},{key:"resolveVars",value:function(t){return this._getGlobalVars().replaceText(t)}},{key:"getTheme",value:function(){var t=E.getTemplateSrv;return void 0!==t?t.style:"dark"}},{key:"enableMapping",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t!==this.ctrl.onMapping&&(t&&this.events.emit("mapping_enabled"),t||(this.callBackMapping=null,this.events.disconnect("xcell_clicked",this),this.events.emit("mapping_disabled")))}},{key:"setMappingCallBack",value:function(t){this.callBackMapping=t,this.events.connect("xcell_clicked",this,this._on_global_xcell_clicked.bind(this)),this.enableMapping(!0)}},{key:"isMappingMode",value:function(){return this.ctrl.onMapping}},{key:"_getGlobalVars",value:function(){return this._globalvars}},{key:"getGrafanaVars",value:function(){var t=E.getTemplateSrv();return null!=t?s.a.map(t.variables,(function(t){return"${".concat(t.name,"}")})):[]}},{key:"getVar",value:function(t){return this._getGlobalVars().get(t)}},{key:"setVar",value:function(t,e){this._getGlobalVars().set(t,e)}},{key:"unsetVar",value:function(t){this._getGlobalVars().unset(t)}},{key:"getFullAvailableVarNames",value:function(){return k.getAvailableLocalVarNames().concat(this.getGrafanaVars())}},{key:"GetT4V",value:function(t,e){if(t)for(var n=0;n<t.length;n++){var r=t[n];if(r.value===e)return r.text}return"No text "}},{key:"popover",value:function(t,e,n){var r=E.getRepo(),a="".concat(r,"images/"),i=String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),s="".concat(i),o="",l="";return e&&(o='<a href="'.concat(r).concat(e,'" target="_blank"><i class="fa fa-book fa-fw"></i>Help</a>')),n&&(l='<a href="'.concat(a).concat(n,'.png" target="_blank"><i class="fa fa-image fa-fw"></i>Example</a>')),'\n    <div id="popover" style="display:flex;flex-wrap:wrap;width: 100%;">\n      <div style="flex:1;height:100px;margin-bottom: 20px;">'.concat(s,'</div>\n      <div style="flex:1;height:100px;margin-bottom: 20px;">').concat(o,'</div>\n      <div style="flex-basis: 100%;height:100px;margin-bottom:20px;">').concat(l,"</div>\n    </div>")}},{key:"_on_global_debug_asked",value:function(){t.constructor.name}},{key:"_on_global_panel_closed",value:function(){this.constructor.name,this.free()}},{key:"_on_global_xcell_clicked",value:function(t){this.constructor.name,this.ctrl.onMapping&&this.callBackMapping&&this.callBackMapping&&(Array.isArray(this.callBackMapping)?this.callBackMapping.forEach((function(e){return e(t)})):this.callBackMapping(t),this.enableMapping(!1))}}],[{key:"create",value:function(e,n,r,a){var i=new t;return E.init(e,n,a),e.$GF=i,i.DEBUG,i.ctrl=a,i.notify=a.notify.bind(a),i.clearNotify=a.clearNotify.bind(a),i.$refresh=e.$applyAsync.bind(e),i}},{key:"genUid",value:function(t){var e=Object(c.a)();return t?"".concat(t,"-").concat(e):e}},{key:"createGFTable",value:function(t,e){return new S(t,e)}},{key:"stringToRegEx",value:function(t){try{if("/"!==t.charAt(0))return new RegExp("^".concat(t,"$"));var e=t.match(new RegExp("^/(.*?)/(g?i?m?y?)$"));if(e)return new RegExp(e[1],e[2])}catch(t){return null}return null}},{key:"matchString",value:function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!n||0===e.length||"string"==typeof n&&0===n.length)return!1;if(e===n)return!0;if(n instanceof RegExp)return n.test(e);if(n&&!0===r){var a=t.stringToRegEx(n);if(a)return a.test(e)}return!1}},{key:"setFocus",value:function(t){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,setTimeout((function(){var e=document.getElementById(t);e&&e.focus()}),100),e.abrupt("return",!0);case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))}},{key:"calculateIntervalCounter",value:function(t,e,n){var r,a,i=[];if(void 0!==t&&void 0!==e){var s=e-t;r=Math.round(s/n),a=t}else r=void 0;var o=0;for(o=0;o<n;o++)void 0!==r?a+=r:a=void 0,i.push(a);return i[o]=e,i}},{key:"getCurrentDate",value:function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+"-"+t.getDate().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+" "+t.getHours().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+":"+t.getMinutes().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})+":"+t.getSeconds().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})}},{key:"calculateRatioForValue",value:function(t,e,n){if(n<t||n>e)throw new Error("Cannot calculate ratio for value ".concat(n," because value is less than ").concat(t," or greater than ").concat(e));return(n-t)/(e-t)}},{key:"calculateValueForRatio",value:function(t,e,n){return t+(e-t)*n}},{key:"calculateColorForRatio",value:function(t,e,n){var r=e;try{r=l.a.scale([t,e]).mode("lrgb")(n).hex()}catch(t){r=e}return r}},{key:"loadFile",value:function(t){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.text();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Can't load file ".concat(t," : ").concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))}}]),t}();T.graphHover=!1,T.GHTimeStamp=0,T.utils=n(20);var S=function(){function t(e,n){m(this,t),this.pressed=!1,this.indexTable=0,this.startX=0,this.startWidth=0,this.tableData=e,this.tableDiv=n}return g(t,[{key:"getWidth",value:function(t){return this.getColumnProperty(t,"width")}},{key:"getLeft",value:function(t){var e=0,n=!1;return this.tableData.columns.forEach((function(r){r.id!==t&&!1===n&&(e+=parseInt(r.width,10)),r.id===t&&(n=!0)})),"".concat(e,"px")}},{key:"getStyle",value:function(t){var e="";if(this.haveProperty(t,"width")){var n=this.getColumnProperty(t,"width");e="".concat(e,"width: ").concat(n,";")}if(this.haveProperty(t,"align")){var r=this.getColumnProperty(t,"align");e="".concat(e,"text-align: ").concat(r,";")}return e}},{key:"getIndex",value:function(t){return this.getColumnProperty(t,"index")}},{key:"getId",value:function(t){return this.getColumnProperty(t,"id")}},{key:"getLabel",value:function(t){return this.getColumnProperty(t,"label")}},{key:"getDesc",value:function(t){return this.getColumnProperty(t,"desc")}},{key:"getColumnProperty",value:function(t,e){for(var n="No value for property ".concat(e),r="number"==typeof t,a=0;a<this.tableData.columns.length;a++){var i=this.tableData.columns[a];if(r&&t===i.index||!r&&t===i.id)return i[e]}return n}},{key:"haveProperty",value:function(t,e){for(var n="number"==typeof t,r=0;r<this.tableData.columns.length;r++){var a=this.tableData.columns[r];if(n&&t===a.index||!n&&t===a.id)return void 0!==a[e]&&null!==a[e]}return!1}},{key:"setColumnProperty",value:function(t,e,n){for(var r="number"==typeof t,a=0;a<this.tableData.columns.length;a++){var i=this.tableData.columns[a];if(r&&t===i.index||!r&&t===i.id){e in i&&(i[e]=n)}}return this}},{key:"findTableDiv",value:function(t){if(null!=t)for(var e=t;null!==e&&void 0===this.tableDiv;)e.classList.contains("gf-table-main")?this.tableDiv=e:e=e.parentElement;return this.tableDiv}},{key:"setTableDiv",value:function(t){this.tableDiv=t}},{key:"onMouseMove",value:function(t){var e=this;if(this.pressed&&this.headerTable&&this.headerTable.parentNode){var n=t.pageX-this.startX,r=this.startWidth+n;if(r<10&&(r=10),this.headerTable.style.width="".concat(r,"px"),this.bodyTable){var a=this.bodyTable.querySelectorAll(".gf-table-rows-resizable");Array.from(a).forEach((function(t){var n=t.querySelectorAll(".gf-table-cells-resizable"),a=0;n.forEach((function(t){var n=t;a===e.indexTable&&(n.style.width="".concat(r,"px"),e.setColumnProperty(a,"width","".concat(r,"px"))),a+=1}))}))}}}},{key:"onMouseDown",value:function(t){if(this.pressed=!0,this.startX=t.pageX,this.headerTable=t.currentTarget.parentElement,this.headerTable)if(this.tableDiv||this.findTableDiv(this.headerTable),this.headerTable.parentNode&&(this.indexTable=Array.from(this.headerTable.parentNode.children).indexOf(this.headerTable)),this.headerTable.classList.add("gf-resizing"),this.startWidth=parseInt(this.headerTable.style.width,10),this.tableDiv){var e=this.tableDiv.getElementsByClassName("gf-table-body")[0];this.bodyTable=e}else x.error("Unable to find table definition with class gf-table-main")}},{key:"onMouseUp",value:function(t){this.pressed=!1,this.headerTable&&this.headerTable.classList.remove("gf-resizing")}}]),t}(),O=function(){function t(e){m(this,t),this._iteration=0,this._cyclic=!1,this._currentStep=0,this._finished=!1,void 0===t._timers&&(t._timers=new Map),this._steps=[],this.uid=e}return g(t,[{key:"getUid",value:function(){return this.uid}},{key:"isFinished",value:function(){if(this._finished)return!0;if(this._cyclic)return!1;var t=!0;return this._steps.forEach((function(e){t=t&&e.runned})),t}},{key:"setCyclic",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._cyclic=t,this._iteration=0,this}},{key:"setIteration",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._iteration=t,this._cyclic=!1,this}},{key:"_reinit",value:function(){return this._currentStep=0,this._steps.forEach((function(t){t.runned=!1,t.invalidated=!1})),this}},{key:"cancel",value:function(){return this._steps.forEach((function(e){t._cleanStep(e)})),this._finished=!0,this}},{key:"_getDefaultStepOption",value:function(){return{step:this._steps.length,fn:function(){},ms:1e3,running:!1,runned:!1,invalidated:!1,tmId:0}}},{key:"addStep",value:function(t,e){var n=this._getDefaultStepOption();return n.fn=t,n.ms=e,this._steps.push(n),this}},{key:"start",value:function(){var t=this;return Promise.all(this._steps.map((function(e){return Object(a.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.tmId=window.setTimeout(this._runnable.bind(this,e),e.ms);case 1:case"end":return t.stop()}}),t,this)})))})))}},{key:"_runnable",value:function(e){if(!1===e.invalidated){e.running=!0;try{for(var n=this._currentStep;n<e.step;n++)t._cleanStep(this._steps[n]);e.fn()}catch(t){x.warn("Failed to run fn",t)}this._currentStep=e.step,e.running=!1,e.runned=!0,e.step===this._steps.length-1&&(this._cyclic||this._iteration>1?(this._reinit(),this._iteration>0&&(this._iteration=this._iteration-1),this.start()):t._timers.delete(this.uid))}}}],[{key:"stop",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t._timers||(t._timers=new Map),"string"!=typeof e){n.next=6;break}if(r=t.get(e)){n.next=5;break}return n.abrupt("return");case 5:e=r;case 6:if(!e){n.next=11;break}e.cancel(),t._timers.delete(e.uid),n.next=14;break;case 11:return i=Array.from(t._timers.values()),n.next=14,Promise.all(i.map((function(t){return Object(a.a)(s,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.cancel();case 1:case"end":return e.stop()}}),e)})))}))).finally((function(){t._timers.clear()}));case 14:case"end":return n.stop()}}),n)})))}},{key:"_cleanStep",value:function(e){void 0!==e&&!1===e.invalidated&&!1===e.runned&&(e.invalidated=!0,t._stopTimeOut(e.tmId))}},{key:"_stopTimeOut",value:function(t){try{void 0!==t&&window.clearTimeout(t)}catch(e){x.warn("Failed to clear timeout thread",t,e)}}},{key:"create",value:function(e){e||(e=T.genUid()),t.stop(e);var n=new t(e);return t._timers.set(e,n),n}},{key:"get",value:function(e){if(t._timers){var n=t._timers.get(e);return n||null}return null}}]),t}()}).call(this,"/")},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));function r(t,e,n,r){return new(n||(n=Promise))((function(a,i){function s(t){try{l(r.next(t))}catch(t){i(t)}}function o(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))}Object.create;Object.create},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._declaredSignals=[],this._connectedChilds=new Map}var e,n,i;return e=t,i=[{key:"create",value:function(e,n){var r=new t;return e&&r.declare(e),r}}],(n=[{key:"declare",value:function(t,e){var n=this;return e&&(this._owner=e.uid),Array.isArray(t)?(t.forEach((function(t){n.declare(t)})),this):("string"!=typeof t||this._haveDeclaredSignal(t)||this._declaredSignals.push(t),this)}},{key:"countSignal",value:function(){return this._declaredSignals.length}},{key:"clear",value:function(){this._connectedChilds.clear(),this._declaredSignals=[]}},{key:"connect",value:function(t,e,n){var r;if(!("uid"in e))throw new Error("".concat(e.toString()," have no uid property"));if(!this._haveDeclaredSignal(t))throw new Error("".concat(this.toString()," have no declared signal ").concat(t));"[".concat(e.uid,"] connect on [").concat(t,"] to [").concat(null!==(r=this._owner)&&void 0!==r?r:"?????","]");var a=e.uid,i=n,s=this._connectedChilds.get(t);return s||(s=new Map,this._connectedChilds.set(t,s)),s.set(a,i),!0}},{key:"isConnected",value:function(t,e){var n=this._connectedChilds.get(t);return!!n&&n.has(e.uid)}},{key:"disconnect",value:function(t,e){if(this._haveDeclaredSignal(t)&&"uid"in e){var n=e.uid,r=this._connectedChilds.get(t);r&&r.delete(n)}}},{key:"emit",value:function(t,e,n){var a=this;"Emit signal [".concat(t,"]").concat(n?" from ["+n.uid+"]":"");var i=this._getCallableFunc(t);return Promise.all(i.map((function(t){return Object(r.a)(a,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t(e),n.abrupt("return",r);case 2:case"end":return n.stop()}}),n)})))})))}},{key:"_haveDeclaredSignal",value:function(t){return this._declaredSignals.includes(t)}},{key:"_getCallableFunc",value:function(t){if(!this._haveDeclaredSignal(t))return[];var e=this._connectedChilds.get(t);return e?Array.from(e.values()):[]}}])&&a(e.prototype,n),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}()},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return v}));var r=n(1),a=n(0),i=n(8),s=n(17),o=n(2);function l(t,e,n){return(l=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var a=new(Function.bind.apply(t,r));return n&&c(a,n.prototype),a}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=n(27),v=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,o,u;return n=e,u=[{key:"init",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._GFInitialized=!0,this.options=Object.assign(this._getDefaultRequiredOptions(),t),e._libInitialized||!e.options.libLoad){n.next=4;break}return n.abrupt("return",e.loadEngine());case 4:return n.abrupt("return");case 5:case"end":return n.stop()}}),n,this)})))}},{key:"isInitalized",value:function(){return e._libInitialized}},{key:"loadEngine",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._libInitialized){t.next=2;break}return t.abrupt("return");case 2:return e._GFInitialized||e.init({libLoad:!1}),n=new Promise((function(){})),"local"===e.options.mode&&(n=e._loadLocal()),"server"===e.options.mode&&(n=e._loadServer()),t.abrupt("return",n.then((function(t){return Object(r.a)(a,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("string"!=typeof t){n.next=9;break}return n.next=3,e._preLoad();case 3:return n.next=5,e._evalLib(t);case 5:return n.next=7,e._customization();case 7:return n.next=9,e._postLoad();case 9:return n.abrupt("return");case 10:case"end":return n.stop()}}),n)})))})));case 8:case"end":return t.stop()}}),t)})))}},{key:"getTemplate",value:function(t){if("xml"===t)return e.getXmlTemplate();if("csv"===t)return e.getCsvTemplate();throw new Error("Unknown type ".concat(t))}},{key:"getXmlTemplate",value:function(){if(e._xmlTemplate)return e._xmlTemplate;var t="".concat(a.d.getRootPath()).concat(a.b.CONF_FILE_DEFAULTDIO);return e.loadFile(t).then((function(t){return e._xmlTemplate=t,t}))}},{key:"getCsvTemplate",value:function(){if(e._csvTemplate)return e._csvTemplate;var t="".concat(a.d.getRootPath()).concat(a.b.CONF_FILE_DEFAULTCSV);return e.loadFile(t).then((function(t){return e._csvTemplate=t,t}))}},{key:"loadFile",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.text();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Can't load file ".concat(t," : ").concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))}},{key:"_getDefaultRequiredOptions",value:function(){return{mode:"server",libLoad:!0,libLocal:"./src/".concat(a.b.CONF_FILE_DRAWIOLIB),libServer:"".concat(a.d.getRootPath(),"/").concat(a.b.CONF_FILE_DRAWIOLIB)}}},{key:"_loadLocal",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.options.libLocal?this.options.libLocal:"",t.abrupt("return",new Promise((function(t,n){Object(s.readFile)(e,(function(e,n){t(n.toString())}))})));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_evalLib",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.options.mode,globalThis.eval(t),e._libInitialized=!0,e.events.emit("drawio_initialized");case 3:case"end":return n.stop()}}),n)})))}},{key:"_loadServer",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._libInitialized||!this.options.libServer){t.next=3;break}return e=this.options.libServer,t.abrupt("return",fetch(e).then((function(t){return t.text()})).catch((function(t){})));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_customization",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.customize(),mxTooltipHandler.prototype.delay=a.b.CONF_TOOLTIPS_DELAY;case 2:case"end":return t.stop()}}),t)})))}},{key:"_preLoad",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=globalThis).BASE_PATH=a.d.getMxBasePath(),e.RESOURCES_PATH=a.d.getMxResourcePath(),e.RESOURCE_BASE=a.d.getMxResourcePath(),e.STENCIL_PATH=a.d.getStencilsPath(),e.SHAPES_PATH=a.d.getShapesPath(),e.IMAGE_PATH=a.d.getMxImagePath(),e.STYLE_PATH=a.d.getMxStylePath(),e.CSS_PATH=a.d.getMxCssPath(),e.mxLanguages=["en"],e.DRAWIO_BASE_URL=a.d.getDrawioPath(),e.DRAW_MATH_URL=a.d.getDrawioPath(),e.DRAWIO_VIEWER_URL=a.d.getDrawioPath()+"viewer.min.js",e.DRAW_MATH_URL=a.d.getDrawioPath()+"math/",e.DRAWIO_CONFIG=null,n={sync:"none",lightbox:"1",nav:"1",local:"1",embed:"1",ui:"min"},e.urlParams=n,e.mxImageBasePath=a.d.getMxImagePath(),e.mxBasePath=a.d.getMxBasePath(),e.mxLoadStylesheets=!0,e.mxLanguage="en",e.mxLoadResources=!0;case 22:case"end":return t.stop()}}),t)})))}},{key:"_postLoad",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=globalThis).mxClient.mxBasePath=a.d.getMxBasePath(),e.mxClient.mxImageBasePath=a.d.getMxImagePath(),e.mxClient.mxLoadResources=!0,e.mxClient.mxLanguage="en",e.mxClient.mxLoadStylesheets=!0,e.VSD_CONVERT_URL=null,e.EMF_CONVERT_URL=null,e.ICONSEARCH_PATH=null;case 9:case"end":return t.stop()}}),t)})))}},{key:"parseXml",value:function(t){return(new DOMParser).parseFromString(t,"text/xml")}},{key:"getTextContent",value:function(t){return null!=t?t[void 0===t.hasOwnProperty("textContent")?"text":"textContent"]:""}},{key:"isValidXml",value:function(t){try{var n=document.createElement("div"),r=new Graph(n);e.isEncoded(t)&&(t=e.decode(t));var i=mxUtils.parseXml(t),s=new mxCodec(i);return r.getModel().beginUpdate(),s.decode(i.documentElement,r.getModel()),r.getModel().endUpdate(),r.destroy(),!0}catch(t){return a.c.error("isValidXml",t),!1}}},{key:"decode",value:function(e){try{var n=this.parseXml(e).documentElement;if(null!=n&&"mxfile"===n.nodeName){var r=n.getElementsByTagName("diagram");r.length>0&&(e=this.getTextContent(r[0]))}}catch(t){throw new Error("parseXml : Unable to decode")}if((e=t.from(e,"base64").toString("binary")).length>0)try{e=Object(i.inflateRaw)(Uint8Array.from(e,(function(t){return t.charCodeAt(0)})),{to:"string"})}catch(t){throw new Error("Pako : Unable to decode")}try{e=decodeURIComponent(e)}catch(t){return a.c.error("Unable to decode ".concat(e)),""}return e}},{key:"encode",value:function(e){try{e=encodeURIComponent(e)}catch(t){return void a.c.error("Unable to encode/encodeURIComponent : ".concat(e),t)}if(e.length>0)try{var n=Object(i.deflateRaw)(e);e=String.fromCharCode.apply(null,l(Array,h(n)))}catch(t){return a.c.error("Unable to encode ".concat(e)),""}try{e=t.from(e,"binary").toString("base64")}catch(t){return void a.c.error("Unable to encode ".concat(e))}return e}},{key:"isEncoded",value:function(t){try{if(""===e.decode(t))return!1}catch(t){return!1}return!0}}],(o=null)&&f(n.prototype,o),u&&f(n,u),Object.defineProperty(n,"prototype",{writable:!1}),e}();v._GFInitialized=!1,v._libInitialized=!1,v.events=o.a.create(["drawio_initialized"])}).call(this,n(23).Buffer)},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__4__},function(t,e,n){t.exports=function(){"use strict";var t=6e4,e=36e5,n="millisecond",r="second",a="minute",i="hour",s="day",o="week",l="month",u="quarter",c="year",h="date",d="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},g=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},m={s:g,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),a=n%60;return(e<=0?"+":"-")+g(r,2,"0")+":"+g(a,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),a=e.clone().add(r,l),i=n-a<0,s=e.clone().add(r+(i?-1:1),l);return+(-(r+(n-a)/(i?a-s:s-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:c,w:o,d:s,D:h,h:i,m:a,s:r,ms:n,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},y="en",b={};b[y]=v;var _=function(t){return t instanceof E},w=function t(e,n,r){var a;if(!e)return y;if("string"==typeof e){var i=e.toLowerCase();b[i]&&(a=i),n&&(b[i]=n,a=i);var s=e.split("-");if(!a&&s.length>1)return t(s[0])}else{var o=e.name;b[o]=e,a=o}return!r&&a&&(y=a),a||!r&&y},k=function(t,e){if(_(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new E(n)},x=m;x.l=w,x.i=_,x.w=function(t,e){return k(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var E=function(){function v(t){this.$L=w(t.locale,null,!0),this.parse(t)}var g=v.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(x.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(f);if(r){var a=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return x},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(t,e){var n=k(t);return this.startOf(e)<=n&&n<=this.endOf(e)},g.isAfter=function(t,e){return k(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<k(t)},g.$g=function(t,e,n){return x.u(t)?this[e]:this.set(n,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,e){var n=this,u=!!x.u(e)||e,d=x.p(t),f=function(t,e){var r=x.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return u?r:r.endOf(s)},p=function(t,e){return x.w(n.toDate()[t].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},v=this.$W,g=this.$M,m=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case c:return u?f(1,0):f(31,11);case l:return u?f(1,g):f(0,g+1);case o:var b=this.$locale().weekStart||0,_=(v<b?v+7:v)-b;return f(u?m-_:m+(6-_),g);case s:case h:return p(y+"Hours",0);case i:return p(y+"Minutes",1);case a:return p(y+"Seconds",2);case r:return p(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(t,e){var o,u=x.p(t),d="set"+(this.$u?"UTC":""),f=(o={},o[s]=d+"Date",o[h]=d+"Date",o[l]=d+"Month",o[c]=d+"FullYear",o[i]=d+"Hours",o[a]=d+"Minutes",o[r]=d+"Seconds",o[n]=d+"Milliseconds",o)[u],p=u===s?this.$D+(e-this.$W):e;if(u===l||u===c){var v=this.clone().set(h,1);v.$d[f](p),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[x.p(t)]()},g.add=function(n,u){var h,d=this;n=Number(n);var f=x.p(u),p=function(t){var e=k(d);return x.w(e.date(e.date()+Math.round(t*n)),d)};if(f===l)return this.set(l,this.$M+n);if(f===c)return this.set(c,this.$y+n);if(f===s)return p(1);if(f===o)return p(7);var v=(h={},h[a]=t,h[i]=e,h[r]=1e3,h)[f]||1,g=this.$d.getTime()+n*v;return x.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",a=x.z(this),i=this.$H,s=this.$m,o=this.$M,l=n.weekdays,u=n.months,c=function(t,n,a,i){return t&&(t[n]||t(e,r))||a[n].slice(0,i)},h=function(t){return x.s(i%12||12,t,"0")},f=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},v={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:x.s(o+1,2,"0"),MMM:c(n.monthsShort,o,u,3),MMMM:c(u,o),D:this.$D,DD:x.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:x.s(i,2,"0"),h:h(1),hh:h(2),a:f(i,s,!0),A:f(i,s,!1),m:String(s),mm:x.s(s,2,"0"),s:String(this.$s),ss:x.s(this.$s,2,"0"),SSS:x.s(this.$ms,3,"0"),Z:a};return r.replace(p,(function(t,e){return e||v[t]||a.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,h,d){var f,p=x.p(h),v=k(n),g=(v.utcOffset()-this.utcOffset())*t,m=this-v,y=x.m(this,v);return y=(f={},f[c]=y/12,f[l]=y,f[u]=y/3,f[o]=(m-g)/6048e5,f[s]=(m-g)/864e5,f[i]=m/e,f[a]=m/t,f[r]=m/1e3,f)[p]||m,d?y:x.a(y)},g.daysInMonth=function(){return this.endOf(l).$D},g.$locale=function(){return b[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},g.clone=function(){return x.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},v}(),T=E.prototype;return k.prototype=T,[["$ms",n],["$s",r],["$m",a],["$H",i],["$W",s],["$M",l],["$y",c],["$D",h]].forEach((function(t){T[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),k.extend=function(t,e){return t.$i||(t(e,E,k),t.$i=!0),k},k.locale=w,k.isDayjs=_,k.unix=function(t){return k(1e3*t)},k.en=b[y],k.Ls=b,k.p={},k}()},function(t,e,n){t.exports=function(){"use strict";for(var t=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t<e?e:t>n?n:t},e=t,n={},r=0,a=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];r<a.length;r+=1){var i=a[r];n["[object "+i+"]"]=i.toLowerCase()}var s=function(t){return n[Object.prototype.toString.call(t)]||"object"},o=s,l=s,u=Math.PI,c={clip_rgb:function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var n=0;n<=3;n++)n<3?((t[n]<0||t[n]>255)&&(t._clipped=!0),t[n]=e(t[n],0,255)):3===n&&(t[n]=e(t[n],0,1));return t},limit:t,type:s,unpack:function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==o(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==l(t[e])?t[e].toLowerCase():null},PI:u,TWOPI:2*u,PITHIRD:u/3,DEG2RAD:u/180,RAD2DEG:180/u},h={format:{},autodetect:[]},d=c.last,f=c.clip_rgb,p=c.type,v=h,g=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=this;if("object"===p(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var r=d(t),a=!1;if(!r){a=!0,v.sorted||(v.autodetect=v.autodetect.sort((function(t,e){return e.p-t.p})),v.sorted=!0);for(var i=0,s=v.autodetect;i<s.length;i+=1){var o=s[i];if(r=o.test.apply(o,t))break}}if(!v.format[r])throw new Error("unknown format: "+t);var l=v.format[r].apply(null,a?t:t.slice(0,-1));n._rgb=f(l),3===n._rgb.length&&n._rgb.push(1)};g.prototype.toString=function(){return"function"==p(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var m=g,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(y.Color,[null].concat(t)))};y.Color=m,y.version="2.4.2";var b=y,_=c.unpack,w=Math.max,k=c.unpack,x=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=k(t,"cmyk"))[0],r=t[1],a=t[2],i=t[3],s=t.length>4?t[4]:1;return 1===i?[0,0,0,s]:[n>=1?0:255*(1-n)*(1-i),r>=1?0:255*(1-r)*(1-i),a>=1?0:255*(1-a)*(1-i),s]},E=b,T=m,S=h,O=c.unpack,M=c.type,C=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=_(t,"rgb"),r=n[0],a=n[1],i=n[2],s=1-w(r/=255,w(a/=255,i/=255)),o=s<1?1/(1-s):0,l=(1-r-s)*o,u=(1-a-s)*o,c=(1-i-s)*o;return[l,u,c,s]};T.prototype.cmyk=function(){return C(this._rgb)},E.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(T,[null].concat(t,["cmyk"])))},S.format.cmyk=x,S.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=O(t,"cmyk"),"array"===M(t)&&4===t.length)return"cmyk"}});var R=c.unpack,D=c.last,A=function(t){return Math.round(100*t)/100},L=c.unpack,P=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=L(t,"rgba"))[0],r=t[1],a=t[2];n/=255,r/=255,a/=255;var i,s,o=Math.min(n,r,a),l=Math.max(n,r,a),u=(l+o)/2;return l===o?(i=0,s=Number.NaN):i=u<.5?(l-o)/(l+o):(l-o)/(2-l-o),n==l?s=(r-a)/(l-o):r==l?s=2+(a-n)/(l-o):a==l&&(s=4+(n-r)/(l-o)),(s*=60)<0&&(s+=360),t.length>3&&void 0!==t[3]?[s,i,u,t[3]]:[s,i,u]},N=c.unpack,I=c.last,H=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=R(t,"hsla"),r=D(t)||"lsa";return n[0]=A(n[0]||0),n[1]=A(100*n[1])+"%",n[2]=A(100*n[2])+"%","hsla"===r||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,r="hsla"):n.length=3,r+"("+n.join(",")+")"},F=P,z=Math.round,V=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=N(t,"rgba"),r=I(t)||"rgb";return"hsl"==r.substr(0,3)?H(F(n),r):(n[0]=z(n[0]),n[1]=z(n[1]),n[2]=z(n[2]),("rgba"===r||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,r="rgba"),r+"("+n.slice(0,"rgb"===r?3:4).join(",")+")")},U=c.unpack,j=Math.round,B=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];var r,a,i,s=(e=U(e,"hsl"))[0],o=e[1],l=e[2];if(0===o)r=a=i=255*l;else{var u=[0,0,0],c=[0,0,0],h=l<.5?l*(1+o):l+o-l*o,d=2*l-h,f=s/360;u[0]=f+1/3,u[1]=f,u[2]=f-1/3;for(var p=0;p<3;p++)u[p]<0&&(u[p]+=1),u[p]>1&&(u[p]-=1),6*u[p]<1?c[p]=d+6*(h-d)*u[p]:2*u[p]<1?c[p]=h:3*u[p]<2?c[p]=d+(h-d)*(2/3-u[p])*6:c[p]=d;r=(t=[j(255*c[0]),j(255*c[1]),j(255*c[2])])[0],a=t[1],i=t[2]}return e.length>3?[r,a,i,e[3]]:[r,a,i,1]},G=B,$=h,Y=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,X=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,W=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Z=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,q=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,K=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,J=Math.round,Q=function(t){var e;if(t=t.toLowerCase().trim(),$.format.named)try{return $.format.named(t)}catch(t){}if(e=t.match(Y)){for(var n=e.slice(1,4),r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(e=t.match(X)){for(var a=e.slice(1,5),i=0;i<4;i++)a[i]=+a[i];return a}if(e=t.match(W)){for(var s=e.slice(1,4),o=0;o<3;o++)s[o]=J(2.55*s[o]);return s[3]=1,s}if(e=t.match(Z)){for(var l=e.slice(1,5),u=0;u<3;u++)l[u]=J(2.55*l[u]);return l[3]=+l[3],l}if(e=t.match(q)){var c=e.slice(1,4);c[1]*=.01,c[2]*=.01;var h=G(c);return h[3]=1,h}if(e=t.match(K)){var d=e.slice(1,4);d[1]*=.01,d[2]*=.01;var f=G(d);return f[3]=+e[4],f}};Q.test=function(t){return Y.test(t)||X.test(t)||W.test(t)||Z.test(t)||q.test(t)||K.test(t)};var tt=b,et=m,nt=h,rt=c.type,at=V,it=Q;et.prototype.css=function(t){return at(this._rgb,t)},tt.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(et,[null].concat(t,["css"])))},nt.format.css=it,nt.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===rt(t)&&it.test(t))return"css"}});var st=m,ot=b,lt=c.unpack;h.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=lt(t,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},ot.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(st,[null].concat(t,["gl"])))},st.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var ut=c.unpack,ct=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r=ut(t,"rgb"),a=r[0],i=r[1],s=r[2],o=Math.min(a,i,s),l=Math.max(a,i,s),u=l-o,c=100*u/255,h=o/(255-u)*100;return 0===u?n=Number.NaN:(a===l&&(n=(i-s)/u),i===l&&(n=2+(s-a)/u),s===l&&(n=4+(a-i)/u),(n*=60)<0&&(n+=360)),[n,c,h]},ht=c.unpack,dt=Math.floor,ft=function(){for(var t,e,n,r,a,i,s=[],o=arguments.length;o--;)s[o]=arguments[o];var l,u,c,h=(s=ht(s,"hcg"))[0],d=s[1],f=s[2];f*=255;var p=255*d;if(0===d)l=u=c=f;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var v=dt(h/=60),g=h-v,m=f*(1-d),y=m+p*(1-g),b=m+p*g,_=m+p;switch(v){case 0:l=(t=[_,b,m])[0],u=t[1],c=t[2];break;case 1:l=(e=[y,_,m])[0],u=e[1],c=e[2];break;case 2:l=(n=[m,_,b])[0],u=n[1],c=n[2];break;case 3:l=(r=[m,y,_])[0],u=r[1],c=r[2];break;case 4:l=(a=[b,m,_])[0],u=a[1],c=a[2];break;case 5:l=(i=[_,m,y])[0],u=i[1],c=i[2]}}return[l,u,c,s.length>3?s[3]:1]},pt=c.unpack,vt=c.type,gt=b,mt=m,yt=h,bt=ct;mt.prototype.hcg=function(){return bt(this._rgb)},gt.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(mt,[null].concat(t,["hcg"])))},yt.format.hcg=ft,yt.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=pt(t,"hcg"),"array"===vt(t)&&3===t.length)return"hcg"}});var _t=c.unpack,wt=c.last,kt=Math.round,xt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=_t(t,"rgba"),r=n[0],a=n[1],i=n[2],s=n[3],o=wt(t)||"auto";void 0===s&&(s=1),"auto"===o&&(o=s<1?"rgba":"rgb");var l=(r=kt(r))<<16|(a=kt(a))<<8|(i=kt(i)),u="000000"+l.toString(16);u=u.substr(u.length-6);var c="0"+kt(255*s).toString(16);switch(c=c.substr(c.length-2),o.toLowerCase()){case"rgba":return"#"+u+c;case"argb":return"#"+c+u;default:return"#"+u}},Et=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Tt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,St=function(t){if(t.match(Et)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(Tt)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var n=parseInt(t,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+t)},Ot=b,Mt=m,Ct=c.type,Rt=h,Dt=xt;Mt.prototype.hex=function(t){return Dt(this._rgb,t)},Ot.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Mt,[null].concat(t,["hex"])))},Rt.format.hex=St,Rt.autodetect.push({p:4,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===Ct(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var At=c.unpack,Lt=c.TWOPI,Pt=Math.min,Nt=Math.sqrt,It=Math.acos,Ht=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r=At(t,"rgb"),a=r[0],i=r[1],s=r[2],o=Pt(a/=255,i/=255,s/=255),l=(a+i+s)/3,u=l>0?1-o/l:0;return 0===u?n=NaN:(n=(a-i+(a-s))/2,n/=Nt((a-i)*(a-i)+(a-s)*(i-s)),n=It(n),s>i&&(n=Lt-n),n/=Lt),[360*n,u,l]},Ft=c.unpack,zt=c.limit,Vt=c.TWOPI,Ut=c.PITHIRD,jt=Math.cos,Bt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,a,i=(t=Ft(t,"hsi"))[0],s=t[1],o=t[2];return isNaN(i)&&(i=0),isNaN(s)&&(s=0),i>360&&(i-=360),i<0&&(i+=360),(i/=360)<1/3?r=1-((a=(1-s)/3)+(n=(1+s*jt(Vt*i)/jt(Ut-Vt*i))/3)):i<2/3?a=1-((n=(1-s)/3)+(r=(1+s*jt(Vt*(i-=1/3))/jt(Ut-Vt*i))/3)):n=1-((r=(1-s)/3)+(a=(1+s*jt(Vt*(i-=2/3))/jt(Ut-Vt*i))/3)),[255*(n=zt(o*n*3)),255*(r=zt(o*r*3)),255*(a=zt(o*a*3)),t.length>3?t[3]:1]},Gt=c.unpack,$t=c.type,Yt=b,Xt=m,Wt=h,Zt=Ht;Xt.prototype.hsi=function(){return Zt(this._rgb)},Yt.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Xt,[null].concat(t,["hsi"])))},Wt.format.hsi=Bt,Wt.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Gt(t,"hsi"),"array"===$t(t)&&3===t.length)return"hsi"}});var qt=c.unpack,Kt=c.type,Jt=b,Qt=m,te=h,ee=P;Qt.prototype.hsl=function(){return ee(this._rgb)},Jt.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Qt,[null].concat(t,["hsl"])))},te.format.hsl=B,te.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=qt(t,"hsl"),"array"===Kt(t)&&3===t.length)return"hsl"}});var ne=c.unpack,re=Math.min,ae=Math.max,ie=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,a,i=(t=ne(t,"rgb"))[0],s=t[1],o=t[2],l=re(i,s,o),u=ae(i,s,o),c=u-l;return a=u/255,0===u?(n=Number.NaN,r=0):(r=c/u,i===u&&(n=(s-o)/c),s===u&&(n=2+(o-i)/c),o===u&&(n=4+(i-s)/c),(n*=60)<0&&(n+=360)),[n,r,a]},se=c.unpack,oe=Math.floor,le=function(){for(var t,e,n,r,a,i,s=[],o=arguments.length;o--;)s[o]=arguments[o];var l,u,c,h=(s=se(s,"hsv"))[0],d=s[1],f=s[2];if(f*=255,0===d)l=u=c=f;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var p=oe(h/=60),v=h-p,g=f*(1-d),m=f*(1-d*v),y=f*(1-d*(1-v));switch(p){case 0:l=(t=[f,y,g])[0],u=t[1],c=t[2];break;case 1:l=(e=[m,f,g])[0],u=e[1],c=e[2];break;case 2:l=(n=[g,f,y])[0],u=n[1],c=n[2];break;case 3:l=(r=[g,m,f])[0],u=r[1],c=r[2];break;case 4:l=(a=[y,g,f])[0],u=a[1],c=a[2];break;case 5:l=(i=[f,g,m])[0],u=i[1],c=i[2]}}return[l,u,c,s.length>3?s[3]:1]},ue=c.unpack,ce=c.type,he=b,de=m,fe=h,pe=ie;de.prototype.hsv=function(){return pe(this._rgb)},he.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(de,[null].concat(t,["hsv"])))},fe.format.hsv=le,fe.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ue(t,"hsv"),"array"===ce(t)&&3===t.length)return"hsv"}});var ve={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ge=ve,me=c.unpack,ye=Math.pow,be=function(t){return(t/=255)<=.04045?t/12.92:ye((t+.055)/1.055,2.4)},_e=function(t){return t>ge.t3?ye(t,1/3):t/ge.t2+ge.t0},we=function(t,e,n){return t=be(t),e=be(e),n=be(n),[_e((.4124564*t+.3575761*e+.1804375*n)/ge.Xn),_e((.2126729*t+.7151522*e+.072175*n)/ge.Yn),_e((.0193339*t+.119192*e+.9503041*n)/ge.Zn)]},ke=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=me(t,"rgb"),r=n[0],a=n[1],i=n[2],s=we(r,a,i),o=s[0],l=s[1],u=s[2],c=116*l-16;return[c<0?0:c,500*(o-l),200*(l-u)]},xe=ve,Ee=c.unpack,Te=Math.pow,Se=function(t){return 255*(t<=.00304?12.92*t:1.055*Te(t,1/2.4)-.055)},Oe=function(t){return t>xe.t1?t*t*t:xe.t2*(t-xe.t0)},Me=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,a,i=(t=Ee(t,"lab"))[0],s=t[1],o=t[2];return r=(i+16)/116,n=isNaN(s)?r:r+s/500,a=isNaN(o)?r:r-o/200,r=xe.Yn*Oe(r),n=xe.Xn*Oe(n),a=xe.Zn*Oe(a),[Se(3.2404542*n-1.5371385*r-.4985314*a),Se(-.969266*n+1.8760108*r+.041556*a),Se(.0556434*n-.2040259*r+1.0572252*a),t.length>3?t[3]:1]},Ce=c.unpack,Re=c.type,De=b,Ae=m,Le=h,Pe=ke;Ae.prototype.lab=function(){return Pe(this._rgb)},De.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ae,[null].concat(t,["lab"])))},Le.format.lab=Me,Le.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ce(t,"lab"),"array"===Re(t)&&3===t.length)return"lab"}});var Ne=c.unpack,Ie=c.RAD2DEG,He=Math.sqrt,Fe=Math.atan2,ze=Math.round,Ve=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Ne(t,"lab"),r=n[0],a=n[1],i=n[2],s=He(a*a+i*i),o=(Fe(i,a)*Ie+360)%360;return 0===ze(1e4*s)&&(o=Number.NaN),[r,s,o]},Ue=c.unpack,je=ke,Be=Ve,Ge=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Ue(t,"rgb"),r=n[0],a=n[1],i=n[2],s=je(r,a,i),o=s[0],l=s[1],u=s[2];return Be(o,l,u)},$e=c.unpack,Ye=c.DEG2RAD,Xe=Math.sin,We=Math.cos,Ze=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=$e(t,"lch"),r=n[0],a=n[1],i=n[2];return isNaN(i)&&(i=0),[r,We(i*=Ye)*a,Xe(i)*a]},qe=c.unpack,Ke=Ze,Je=Me,Qe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=qe(t,"lch"))[0],r=t[1],a=t[2],i=Ke(n,r,a),s=i[0],o=i[1],l=i[2],u=Je(s,o,l),c=u[0],h=u[1],d=u[2];return[c,h,d,t.length>3?t[3]:1]},tn=c.unpack,en=Qe,nn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=tn(t,"hcl").reverse();return en.apply(void 0,n)},rn=c.unpack,an=c.type,sn=b,on=m,ln=h,un=Ge;on.prototype.lch=function(){return un(this._rgb)},on.prototype.hcl=function(){return un(this._rgb).reverse()},sn.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(on,[null].concat(t,["lch"])))},sn.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(on,[null].concat(t,["hcl"])))},ln.format.lch=Qe,ln.format.hcl=nn,["lch","hcl"].forEach((function(t){return ln.autodetect.push({p:2,test:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(e=rn(e,t),"array"===an(e)&&3===e.length)return t}})}));var cn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},hn=h,dn=c.type,fn=cn,pn=St,vn=xt;m.prototype.name=function(){for(var t=vn(this._rgb,"rgb"),e=0,n=Object.keys(fn);e<n.length;e+=1){var r=n[e];if(fn[r]===t)return r.toLowerCase()}return t},hn.format.named=function(t){if(t=t.toLowerCase(),fn[t])return pn(fn[t]);throw new Error("unknown color name: "+t)},hn.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===dn(t)&&fn[t.toLowerCase()])return"named"}});var gn=c.unpack,mn=c.type,yn=function(t){if("number"==mn(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},bn=b,_n=m,wn=h,kn=c.type,xn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=gn(t,"rgb"),r=n[0],a=n[1],i=n[2];return(r<<16)+(a<<8)+i};_n.prototype.num=function(){return xn(this._rgb)},bn.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(_n,[null].concat(t,["num"])))},wn.format.num=yn,wn.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===kn(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var En=b,Tn=m,Sn=h,On=c.unpack,Mn=c.type,Cn=Math.round;Tn.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Cn)},Tn.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,n){return n<3?!1===t?e:Cn(e):e}))},En.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Tn,[null].concat(t,["rgb"])))},Sn.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=On(t,"rgba");return void 0===n[3]&&(n[3]=1),n},Sn.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=On(t,"rgba"),"array"===Mn(t)&&(3===t.length||4===t.length&&"number"==Mn(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var Rn=Math.log,Dn=function(t){var e,n,r,a=t/100;return a<66?(e=255,n=a<6?0:-155.25485562709179-.44596950469579133*(n=a-2)+104.49216199393888*Rn(n),r=a<20?0:.8274096064007395*(r=a-10)-254.76935184120902+115.67994401066147*Rn(r)):(e=351.97690566805693+.114206453784165*(e=a-55)-40.25366309332127*Rn(e),n=325.4494125711974+.07943456536662342*(n=a-50)-28.0852963507957*Rn(n),r=255),[e,n,r,1]},An=Dn,Ln=c.unpack,Pn=Math.round,Nn=b,In=m,Hn=h,Fn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n,r=Ln(t,"rgb"),a=r[0],i=r[2],s=1e3,o=4e4,l=.4;o-s>l;){var u=An(n=.5*(o+s));u[2]/u[0]>=i/a?o=n:s=n}return Pn(n)};In.prototype.temp=In.prototype.kelvin=In.prototype.temperature=function(){return Fn(this._rgb)},Nn.temp=Nn.kelvin=Nn.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(In,[null].concat(t,["temp"])))},Hn.format.temp=Hn.format.kelvin=Hn.format.temperature=Dn;var zn=c.unpack,Vn=Math.cbrt,Un=Math.pow,jn=Math.sign,Bn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=zn(t,"rgb"),r=n[0],a=n[1],i=n[2],s=[Gn(r/255),Gn(a/255),Gn(i/255)],o=s[0],l=s[1],u=s[2],c=Vn(.4122214708*o+.5363325363*l+.0514459929*u),h=Vn(.2119034982*o+.6806995451*l+.1073969566*u),d=Vn(.0883024619*o+.2817188376*l+.6299787005*u);return[.2104542553*c+.793617785*h-.0040720468*d,1.9779984951*c-2.428592205*h+.4505937099*d,.0259040371*c+.7827717662*h-.808675766*d]};function Gn(t){var e=Math.abs(t);return e<.04045?t/12.92:(jn(t)||1)*Un((e+.055)/1.055,2.4)}var $n=c.unpack,Yn=Math.pow,Xn=Math.sign,Wn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=$n(t,"lab"))[0],r=t[1],a=t[2],i=Yn(n+.3963377774*r+.2158037573*a,3),s=Yn(n-.1055613458*r-.0638541728*a,3),o=Yn(n-.0894841775*r-1.291485548*a,3);return[255*Zn(4.0767416621*i-3.3077115913*s+.2309699292*o),255*Zn(-1.2684380046*i+2.6097574011*s-.3413193965*o),255*Zn(-.0041960863*i-.7034186147*s+1.707614701*o),t.length>3?t[3]:1]};function Zn(t){var e=Math.abs(t);return e>.0031308?(Xn(t)||1)*(1.055*Yn(e,1/2.4)-.055):12.92*t}var qn=c.unpack,Kn=c.type,Jn=b,Qn=m,tr=h,er=Bn;Qn.prototype.oklab=function(){return er(this._rgb)},Jn.oklab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Qn,[null].concat(t,["oklab"])))},tr.format.oklab=Wn,tr.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=qn(t,"oklab"),"array"===Kn(t)&&3===t.length)return"oklab"}});var nr=c.unpack,rr=Bn,ar=Ve,ir=c.unpack,sr=Ze,or=Wn,lr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=ir(t,"lch"))[0],r=t[1],a=t[2],i=sr(n,r,a),s=i[0],o=i[1],l=i[2],u=or(s,o,l),c=u[0],h=u[1],d=u[2];return[c,h,d,t.length>3?t[3]:1]},ur=c.unpack,cr=c.type,hr=b,dr=m,fr=h,pr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=nr(t,"rgb"),r=n[0],a=n[1],i=n[2],s=rr(r,a,i),o=s[0],l=s[1],u=s[2];return ar(o,l,u)};dr.prototype.oklch=function(){return pr(this._rgb)},hr.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(dr,[null].concat(t,["oklch"])))},fr.format.oklch=lr,fr.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ur(t,"oklch"),"array"===cr(t)&&3===t.length)return"oklch"}});var vr=m,gr=c.type;vr.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===gr(t)?e?(this._rgb[3]=t,this):new vr([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},m.prototype.clipped=function(){return this._rgb._clipped||!1};var mr=m,yr=ve;mr.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=yr.Kn*t,new mr(e,"lab").alpha(this.alpha(),!0)},mr.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},mr.prototype.darker=mr.prototype.darken,mr.prototype.brighter=mr.prototype.brighten,m.prototype.get=function(t){var e=t.split("."),n=e[0],r=e[1],a=this[n]();if(r){var i=n.indexOf(r)-("ok"===n.substr(0,2)?2:0);if(i>-1)return a[i];throw new Error("unknown channel "+r+" in mode "+n)}return a};var br=m,_r=c.type,wr=Math.pow;br.prototype.luminance=function(t){if(void 0!==t&&"number"===_r(t)){if(0===t)return new br([0,0,0,this._rgb[3]],"rgb");if(1===t)return new br([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),n=20,r=function(e,a){var i=e.interpolate(a,.5,"rgb"),s=i.luminance();return Math.abs(t-s)<1e-7||!n--?i:s>t?r(e,i):r(i,a)},a=(e>t?r(new br([0,0,0]),this):r(this,new br([255,255,255]))).rgb();return new br(a.concat([this._rgb[3]]))}return kr.apply(void 0,this._rgb.slice(0,3))};var kr=function(t,e,n){return.2126*(t=xr(t))+.7152*(e=xr(e))+.0722*(n=xr(n))},xr=function(t){return(t/=255)<=.03928?t/12.92:wr((t+.055)/1.055,2.4)},Er={},Tr=m,Sr=c.type,Or=Er,Mr=function(t,e,n){void 0===n&&(n=.5);for(var r=[],a=arguments.length-3;a-- >0;)r[a]=arguments[a+3];var i=r[0]||"lrgb";if(Or[i]||r.length||(i=Object.keys(Or)[0]),!Or[i])throw new Error("interpolation mode "+i+" is not defined");return"object"!==Sr(t)&&(t=new Tr(t)),"object"!==Sr(e)&&(e=new Tr(e)),Or[i](t,e,n).alpha(t.alpha()+n*(e.alpha()-t.alpha()))},Cr=m,Rr=Mr;Cr.prototype.mix=Cr.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return Rr.apply(void 0,[this,t,e].concat(n))};var Dr=m;Dr.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,n=e[3];return t?(this._rgb=[e[0]*n,e[1]*n,e[2]*n,n],this):new Dr([e[0]*n,e[1]*n,e[2]*n,n],"rgb")};var Ar=m,Lr=ve;Ar.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=Lr.Kn*t,e[1]<0&&(e[1]=0),new Ar(e,"lch").alpha(this.alpha(),!0)},Ar.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var Pr=m,Nr=c.type;Pr.prototype.set=function(t,e,n){void 0===n&&(n=!1);var r=t.split("."),a=r[0],i=r[1],s=this[a]();if(i){var o=a.indexOf(i)-("ok"===a.substr(0,2)?2:0);if(o>-1){if("string"==Nr(e))switch(e.charAt(0)){case"+":case"-":s[o]+=+e;break;case"*":s[o]*=+e.substr(1);break;case"/":s[o]/=+e.substr(1);break;default:s[o]=+e}else{if("number"!==Nr(e))throw new Error("unsupported value for Color.set");s[o]=e}var l=new Pr(s,a);return n?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+i+" in mode "+a)}return s};var Ir=m;Er.rgb=function(t,e,n){var r=t._rgb,a=e._rgb;return new Ir(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"rgb")};var Hr=m,Fr=Math.sqrt,zr=Math.pow;Er.lrgb=function(t,e,n){var r=t._rgb,a=r[0],i=r[1],s=r[2],o=e._rgb,l=o[0],u=o[1],c=o[2];return new Hr(Fr(zr(a,2)*(1-n)+zr(l,2)*n),Fr(zr(i,2)*(1-n)+zr(u,2)*n),Fr(zr(s,2)*(1-n)+zr(c,2)*n),"rgb")};var Vr=m;Er.lab=function(t,e,n){var r=t.lab(),a=e.lab();return new Vr(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"lab")};var Ur=m,jr=function(t,e,n,r){var a,i,s,o,l,u,c,h,d,f,p,v,g;return"hsl"===r?(s=t.hsl(),o=e.hsl()):"hsv"===r?(s=t.hsv(),o=e.hsv()):"hcg"===r?(s=t.hcg(),o=e.hcg()):"hsi"===r?(s=t.hsi(),o=e.hsi()):"lch"===r||"hcl"===r?(r="hcl",s=t.hcl(),o=e.hcl()):"oklch"===r&&(s=t.oklch().reverse(),o=e.oklch().reverse()),"h"!==r.substr(0,1)&&"oklch"!==r||(l=(a=s)[0],c=a[1],d=a[2],u=(i=o)[0],h=i[1],f=i[2]),isNaN(l)||isNaN(u)?isNaN(l)?isNaN(u)?v=Number.NaN:(v=u,1!=d&&0!=d||"hsv"==r||(p=h)):(v=l,1!=f&&0!=f||"hsv"==r||(p=c)):v=l+n*(u>l&&u-l>180?u-(l+360):u<l&&l-u>180?u+360-l:u-l),void 0===p&&(p=c+n*(h-c)),g=d+n*(f-d),new Ur("oklch"===r?[g,p,v]:[v,p,g],r)},Br=jr,Gr=function(t,e,n){return Br(t,e,n,"lch")};Er.lch=Gr,Er.hcl=Gr;var $r=m;Er.num=function(t,e,n){var r=t.num(),a=e.num();return new $r(r+n*(a-r),"num")};var Yr=jr;Er.hcg=function(t,e,n){return Yr(t,e,n,"hcg")};var Xr=jr;Er.hsi=function(t,e,n){return Xr(t,e,n,"hsi")};var Wr=jr;Er.hsl=function(t,e,n){return Wr(t,e,n,"hsl")};var Zr=jr;Er.hsv=function(t,e,n){return Zr(t,e,n,"hsv")};var qr=m;Er.oklab=function(t,e,n){var r=t.oklab(),a=e.oklab();return new qr(r[0]+n*(a[0]-r[0]),r[1]+n*(a[1]-r[1]),r[2]+n*(a[2]-r[2]),"oklab")};var Kr=jr;Er.oklch=function(t,e,n){return Kr(t,e,n,"oklch")};var Jr=m,Qr=c.clip_rgb,ta=Math.pow,ea=Math.sqrt,na=Math.PI,ra=Math.cos,aa=Math.sin,ia=Math.atan2,sa=function(t,e){for(var n=t.length,r=[0,0,0,0],a=0;a<t.length;a++){var i=t[a],s=e[a]/n,o=i._rgb;r[0]+=ta(o[0],2)*s,r[1]+=ta(o[1],2)*s,r[2]+=ta(o[2],2)*s,r[3]+=o[3]*s}return r[0]=ea(r[0]),r[1]=ea(r[1]),r[2]=ea(r[2]),r[3]>.9999999&&(r[3]=1),new Jr(Qr(r))},oa=b,la=c.type,ua=Math.pow,ca=function(t){var e="rgb",n=oa("#ccc"),r=0,a=[0,1],i=[],s=[0,0],o=!1,l=[],u=!1,c=0,h=1,d=!1,f={},p=!0,v=1,g=function(t){if((t=t||["#fff","#000"])&&"string"===la(t)&&oa.brewer&&oa.brewer[t.toLowerCase()]&&(t=oa.brewer[t.toLowerCase()]),"array"===la(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=oa(t[e]);i.length=0;for(var n=0;n<t.length;n++)i.push(n/(t.length-1))}return _(),l=t},m=function(t){return t},y=function(t){return t},b=function(t,r){var a,u;if(null==r&&(r=!1),isNaN(t)||null===t)return n;u=r?t:o&&o.length>2?function(t){if(null!=o){for(var e=o.length-1,n=0;n<e&&t>=o[n];)n++;return n-1}return 0}(t)/(o.length-2):h!==c?(t-c)/(h-c):1,u=y(u),r||(u=m(u)),1!==v&&(u=ua(u,v)),u=s[0]+u*(1-s[0]-s[1]),u=Math.min(1,Math.max(0,u));var d=Math.floor(1e4*u);if(p&&f[d])a=f[d];else{if("array"===la(l))for(var g=0;g<i.length;g++){var b=i[g];if(u<=b){a=l[g];break}if(u>=b&&g===i.length-1){a=l[g];break}if(u>b&&u<i[g+1]){u=(u-b)/(i[g+1]-b),a=oa.interpolate(l[g],l[g+1],u,e);break}}else"function"===la(l)&&(a=l(u));p&&(f[d]=a)}return a},_=function(){return f={}};g(t);var w=function(t){var e=oa(b(t));return u&&e[u]?e[u]():e};return w.classes=function(t){if(null!=t){if("array"===la(t))o=t,a=[t[0],t[t.length-1]];else{var e=oa.analyze(a);o=0===t?[e.min,e.max]:oa.limits(e,"e",t)}return w}return o},w.domain=function(t){if(!arguments.length)return a;c=t[0],h=t[t.length-1],i=[];var e=l.length;if(t.length===e&&c!==h)for(var n=0,r=Array.from(t);n<r.length;n+=1){var s=r[n];i.push((s-c)/(h-c))}else{for(var o=0;o<e;o++)i.push(o/(e-1));if(t.length>2){var u=t.map((function(e,n){return n/(t.length-1)})),d=t.map((function(t){return(t-c)/(h-c)}));d.every((function(t,e){return u[e]===t}))||(y=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=d[e+1];)e++;var n=(t-d[e])/(d[e+1]-d[e]);return u[e]+n*(u[e+1]-u[e])})}}return a=[c,h],w},w.mode=function(t){return arguments.length?(e=t,_(),w):e},w.range=function(t,e){return g(t),w},w.out=function(t){return u=t,w},w.spread=function(t){return arguments.length?(r=t,w):r},w.correctLightness=function(t){return null==t&&(t=!0),d=t,_(),m=d?function(t){for(var e=b(0,!0).lab()[0],n=b(1,!0).lab()[0],r=e>n,a=b(t,!0).lab()[0],i=e+(n-e)*t,s=a-i,o=0,l=1,u=20;Math.abs(s)>.01&&u-- >0;)r&&(s*=-1),s<0?(o=t,t+=.5*(l-t)):(l=t,t+=.5*(o-t)),a=b(t,!0).lab()[0],s=a-i;return t}:function(t){return t},w},w.padding=function(t){return null!=t?("number"===la(t)&&(t=[t,t]),s=t,w):s},w.colors=function(e,n){arguments.length<2&&(n="hex");var r=[];if(0===arguments.length)r=l.slice(0);else if(1===e)r=[w(.5)];else if(e>1){var i=a[0],s=a[1]-i;r=ha(0,e,!1).map((function(t){return w(i+t/(e-1)*s)}))}else{t=[];var u=[];if(o&&o.length>2)for(var c=1,h=o.length,d=1<=h;d?c<h:c>h;d?c++:c--)u.push(.5*(o[c-1]+o[c]));else u=a;r=u.map((function(t){return w(t)}))}return oa[n]&&(r=r.map((function(t){return t[n]()}))),r},w.cache=function(t){return null!=t?(p=t,w):p},w.gamma=function(t){return null!=t?(v=t,w):v},w.nodata=function(t){return null!=t?(n=oa(t),w):n},w};function ha(t,e,n){for(var r=[],a=t<e,i=n?a?e+1:e-1:e,s=t;a?s<i:s>i;a?s++:s--)r.push(s);return r}var da=m,fa=ca,pa=function(t){var e,n,r,a,i,s,o;if(2===(t=t.map((function(t){return new da(t)}))).length)e=t.map((function(t){return t.lab()})),i=e[0],s=e[1],a=function(t){var e=[0,1,2].map((function(e){return i[e]+t*(s[e]-i[e])}));return new da(e,"lab")};else if(3===t.length)n=t.map((function(t){return t.lab()})),i=n[0],s=n[1],o=n[2],a=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*i[e]+2*(1-t)*t*s[e]+t*t*o[e]}));return new da(e,"lab")};else if(4===t.length){var l;r=t.map((function(t){return t.lab()})),i=r[0],s=r[1],o=r[2],l=r[3],a=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*i[e]+3*(1-t)*(1-t)*t*s[e]+3*(1-t)*t*t*o[e]+t*t*t*l[e]}));return new da(e,"lab")}}else{if(!(t.length>=5))throw new RangeError("No point in running bezier with only one color.");var u,c,h;u=t.map((function(t){return t.lab()})),h=t.length-1,c=function(t){for(var e=[1,1],n=1;n<t;n++){for(var r=[1],a=1;a<=e.length;a++)r[a]=(e[a]||0)+e[a-1];e=r}return e}(h),a=function(t){var e=1-t,n=[0,1,2].map((function(n){return u.reduce((function(r,a,i){return r+c[i]*Math.pow(e,h-i)*Math.pow(t,i)*a[n]}),0)}));return new da(n,"lab")}}return a},va=b,ga=function(t,e,n){if(!ga[n])throw new Error("unknown blend mode "+n);return ga[n](t,e)},ma=function(t){return function(e,n){var r=va(n).rgb(),a=va(e).rgb();return va.rgb(t(r,a))}},ya=function(t){return function(e,n){var r=[];return r[0]=t(e[0],n[0]),r[1]=t(e[1],n[1]),r[2]=t(e[2],n[2]),r}};ga.normal=ma(ya((function(t){return t}))),ga.multiply=ma(ya((function(t,e){return t*e/255}))),ga.screen=ma(ya((function(t,e){return 255*(1-(1-t/255)*(1-e/255))}))),ga.overlay=ma(ya((function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))}))),ga.darken=ma(ya((function(t,e){return t>e?e:t}))),ga.lighten=ma(ya((function(t,e){return t>e?t:e}))),ga.dodge=ma(ya((function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t}))),ga.burn=ma(ya((function(t,e){return 255*(1-(1-e/255)/(t/255))})));for(var ba=ga,_a=c.type,wa=c.clip_rgb,ka=c.TWOPI,xa=Math.pow,Ea=Math.sin,Ta=Math.cos,Sa=b,Oa=m,Ma=Math.floor,Ca=Math.random,Ra=s,Da=Math.log,Aa=Math.pow,La=Math.floor,Pa=Math.abs,Na=function(t,e){void 0===e&&(e=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===Ra(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===Ra(t)&&(t=t[e]),null==t||isNaN(t)||(n.values.push(t),n.sum+=t,t<n.min&&(n.min=t),t>n.max&&(n.max=t),n.count+=1)})),n.domain=[n.min,n.max],n.limits=function(t,e){return Ia(n,t,e)},n},Ia=function(t,e,n){void 0===e&&(e="equal"),void 0===n&&(n=7),"array"==Ra(t)&&(t=Na(t));var r=t.min,a=t.max,i=t.values.sort((function(t,e){return t-e}));if(1===n)return[r,a];var s=[];if("c"===e.substr(0,1)&&(s.push(r),s.push(a)),"e"===e.substr(0,1)){s.push(r);for(var o=1;o<n;o++)s.push(r+o/n*(a-r));s.push(a)}else if("l"===e.substr(0,1)){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*Da(r),u=Math.LOG10E*Da(a);s.push(r);for(var c=1;c<n;c++)s.push(Aa(10,l+c/n*(u-l)));s.push(a)}else if("q"===e.substr(0,1)){s.push(r);for(var h=1;h<n;h++){var d=(i.length-1)*h/n,f=La(d);if(f===d)s.push(i[f]);else{var p=d-f;s.push(i[f]*(1-p)+i[f+1]*p)}}s.push(a)}else if("k"===e.substr(0,1)){var v,g=i.length,m=new Array(g),y=new Array(n),b=!0,_=0,w=null;(w=[]).push(r);for(var k=1;k<n;k++)w.push(r+k/n*(a-r));for(w.push(a);b;){for(var x=0;x<n;x++)y[x]=0;for(var E=0;E<g;E++)for(var T=i[E],S=Number.MAX_VALUE,O=void 0,M=0;M<n;M++){var C=Pa(w[M]-T);C<S&&(S=C,O=M),y[O]++,m[E]=O}for(var R=new Array(n),D=0;D<n;D++)R[D]=null;for(var A=0;A<g;A++)null===R[v=m[A]]?R[v]=i[A]:R[v]+=i[A];for(var L=0;L<n;L++)R[L]*=1/y[L];b=!1;for(var P=0;P<n;P++)if(R[P]!==w[P]){b=!0;break}w=R,++_>200&&(b=!1)}for(var N={},I=0;I<n;I++)N[I]=[];for(var H=0;H<g;H++)N[v=m[H]].push(i[H]);for(var F=[],z=0;z<n;z++)F.push(N[z][0]),F.push(N[z][N[z].length-1]);F=F.sort((function(t,e){return t-e})),s.push(F[0]);for(var V=1;V<F.length;V+=2){var U=F[V];isNaN(U)||-1!==s.indexOf(U)||s.push(U)}}return s},Ha={analyze:Na,limits:Ia},Fa=m,za=m,Va=Math.sqrt,Ua=Math.pow,ja=Math.min,Ba=Math.max,Ga=Math.atan2,$a=Math.abs,Ya=Math.cos,Xa=Math.sin,Wa=Math.exp,Za=Math.PI,qa=m,Ka=m,Ja=b,Qa=ca,ti={cool:function(){return Qa([Ja.hsl(180,1,.9),Ja.hsl(250,.7,.4)])},hot:function(){return Qa(["#000","#f00","#ff0","#fff"]).mode("rgb")}},ei={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},ni=0,ri=Object.keys(ei);ni<ri.length;ni+=1){var ai=ri[ni];ei[ai.toLowerCase()]=ei[ai]}var ii=ei,si=b;return si.average=function(t,e,n){void 0===e&&(e="lrgb"),void 0===n&&(n=null);var r=t.length;n||(n=Array.from(new Array(r)).map((function(){return 1})));var a=r/n.reduce((function(t,e){return t+e}));if(n.forEach((function(t,e){n[e]*=a})),t=t.map((function(t){return new Jr(t)})),"lrgb"===e)return sa(t,n);for(var i=t.shift(),s=i.get(e),o=[],l=0,u=0,c=0;c<s.length;c++)if(s[c]=(s[c]||0)*n[0],o.push(isNaN(s[c])?0:n[0]),"h"===e.charAt(c)&&!isNaN(s[c])){var h=s[c]/180*na;l+=ra(h)*n[0],u+=aa(h)*n[0]}var d=i.alpha()*n[0];t.forEach((function(t,r){var a=t.get(e);d+=t.alpha()*n[r+1];for(var i=0;i<s.length;i++)if(!isNaN(a[i]))if(o[i]+=n[r+1],"h"===e.charAt(i)){var c=a[i]/180*na;l+=ra(c)*n[r+1],u+=aa(c)*n[r+1]}else s[i]+=a[i]*n[r+1]}));for(var f=0;f<s.length;f++)if("h"===e.charAt(f)){for(var p=ia(u/o[f],l/o[f])/na*180;p<0;)p+=360;for(;p>=360;)p-=360;s[f]=p}else s[f]=s[f]/o[f];return d/=r,new Jr(s,e).alpha(d>.99999?1:d,!0)},si.bezier=function(t){var e=pa(t);return e.scale=function(){return fa(e)},e},si.blend=ba,si.cubehelix=function(t,e,n,r,a){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=[0,1]);var i,s=0;"array"===_a(a)?i=a[1]-a[0]:(i=0,a=[a,a]);var o=function(o){var l=ka*((t+120)/360+e*o),u=xa(a[0]+i*o,r),c=(0!==s?n[0]+o*s:n)*u*(1-u)/2,h=Ta(l),d=Ea(l);return Sa(wa([255*(u+c*(-.14861*h+1.78277*d)),255*(u+c*(-.29227*h-.90649*d)),255*(u+c*(1.97294*h)),1]))};return o.start=function(e){return null==e?t:(t=e,o)},o.rotations=function(t){return null==t?e:(e=t,o)},o.gamma=function(t){return null==t?r:(r=t,o)},o.hue=function(t){return null==t?n:("array"===_a(n=t)?0==(s=n[1]-n[0])&&(n=n[1]):s=0,o)},o.lightness=function(t){return null==t?a:("array"===_a(t)?(a=t,i=t[1]-t[0]):(a=[t,t],i=0),o)},o.scale=function(){return Sa.scale(o)},o.hue(n),o},si.mix=si.interpolate=Mr,si.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(Ma(16*Ca()));return new Oa(t,"hex")},si.scale=ca,si.analyze=Ha.analyze,si.contrast=function(t,e){t=new Fa(t),e=new Fa(e);var n=t.luminance(),r=e.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},si.deltaE=function(t,e,n,r,a){void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=1);var i=function(t){return 360*t/(2*Za)},s=function(t){return 2*Za*t/360};t=new za(t),e=new za(e);var o=Array.from(t.lab()),l=o[0],u=o[1],c=o[2],h=Array.from(e.lab()),d=h[0],f=h[1],p=h[2],v=(l+d)/2,g=Va(Ua(u,2)+Ua(c,2)),m=Va(Ua(f,2)+Ua(p,2)),y=(g+m)/2,b=.5*(1-Va(Ua(y,7)/(Ua(y,7)+Ua(25,7)))),_=u*(1+b),w=f*(1+b),k=Va(Ua(_,2)+Ua(c,2)),x=Va(Ua(w,2)+Ua(p,2)),E=(k+x)/2,T=i(Ga(c,_)),S=i(Ga(p,w)),O=T>=0?T:T+360,M=S>=0?S:S+360,C=$a(O-M)>180?(O+M+360)/2:(O+M)/2,R=1-.17*Ya(s(C-30))+.24*Ya(s(2*C))+.32*Ya(s(3*C+6))-.2*Ya(s(4*C-63)),D=M-O;D=$a(D)<=180?D:M<=O?D+360:D-360,D=2*Va(k*x)*Xa(s(D)/2);var A=d-l,L=x-k,P=1+.015*Ua(v-50,2)/Va(20+Ua(v-50,2)),N=1+.045*E,I=1+.015*E*R,H=30*Wa(-Ua((C-275)/25,2)),F=-2*Va(Ua(E,7)/(Ua(E,7)+Ua(25,7)))*Xa(2*s(H)),z=Va(Ua(A/(n*P),2)+Ua(L/(r*N),2)+Ua(D/(a*I),2)+F*(L/(r*N))*(D/(a*I)));return Ba(0,ja(100,z))},si.distance=function(t,e,n){void 0===n&&(n="lab"),t=new qa(t),e=new qa(e);var r=t.get(n),a=e.get(n),i=0;for(var s in r){var o=(r[s]||0)-(a[s]||0);i+=o*o}return Math.sqrt(i)},si.limits=Ha.limits,si.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(Ka,[null].concat(t))),!0}catch(t){return!1}},si.scales=ti,si.colors=cn,si.brewer=ii,si}()},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__7__},function(t,e,n){"use strict";n.r(e),n.d(e,"Deflate",(function(){return We})),n.d(e,"Inflate",(function(){return Je})),n.d(e,"constants",(function(){return nn})),n.d(e,"default",(function(){return rn})),n.d(e,"deflate",(function(){return Ze})),n.d(e,"deflateRaw",(function(){return qe})),n.d(e,"gzip",(function(){return Ke})),n.d(e,"inflate",(function(){return Qe})),n.d(e,"inflateRaw",(function(){return tn})),n.d(e,"ungzip",(function(){return en}));function r(t){let e=t.length;for(;--e>=0;)t[e]=0}const a=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),i=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),o=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Array(576);r(l);const u=new Array(60);r(u);const c=new Array(512);r(c);const h=new Array(256);r(h);const d=new Array(29);r(d);const f=new Array(30);function p(t,e,n,r,a){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=t&&t.length}let v,g,m;function y(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}r(f);const b=t=>t<256?c[t]:c[256+(t>>>7)],_=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},w=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,_(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},k=(t,e,n)=>{w(t,n[2*e],n[2*e+1])},x=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},E=(t,e,n)=>{const r=new Array(16);let a,i,s=0;for(a=1;a<=15;a++)r[a]=s=s+n[a-1]<<1;for(i=0;i<=e;i++){let e=t[2*i+1];0!==e&&(t[2*i]=x(r[e]++,e))}},T=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},S=t=>{t.bi_valid>8?_(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},O=(t,e,n,r)=>{const a=2*e,i=2*n;return t[a]<t[i]||t[a]===t[i]&&r[e]<=r[n]},M=(t,e,n)=>{const r=t.heap[n];let a=n<<1;for(;a<=t.heap_len&&(a<t.heap_len&&O(e,t.heap[a+1],t.heap[a],t.depth)&&a++,!O(e,r,t.heap[a],t.depth));)t.heap[n]=t.heap[a],n=a,a<<=1;t.heap[n]=r},C=(t,e,n)=>{let r,s,o,l,u=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],s=t.pending_buf[t.l_buf+u],u++,0===r?k(t,s,e):(o=h[s],k(t,o+256+1,e),l=a[o],0!==l&&(s-=d[o],w(t,s,l)),r--,o=b(r),k(t,o,n),l=i[o],0!==l&&(r-=f[o],w(t,r,l)))}while(u<t.last_lit);k(t,256,e)},R=(t,e)=>{const n=e.dyn_tree,r=e.stat_desc.static_tree,a=e.stat_desc.has_stree,i=e.stat_desc.elems;let s,o,l,u=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<i;s++)0!==n[2*s]?(t.heap[++t.heap_len]=u=s,t.depth[s]=0):n[2*s+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=u<2?++u:0,n[2*l]=1,t.depth[l]=0,t.opt_len--,a&&(t.static_len-=r[2*l+1]);for(e.max_code=u,s=t.heap_len>>1;s>=1;s--)M(t,n,s);l=i;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],M(t,n,1),o=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=o,n[2*l]=n[2*s]+n[2*o],t.depth[l]=(t.depth[s]>=t.depth[o]?t.depth[s]:t.depth[o])+1,n[2*s+1]=n[2*o+1]=l,t.heap[1]=l++,M(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,r=e.max_code,a=e.stat_desc.static_tree,i=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let u,c,h,d,f,p,v=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(n[2*t.heap[t.heap_max]+1]=0,u=t.heap_max+1;u<573;u++)c=t.heap[u],d=n[2*n[2*c+1]+1]+1,d>l&&(d=l,v++),n[2*c+1]=d,c>r||(t.bl_count[d]++,f=0,c>=o&&(f=s[c-o]),p=n[2*c],t.opt_len+=p*(d+f),i&&(t.static_len+=p*(a[2*c+1]+f)));if(0!==v){do{for(d=l-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,v-=2}while(v>0);for(d=l;0!==d;d--)for(c=t.bl_count[d];0!==c;)h=t.heap[--u],h>r||(n[2*h+1]!==d&&(t.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),c--)}})(t,e),E(n,u,t.bl_count)},D=(t,e,n)=>{let r,a,i=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)a=s,s=e[2*(r+1)+1],++o<l&&a===s||(o<u?t.bl_tree[2*a]+=o:0!==a?(a!==i&&t.bl_tree[2*a]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,i=a,0===s?(l=138,u=3):a===s?(l=6,u=3):(l=7,u=4))},A=(t,e,n)=>{let r,a,i=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),r=0;r<=n;r++)if(a=s,s=e[2*(r+1)+1],!(++o<l&&a===s)){if(o<u)do{k(t,a,t.bl_tree)}while(0!=--o);else 0!==a?(a!==i&&(k(t,a,t.bl_tree),o--),k(t,16,t.bl_tree),w(t,o-3,2)):o<=10?(k(t,17,t.bl_tree),w(t,o-3,3)):(k(t,18,t.bl_tree),w(t,o-11,7));o=0,i=a,0===s?(l=138,u=3):a===s?(l=6,u=3):(l=7,u=4)}};let L=!1;const P=(t,e,n,r)=>{w(t,0+(r?1:0),3),((t,e,n,r)=>{S(t),r&&(_(t,n),_(t,~n)),t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n})(t,e,n,!0)};var N={_tr_init:t=>{L||((()=>{let t,e,n,r,o;const y=new Array(16);for(n=0,r=0;r<28;r++)for(d[r]=n,t=0;t<1<<a[r];t++)h[n++]=r;for(h[n-1]=r,o=0,r=0;r<16;r++)for(f[r]=o,t=0;t<1<<i[r];t++)c[o++]=r;for(o>>=7;r<30;r++)for(f[r]=o<<7,t=0;t<1<<i[r]-7;t++)c[256+o++]=r;for(e=0;e<=15;e++)y[e]=0;for(t=0;t<=143;)l[2*t+1]=8,t++,y[8]++;for(;t<=255;)l[2*t+1]=9,t++,y[9]++;for(;t<=279;)l[2*t+1]=7,t++,y[7]++;for(;t<=287;)l[2*t+1]=8,t++,y[8]++;for(E(l,287,y),t=0;t<30;t++)u[2*t+1]=5,u[2*t]=x(t,5);v=new p(l,a,257,286,15),g=new p(u,i,0,30,15),m=new p(new Array(0),s,0,19,7)})(),L=!0),t.l_desc=new y(t.dyn_ltree,v),t.d_desc=new y(t.dyn_dtree,g),t.bl_desc=new y(t.bl_tree,m),t.bi_buf=0,t.bi_valid=0,T(t)},_tr_stored_block:P,_tr_flush_block:(t,e,n,r)=>{let a,i,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),R(t,t.l_desc),R(t,t.d_desc),s=(t=>{let e;for(D(t,t.dyn_ltree,t.l_desc.max_code),D(t,t.dyn_dtree,t.d_desc.max_code),R(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*o[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,i<=a&&(a=i)):a=i=n+5,n+4<=a&&-1!==e?P(t,e,n,r):4===t.strategy||i===a?(w(t,2+(r?1:0),3),C(t,l,u)):(w(t,4+(r?1:0),3),((t,e,n,r)=>{let a;for(w(t,e-257,5),w(t,n-1,5),w(t,r-4,4),a=0;a<r;a++)w(t,t.bl_tree[2*o[a]+1],3);A(t,t.dyn_ltree,e-1),A(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),C(t,t.dyn_ltree,t.dyn_dtree)),T(t),r&&S(t)},_tr_tally:(t,e,n)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(h[n]+256+1)]++,t.dyn_dtree[2*b(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{w(t,2,3),k(t,256,l),(t=>{16===t.bi_valid?(_(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var I=(t,e,n,r)=>{let a=65535&t|0,i=t>>>16&65535|0,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{a=a+e[r++]|0,i=i+a|0}while(--s);a%=65521,i%=65521}return a|i<<16|0};const H=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var F=(t,e,n,r)=>{const a=H,i=r+n;t^=-1;for(let n=r;n<i;n++)t=t>>>8^a[255&(t^e[n])];return-1^t},z={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},V={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:U,_tr_stored_block:j,_tr_flush_block:B,_tr_tally:G,_tr_align:$}=N,{Z_NO_FLUSH:Y,Z_PARTIAL_FLUSH:X,Z_FULL_FLUSH:W,Z_FINISH:Z,Z_BLOCK:q,Z_OK:K,Z_STREAM_END:J,Z_STREAM_ERROR:Q,Z_DATA_ERROR:tt,Z_BUF_ERROR:et,Z_DEFAULT_COMPRESSION:nt,Z_FILTERED:rt,Z_HUFFMAN_ONLY:at,Z_RLE:it,Z_FIXED:st,Z_DEFAULT_STRATEGY:ot,Z_UNKNOWN:lt,Z_DEFLATED:ut}=V,ct=(t,e)=>(t.msg=z[e],e),ht=t=>(t<<1)-(t>4?9:0),dt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let ft=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const pt=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},vt=(t,e)=>{B(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,pt(t.strm)},gt=(t,e)=>{t.pending_buf[t.pending++]=e},mt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},yt=(t,e,n,r)=>{let a=t.avail_in;return a>r&&(a=r),0===a?0:(t.avail_in-=a,e.set(t.input.subarray(t.next_in,t.next_in+a),n),1===t.state.wrap?t.adler=I(t.adler,e,a,n):2===t.state.wrap&&(t.adler=F(t.adler,e,a,n)),t.next_in+=a,t.total_in+=a,a)},bt=(t,e)=>{let n,r,a=t.max_chain_length,i=t.strstart,s=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,u=t.window,c=t.w_mask,h=t.prev,d=t.strstart+258;let f=u[i+s-1],p=u[i+s];t.prev_length>=t.good_match&&(a>>=2),o>t.lookahead&&(o=t.lookahead);do{if(n=e,u[n+s]===p&&u[n+s-1]===f&&u[n]===u[i]&&u[++n]===u[i+1]){i+=2,n++;do{}while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<d);if(r=258-(d-i),i=d-258,r>s){if(t.match_start=e,s=r,r>=o)break;f=u[i+s-1],p=u[i+s]}}}while((e=h[e&c])>l&&0!=--a);return s<=t.lookahead?s:t.lookahead},_t=t=>{const e=t.w_size;let n,r,a,i,s;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,r=t.hash_size,n=r;do{a=t.head[--n],t.head[n]=a>=e?a-e:0}while(--r);r=e,n=r;do{a=t.prev[--n],t.prev[n]=a>=e?a-e:0}while(--r);i+=e}if(0===t.strm.avail_in)break;if(r=yt(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=ft(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=ft(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},wt=(t,e)=>{let n,r;for(;;){if(t.lookahead<262){if(_t(t),t.lookahead<262&&e===Y)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=bt(t,n)),t.match_length>=3)if(r=G(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ft(t,t.ins_h,t.window[t.strstart+1]);else r=G(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(vt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Z?(vt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(vt(t,!1),0===t.strm.avail_out)?1:2},kt=(t,e)=>{let n,r,a;for(;;){if(t.lookahead<262){if(_t(t),t.lookahead<262&&e===Y)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=bt(t,n),t.match_length<=5&&(t.strategy===rt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){a=t.strstart+t.lookahead-3,r=G(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=a&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(vt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(r=G(t,0,t.window[t.strstart-1]),r&&vt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=G(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Z?(vt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(vt(t,!1),0===t.strm.avail_out)?1:2};function xt(t,e,n,r,a){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=a}const Et=[new xt(0,0,0,0,(t,e)=>{let n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(_t(t),0===t.lookahead&&e===Y)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,vt(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(vt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Z?(vt(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(vt(t,!1),t.strm.avail_out),1)}),new xt(4,4,8,4,wt),new xt(4,5,16,8,wt),new xt(4,6,32,32,wt),new xt(4,4,16,16,kt),new xt(8,16,32,32,kt),new xt(8,16,128,128,kt),new xt(8,32,128,256,kt),new xt(32,128,258,1024,kt),new xt(32,258,258,4096,kt)];function Tt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ut,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),dt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const St=t=>{if(!t||!t.state)return ct(t,Q);t.total_in=t.total_out=0,t.data_type=lt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=Y,U(e),K},Ot=t=>{const e=St(t);var n;return e===K&&((n=t.state).window_size=2*n.w_size,dt(n.head),n.max_lazy_match=Et[n.level].max_lazy,n.good_match=Et[n.level].good_length,n.nice_match=Et[n.level].nice_length,n.max_chain_length=Et[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),e},Mt=(t,e,n,r,a,i)=>{if(!t)return Q;let s=1;if(e===nt&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>9||n!==ut||r<8||r>15||e<0||e>9||i<0||i>st)return ct(t,Q);8===r&&(r=9);const o=new Tt;return t.state=o,o.strm=t,o.wrap=s,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=e,o.strategy=i,o.method=n,Ot(t)};var Ct={deflateInit:(t,e)=>Mt(t,e,ut,15,8,ot),deflateInit2:Mt,deflateReset:Ot,deflateResetKeep:St,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?Q:(t.state.gzhead=e,K):Q,deflate:(t,e)=>{let n,r;if(!t||!t.state||e>q||e<0)return t?ct(t,Q):Q;const a=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===a.status&&e!==Z)return ct(t,0===t.avail_out?et:Q);a.strm=t;const i=a.last_flush;if(a.last_flush=e,42===a.status)if(2===a.wrap)t.adler=0,gt(a,31),gt(a,139),gt(a,8),a.gzhead?(gt(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),gt(a,255&a.gzhead.time),gt(a,a.gzhead.time>>8&255),gt(a,a.gzhead.time>>16&255),gt(a,a.gzhead.time>>24&255),gt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),gt(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(gt(a,255&a.gzhead.extra.length),gt(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(t.adler=F(t.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(gt(a,0),gt(a,0),gt(a,0),gt(a,0),gt(a,0),gt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),gt(a,3),a.status=113);else{let e=ut+(a.w_bits-8<<4)<<8,n=-1;n=a.strategy>=at||a.level<2?0:a.level<6?1:6===a.level?2:3,e|=n<<6,0!==a.strstart&&(e|=32),e+=31-e%31,a.status=113,mt(a,e),0!==a.strstart&&(mt(a,t.adler>>>16),mt(a,65535&t.adler)),t.adler=1}if(69===a.status)if(a.gzhead.extra){for(n=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),pt(t),n=a.pending,a.pending!==a.pending_buf_size));)gt(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){n=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),pt(t),n=a.pending,a.pending===a.pending_buf_size)){r=1;break}r=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,gt(a,r)}while(0!==r);a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),0===r&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){n=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),pt(t),n=a.pending,a.pending===a.pending_buf_size)){r=1;break}r=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,gt(a,r)}while(0!==r);a.gzhead.hcrc&&a.pending>n&&(t.adler=F(t.adler,a.pending_buf,a.pending-n,n)),0===r&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&pt(t),a.pending+2<=a.pending_buf_size&&(gt(a,255&t.adler),gt(a,t.adler>>8&255),t.adler=0,a.status=113)):a.status=113),0!==a.pending){if(pt(t),0===t.avail_out)return a.last_flush=-1,K}else if(0===t.avail_in&&ht(e)<=ht(i)&&e!==Z)return ct(t,et);if(666===a.status&&0!==t.avail_in)return ct(t,et);if(0!==t.avail_in||0!==a.lookahead||e!==Y&&666!==a.status){let n=a.strategy===at?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(_t(t),0===t.lookahead)){if(e===Y)return 1;break}if(t.match_length=0,n=G(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(vt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Z?(vt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(vt(t,!1),0===t.strm.avail_out)?1:2})(a,e):a.strategy===it?((t,e)=>{let n,r,a,i;const s=t.window;for(;;){if(t.lookahead<=258){if(_t(t),t.lookahead<=258&&e===Y)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(a=t.strstart-1,r=s[a],r===s[++a]&&r===s[++a]&&r===s[++a])){i=t.strstart+258;do{}while(r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&a<i);t.match_length=258-(i-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=G(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=G(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(vt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Z?(vt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(vt(t,!1),0===t.strm.avail_out)?1:2})(a,e):Et[a.level].func(a,e);if(3!==n&&4!==n||(a.status=666),1===n||3===n)return 0===t.avail_out&&(a.last_flush=-1),K;if(2===n&&(e===X?$(a):e!==q&&(j(a,0,0,!1),e===W&&(dt(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),pt(t),0===t.avail_out))return a.last_flush=-1,K}return e!==Z?K:a.wrap<=0?J:(2===a.wrap?(gt(a,255&t.adler),gt(a,t.adler>>8&255),gt(a,t.adler>>16&255),gt(a,t.adler>>24&255),gt(a,255&t.total_in),gt(a,t.total_in>>8&255),gt(a,t.total_in>>16&255),gt(a,t.total_in>>24&255)):(mt(a,t.adler>>>16),mt(a,65535&t.adler)),pt(t),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?K:J)},deflateEnd:t=>{if(!t||!t.state)return Q;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?ct(t,Q):(t.state=null,113===e?ct(t,tt):K)},deflateSetDictionary:(t,e)=>{let n=e.length;if(!t||!t.state)return Q;const r=t.state,a=r.wrap;if(2===a||1===a&&42!==r.status||r.lookahead)return Q;if(1===a&&(t.adler=I(t.adler,e,n,0)),r.wrap=0,n>=r.w_size){0===a&&(dt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let t=new Uint8Array(r.w_size);t.set(e.subarray(n-r.w_size,n),0),e=t,n=r.w_size}const i=t.avail_in,s=t.next_in,o=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,_t(r);r.lookahead>=3;){let t=r.strstart,e=r.lookahead-2;do{r.ins_h=ft(r,r.ins_h,r.window[t+3-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++}while(--e);r.strstart=t,r.lookahead=2,_t(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=s,t.input=o,t.avail_in=i,r.wrap=a,K},deflateInfo:"pako deflate (from Nodeca project)"};const Rt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Dt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const e in n)Rt(n,e)&&(t[e]=n[e])}}return t},At=t=>{let e=0;for(let n=0,r=t.length;n<r;n++)e+=t[n].length;const n=new Uint8Array(e);for(let e=0,r=0,a=t.length;e<a;e++){let a=t[e];n.set(a,r),r+=a.length}return n};let Lt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Lt=!1}const Pt=new Uint8Array(256);for(let t=0;t<256;t++)Pt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Pt[254]=Pt[254]=1;var Nt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,r,a,i,s=t.length,o=0;for(a=0;a<s;a++)n=t.charCodeAt(a),55296==(64512&n)&&a+1<s&&(r=t.charCodeAt(a+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),a++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),i=0,a=0;i<o;a++)n=t.charCodeAt(a),55296==(64512&n)&&a+1<s&&(r=t.charCodeAt(a+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),a++)),n<128?e[i++]=n:n<2048?(e[i++]=192|n>>>6,e[i++]=128|63&n):n<65536?(e[i++]=224|n>>>12,e[i++]=128|n>>>6&63,e[i++]=128|63&n):(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63,e[i++]=128|n>>>6&63,e[i++]=128|63&n);return e},It=(t,e)=>{const n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,a;const i=new Array(2*n);for(a=0,r=0;r<n;){let e=t[r++];if(e<128){i[a++]=e;continue}let s=Pt[e];if(s>4)i[a++]=65533,r+=s-1;else{for(e&=2===s?31:3===s?15:7;s>1&&r<n;)e=e<<6|63&t[r++],s--;s>1?i[a++]=65533:e<65536?i[a++]=e:(e-=65536,i[a++]=55296|e>>10&1023,i[a++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Lt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n})(i,a)},Ht=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+Pt[t[n]]>e?n:e};var Ft=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const zt=Object.prototype.toString,{Z_NO_FLUSH:Vt,Z_SYNC_FLUSH:Ut,Z_FULL_FLUSH:jt,Z_FINISH:Bt,Z_OK:Gt,Z_STREAM_END:$t,Z_DEFAULT_COMPRESSION:Yt,Z_DEFAULT_STRATEGY:Xt,Z_DEFLATED:Wt}=V;function Zt(t){this.options=Dt({level:Yt,method:Wt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Xt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ft,this.strm.avail_out=0;let n=Ct.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==Gt)throw new Error(z[n]);if(e.header&&Ct.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Nt(e.dictionary):"[object ArrayBuffer]"===zt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=Ct.deflateSetDictionary(this.strm,t),n!==Gt)throw new Error(z[n]);this._dict_set=!0}}function qt(t,e){const n=new Zt(e);if(n.push(t,!0),n.err)throw n.msg||z[n.err];return n.result}Zt.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize;let a,i;if(this.ended)return!1;for(i=e===~~e?e:!0===e?Bt:Vt,"string"==typeof t?n.input=Nt(t):"[object ArrayBuffer]"===zt.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===Ut||i===jt)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(a=Ct.deflate(n,i),a===$t)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),a=Ct.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Gt;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Zt.prototype.onData=function(t){this.chunks.push(t)},Zt.prototype.onEnd=function(t){t===Gt&&(this.result=At(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Kt={Deflate:Zt,deflate:qt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,qt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,qt(t,e)},constants:V};var Jt=function(t,e){let n,r,a,i,s,o,l,u,c,h,d,f,p,v,g,m,y,b,_,w,k,x,E,T;const S=t.state;n=t.next_in,E=t.input,r=n+(t.avail_in-5),a=t.next_out,T=t.output,i=a-(e-t.avail_out),s=a+(t.avail_out-257),o=S.dmax,l=S.wsize,u=S.whave,c=S.wnext,h=S.window,d=S.hold,f=S.bits,p=S.lencode,v=S.distcode,g=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;t:do{f<15&&(d+=E[n++]<<f,f+=8,d+=E[n++]<<f,f+=8),y=p[d&g];e:for(;;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,0===b)T[a++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=p[(65535&y)+(d&(1<<b)-1)];continue e}if(32&b){S.mode=12;break t}t.msg="invalid literal/length code",S.mode=30;break t}_=65535&y,b&=15,b&&(f<b&&(d+=E[n++]<<f,f+=8),_+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=E[n++]<<f,f+=8,d+=E[n++]<<f,f+=8),y=v[d&m];n:for(;;){if(b=y>>>24,d>>>=b,f-=b,b=y>>>16&255,!(16&b)){if(0==(64&b)){y=v[(65535&y)+(d&(1<<b)-1)];continue n}t.msg="invalid distance code",S.mode=30;break t}if(w=65535&y,b&=15,f<b&&(d+=E[n++]<<f,f+=8,f<b&&(d+=E[n++]<<f,f+=8)),w+=d&(1<<b)-1,w>o){t.msg="invalid distance too far back",S.mode=30;break t}if(d>>>=b,f-=b,b=a-i,w>b){if(b=w-b,b>u&&S.sane){t.msg="invalid distance too far back",S.mode=30;break t}if(k=0,x=h,0===c){if(k+=l-b,b<_){_-=b;do{T[a++]=h[k++]}while(--b);k=a-w,x=T}}else if(c<b){if(k+=l+c-b,b-=c,b<_){_-=b;do{T[a++]=h[k++]}while(--b);if(k=0,c<_){b=c,_-=b;do{T[a++]=h[k++]}while(--b);k=a-w,x=T}}}else if(k+=c-b,b<_){_-=b;do{T[a++]=h[k++]}while(--b);k=a-w,x=T}for(;_>2;)T[a++]=x[k++],T[a++]=x[k++],T[a++]=x[k++],_-=3;_&&(T[a++]=x[k++],_>1&&(T[a++]=x[k++]))}else{k=a-w;do{T[a++]=T[k++],T[a++]=T[k++],T[a++]=T[k++],_-=3}while(_>2);_&&(T[a++]=T[k++],_>1&&(T[a++]=T[k++]))}break}}break}}while(n<r&&a<s);_=f>>3,n-=_,f-=_<<3,d&=(1<<f)-1,t.next_in=n,t.next_out=a,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=a<s?s-a+257:257-(a-s),S.hold=d,S.bits=f};const Qt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),te=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ee=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ne=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var re=(t,e,n,r,a,i,s,o)=>{const l=o.bits;let u,c,h,d,f,p,v=0,g=0,m=0,y=0,b=0,_=0,w=0,k=0,x=0,E=0,T=null,S=0;const O=new Uint16Array(16),M=new Uint16Array(16);let C,R,D,A=null,L=0;for(v=0;v<=15;v++)O[v]=0;for(g=0;g<r;g++)O[e[n+g]]++;for(b=l,y=15;y>=1&&0===O[y];y--);if(b>y&&(b=y),0===y)return a[i++]=20971520,a[i++]=20971520,o.bits=1,0;for(m=1;m<y&&0===O[m];m++);for(b<m&&(b=m),k=1,v=1;v<=15;v++)if(k<<=1,k-=O[v],k<0)return-1;if(k>0&&(0===t||1!==y))return-1;for(M[1]=0,v=1;v<15;v++)M[v+1]=M[v]+O[v];for(g=0;g<r;g++)0!==e[n+g]&&(s[M[e[n+g]]++]=g);if(0===t?(T=A=s,p=19):1===t?(T=Qt,S-=257,A=te,L-=257,p=256):(T=ee,A=ne,p=-1),E=0,g=0,v=m,f=i,_=b,w=0,h=-1,x=1<<b,d=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){C=v-w,s[g]<p?(R=0,D=s[g]):s[g]>p?(R=A[L+s[g]],D=T[S+s[g]]):(R=96,D=0),u=1<<v-w,c=1<<_,m=c;do{c-=u,a[f+(E>>w)+c]=C<<24|R<<16|D|0}while(0!==c);for(u=1<<v-1;E&u;)u>>=1;if(0!==u?(E&=u-1,E+=u):E=0,g++,0==--O[v]){if(v===y)break;v=e[n+s[g]]}if(v>b&&(E&d)!==h){for(0===w&&(w=b),f+=m,_=v-w,k=1<<_;_+w<y&&(k-=O[_+w],!(k<=0));)_++,k<<=1;if(x+=1<<_,1===t&&x>852||2===t&&x>592)return 1;h=E&d,a[h]=b<<24|_<<16|f-i|0}}return 0!==E&&(a[f+E]=v-w<<24|64<<16|0),o.bits=b,0};const{Z_FINISH:ae,Z_BLOCK:ie,Z_TREES:se,Z_OK:oe,Z_STREAM_END:le,Z_NEED_DICT:ue,Z_STREAM_ERROR:ce,Z_DATA_ERROR:he,Z_MEM_ERROR:de,Z_BUF_ERROR:fe,Z_DEFLATED:pe}=V,ve=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function ge(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const me=t=>{if(!t||!t.state)return ce;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,oe},ye=t=>{if(!t||!t.state)return ce;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,me(t)},be=(t,e)=>{let n;if(!t||!t.state)return ce;const r=t.state;return e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ce:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,ye(t))},_e=(t,e)=>{if(!t)return ce;const n=new ge;t.state=n,n.window=null;const r=be(t,e);return r!==oe&&(t.state=null),r};let we,ke,xe=!0;const Ee=t=>{if(xe){we=new Int32Array(512),ke=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(re(1,t.lens,0,288,we,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;re(2,t.lens,0,32,ke,0,t.work,{bits:5}),xe=!1}t.lencode=we,t.lenbits=9,t.distcode=ke,t.distbits=5},Te=(t,e,n,r)=>{let a;const i=t.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(e.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>r&&(a=r),i.window.set(e.subarray(n-r,n-r+a),i.wnext),(r-=a)?(i.window.set(e.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0};var Se={inflateReset:ye,inflateReset2:be,inflateResetKeep:me,inflateInit:t=>_e(t,15),inflateInit2:_e,inflate:(t,e)=>{let n,r,a,i,s,o,l,u,c,h,d,f,p,v,g,m,y,b,_,w,k,x,E=0;const T=new Uint8Array(4);let S,O;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return ce;n=t.state,12===n.mode&&(n.mode=13),s=t.next_out,a=t.output,l=t.avail_out,i=t.next_in,r=t.input,o=t.avail_in,u=n.hold,c=n.bits,h=o,d=l,x=oe;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;c<16;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(2&n.wrap&&35615===u){n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=F(n.check,T,2,0),u=0,c=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=30;break}if((15&u)!==pe){t.msg="unknown compression method",n.mode=30;break}if(u>>>=4,c-=4,k=8+(15&u),0===n.wbits)n.wbits=k;else if(k>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<n.wbits,t.adler=n.check=1,n.mode=512&u?10:12,u=0,c=0;break;case 2:for(;c<16;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(n.flags=u,(255&n.flags)!==pe){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=F(n.check,T,2,0)),u=0,c=0,n.mode=3;case 3:for(;c<32;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.head&&(n.head.time=u),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=F(n.check,T,4,0)),u=0,c=0,n.mode=4;case 4:for(;c<16;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=F(n.check,T,2,0)),u=0,c=0,n.mode=5;case 5:if(1024&n.flags){for(;c<16;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=F(n.check,T,2,0)),u=0,c=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(f=n.length,f>o&&(f=o),f&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+f),k)),512&n.flags&&(n.check=F(n.check,r,f,i)),o-=f,i+=f,n.length-=f),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===o)break t;f=0;do{k=r[i+f++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&f<o);if(512&n.flags&&(n.check=F(n.check,r,f,i)),o-=f,i+=f,k)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===o)break t;f=0;do{k=r[i+f++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&f<o);if(512&n.flags&&(n.check=F(n.check,r,f,i)),o-=f,i+=f,k)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;c<16;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(u!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}u=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;c<32;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}t.adler=n.check=ve(u),u=0,c=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=s,t.avail_out=l,t.next_in=i,t.avail_in=o,n.hold=u,n.bits=c,ue;t.adler=n.check=1,n.mode=12;case 12:if(e===ie||e===se)break t;case 13:if(n.last){u>>>=7&c,c-=7&c,n.mode=27;break}for(;c<3;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}switch(n.last=1&u,u>>>=1,c-=1,3&u){case 0:n.mode=14;break;case 1:if(Ee(n),n.mode=20,e===se){u>>>=2,c-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}u>>>=2,c-=2;break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&u,u=0,c=0,n.mode=15,e===se)break t;case 15:n.mode=16;case 16:if(f=n.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break t;a.set(r.subarray(i,i+f),s),o-=f,i+=f,l-=f,s+=f,n.length-=f;break}n.mode=12;break;case 17:for(;c<14;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(n.nlen=257+(31&u),u>>>=5,c-=5,n.ndist=1+(31&u),u>>>=5,c-=5,n.ncode=4+(15&u),u>>>=4,c-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;c<3;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.lens[M[n.have++]]=7&u,u>>>=3,c-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},x=re(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,x){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[u&(1<<n.lenbits)-1],g=E>>>24,m=E>>>16&255,y=65535&E,!(g<=c);){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(y<16)u>>>=g,c-=g,n.lens[n.have++]=y;else{if(16===y){for(O=g+2;c<O;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(u>>>=g,c-=g,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}k=n.lens[n.have-1],f=3+(3&u),u>>>=2,c-=2}else if(17===y){for(O=g+3;c<O;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}u>>>=g,c-=g,k=0,f=3+(7&u),u>>>=3,c-=3}else{for(O=g+7;c<O;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}u>>>=g,c-=g,k=0,f=11+(127&u),u>>>=7,c-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;f--;)n.lens[n.have++]=k}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,S={bits:n.lenbits},x=re(1,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,x){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},x=re(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,x){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,e===se)break t;case 20:n.mode=21;case 21:if(o>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=i,t.avail_in=o,n.hold=u,n.bits=c,Jt(t,d),s=t.next_out,a=t.output,l=t.avail_out,i=t.next_in,r=t.input,o=t.avail_in,u=n.hold,c=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;E=n.lencode[u&(1<<n.lenbits)-1],g=E>>>24,m=E>>>16&255,y=65535&E,!(g<=c);){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(m&&0==(240&m)){for(b=g,_=m,w=y;E=n.lencode[w+((u&(1<<b+_)-1)>>b)],g=E>>>24,m=E>>>16&255,y=65535&E,!(b+g<=c);){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}u>>>=b,c-=b,n.back+=b}if(u>>>=g,c-=g,n.back+=g,n.length=y,0===m){n.mode=26;break}if(32&m){n.back=-1,n.mode=12;break}if(64&m){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&m,n.mode=22;case 22:if(n.extra){for(O=n.extra;c<O;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=n.distcode[u&(1<<n.distbits)-1],g=E>>>24,m=E>>>16&255,y=65535&E,!(g<=c);){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(0==(240&m)){for(b=g,_=m,w=y;E=n.distcode[w+((u&(1<<b+_)-1)>>b)],g=E>>>24,m=E>>>16&255,y=65535&E,!(b+g<=c);){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}u>>>=b,c-=b,n.back+=b}if(u>>>=g,c-=g,n.back+=g,64&m){t.msg="invalid distance code",n.mode=30;break}n.offset=y,n.extra=15&m,n.mode=24;case 24:if(n.extra){for(O=n.extra;c<O;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break t;if(f=d-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),v=n.window}else v=a,p=s-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{a[s++]=v[p++]}while(--f);0===n.length&&(n.mode=21);break;case 26:if(0===l)break t;a[s++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;c<32;){if(0===o)break t;o--,u|=r[i++]<<c,c+=8}if(d-=l,t.total_out+=d,n.total+=d,d&&(t.adler=n.check=n.flags?F(n.check,a,d,s-d):I(n.check,a,d,s-d)),d=l,(n.flags?u:ve(u))!==n.check){t.msg="incorrect data check",n.mode=30;break}u=0,c=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;c<32;){if(0===o)break t;o--,u+=r[i++]<<c,c+=8}if(u!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}u=0,c=0}n.mode=29;case 29:x=le;break t;case 30:x=he;break t;case 31:return de;case 32:default:return ce}return t.next_out=s,t.avail_out=l,t.next_in=i,t.avail_in=o,n.hold=u,n.bits=c,(n.wsize||d!==t.avail_out&&n.mode<30&&(n.mode<27||e!==ae))&&Te(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,n.total+=d,n.wrap&&d&&(t.adler=n.check=n.flags?F(n.check,a,d,t.next_out-d):I(n.check,a,d,t.next_out-d)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===h&&0===d||e===ae)&&x===oe&&(x=fe),x},inflateEnd:t=>{if(!t||!t.state)return ce;let e=t.state;return e.window&&(e.window=null),t.state=null,oe},inflateGetHeader:(t,e)=>{if(!t||!t.state)return ce;const n=t.state;return 0==(2&n.wrap)?ce:(n.head=e,e.done=!1,oe)},inflateSetDictionary:(t,e)=>{const n=e.length;let r,a,i;return t&&t.state?(r=t.state,0!==r.wrap&&11!==r.mode?ce:11===r.mode&&(a=1,a=I(a,e,n,0),a!==r.check)?he:(i=Te(t,e,n,n),i?(r.mode=31,de):(r.havedict=1,oe))):ce},inflateInfo:"pako inflate (from Nodeca project)"};var Oe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Me=Object.prototype.toString,{Z_NO_FLUSH:Ce,Z_FINISH:Re,Z_OK:De,Z_STREAM_END:Ae,Z_NEED_DICT:Le,Z_STREAM_ERROR:Pe,Z_DATA_ERROR:Ne,Z_MEM_ERROR:Ie}=V;function He(t){this.options=Dt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ft,this.strm.avail_out=0;let n=Se.inflateInit2(this.strm,e.windowBits);if(n!==De)throw new Error(z[n]);if(this.header=new Oe,Se.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Nt(e.dictionary):"[object ArrayBuffer]"===Me.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Se.inflateSetDictionary(this.strm,e.dictionary),n!==De)))throw new Error(z[n])}function Fe(t,e){const n=new He(e);if(n.push(t),n.err)throw n.msg||z[n.err];return n.result}He.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Re:Ce,"[object ArrayBuffer]"===Me.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=Se.inflate(n,s),i===Le&&a&&(i=Se.inflateSetDictionary(n,a),i===De?i=Se.inflate(n,s):i===Ne&&(i=Le));n.avail_in>0&&i===Ae&&n.state.wrap>0&&0!==t[n.next_in];)Se.inflateReset(n),i=Se.inflate(n,s);switch(i){case Pe:case Ne:case Le:case Ie:return this.onEnd(i),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||i===Ae))if("string"===this.options.to){let t=Ht(n.output,n.next_out),e=n.next_out-t,a=It(n.output,t);n.next_out=e,n.avail_out=r-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(a)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==De||0!==o){if(i===Ae)return i=Se.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},He.prototype.onData=function(t){this.chunks.push(t)},He.prototype.onEnd=function(t){t===De&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=At(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ze={Inflate:He,inflate:Fe,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Fe(t,e)},ungzip:Fe,constants:V};const{Deflate:Ve,deflate:Ue,deflateRaw:je,gzip:Be}=Kt,{Inflate:Ge,inflate:$e,inflateRaw:Ye,ungzip:Xe}=ze;var We=Ve,Ze=Ue,qe=je,Ke=Be,Je=Ge,Qe=$e,tn=Ye,en=Xe,nn=V,rn={Deflate:Ve,deflate:Ue,deflateRaw:je,gzip:Be,Inflate:Ge,inflate:$e,inflateRaw:Ye,ungzip:Xe,constants:V}},function(t,e,n){(function(n){var r,a;a=this,void 0===(r=function(){return a.Chartist=function(){var t={version:"0.11.4"};return function(t,e){"use strict";var n=t.window,r=t.document;e.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},e.noop=function(t){return t},e.alphaNumerate=function(t){return String.fromCharCode(97+t%26)},e.extend=function(t){var n,r,a;for(t=t||{},n=1;n<arguments.length;n++)for(var i in r=arguments[n])a=r[i],t[i]="object"!=typeof a||null===a||a instanceof Array?a:e.extend(t[i],a);return t},e.replaceAll=function(t,e,n){return t.replace(new RegExp(e,"g"),n)},e.ensureUnit=function(t,e){return"number"==typeof t&&(t+=e),t},e.quantity=function(t){if("string"==typeof t){var e=/^(\d+)\s*(.*)$/g.exec(t);return{value:+e[1],unit:e[2]||void 0}}return{value:t}},e.querySelector=function(t){return t instanceof Node?t:r.querySelector(t)},e.times=function(t){return Array.apply(null,new Array(t))},e.sum=function(t,e){return t+(e||0)},e.mapMultiply=function(t){return function(e){return e*t}},e.mapAdd=function(t){return function(e){return e+t}},e.serialMap=function(t,n){var r=[],a=Math.max.apply(null,t.map((function(t){return t.length})));return e.times(a).forEach((function(e,a){var i=t.map((function(t){return t[a]}));r[a]=n.apply(null,i)})),r},e.roundWithPrecision=function(t,n){var r=Math.pow(10,n||e.precision);return Math.round(t*r)/r},e.precision=8,e.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},e.serialize=function(t){return null==t?t:("number"==typeof t?t=""+t:"object"==typeof t&&(t=JSON.stringify({data:t})),Object.keys(e.escapingMap).reduce((function(t,n){return e.replaceAll(t,n,e.escapingMap[n])}),t))},e.deserialize=function(t){if("string"!=typeof t)return t;t=Object.keys(e.escapingMap).reduce((function(t,n){return e.replaceAll(t,e.escapingMap[n],n)}),t);try{t=void 0!==(t=JSON.parse(t)).data?t.data:t}catch(t){}return t},e.createSvg=function(t,n,r,a){var i;return n=n||"100%",r=r||"100%",Array.prototype.slice.call(t.querySelectorAll("svg")).filter((function(t){return t.getAttributeNS(e.namespaces.xmlns,"ct")})).forEach((function(e){t.removeChild(e)})),(i=new e.Svg("svg").attr({width:n,height:r}).addClass(a))._node.style.width=n,i._node.style.height=r,t.appendChild(i._node),i},e.normalizeData=function(t,n,r){var a,i={raw:t,normalized:{}};return i.normalized.series=e.getDataArray({series:t.series||[]},n,r),a=i.normalized.series.every((function(t){return t instanceof Array}))?Math.max.apply(null,i.normalized.series.map((function(t){return t.length}))):i.normalized.series.length,i.normalized.labels=(t.labels||[]).slice(),Array.prototype.push.apply(i.normalized.labels,e.times(Math.max(0,a-i.normalized.labels.length)).map((function(){return""}))),n&&e.reverseData(i.normalized),i},e.safeHasProperty=function(t,e){return null!==t&&"object"==typeof t&&t.hasOwnProperty(e)},e.isDataHoleValue=function(t){return null==t||"number"==typeof t&&isNaN(t)},e.reverseData=function(t){t.labels.reverse(),t.series.reverse();for(var e=0;e<t.series.length;e++)"object"==typeof t.series[e]&&void 0!==t.series[e].data?t.series[e].data.reverse():t.series[e]instanceof Array&&t.series[e].reverse()},e.getDataArray=function(t,n,r){return t.series.map((function t(n){if(e.safeHasProperty(n,"value"))return t(n.value);if(e.safeHasProperty(n,"data"))return t(n.data);if(n instanceof Array)return n.map(t);if(!e.isDataHoleValue(n)){if(r){var a={};return"string"==typeof r?a[r]=e.getNumberOrUndefined(n):a.y=e.getNumberOrUndefined(n),a.x=n.hasOwnProperty("x")?e.getNumberOrUndefined(n.x):a.x,a.y=n.hasOwnProperty("y")?e.getNumberOrUndefined(n.y):a.y,a}return e.getNumberOrUndefined(n)}}))},e.normalizePadding=function(t,e){return e=e||0,"number"==typeof t?{top:t,right:t,bottom:t,left:t}:{top:"number"==typeof t.top?t.top:e,right:"number"==typeof t.right?t.right:e,bottom:"number"==typeof t.bottom?t.bottom:e,left:"number"==typeof t.left?t.left:e}},e.getMetaData=function(t,e){var n=t.data?t.data[e]:t[e];return n?n.meta:void 0},e.orderOfMagnitude=function(t){return Math.floor(Math.log(Math.abs(t))/Math.LN10)},e.projectLength=function(t,e,n){return e/n.range*t},e.getAvailableHeight=function(t,n){return Math.max((e.quantity(n.height).value||t.height())-(n.chartPadding.top+n.chartPadding.bottom)-n.axisX.offset,0)},e.getHighLow=function(t,n,r){var a={high:void 0===(n=e.extend({},n,r?n["axis"+r.toUpperCase()]:{})).high?-Number.MAX_VALUE:+n.high,low:void 0===n.low?Number.MAX_VALUE:+n.low},i=void 0===n.high,s=void 0===n.low;return(i||s)&&function t(e){if(void 0!==e)if(e instanceof Array)for(var n=0;n<e.length;n++)t(e[n]);else{var o=r?+e[r]:+e;i&&o>a.high&&(a.high=o),s&&o<a.low&&(a.low=o)}}(t),(n.referenceValue||0===n.referenceValue)&&(a.high=Math.max(n.referenceValue,a.high),a.low=Math.min(n.referenceValue,a.low)),a.high<=a.low&&(0===a.low?a.high=1:a.low<0?a.high=0:(a.high>0||(a.high=1),a.low=0)),a},e.isNumeric=function(t){return null!==t&&isFinite(t)},e.isFalseyButZero=function(t){return!t&&0!==t},e.getNumberOrUndefined=function(t){return e.isNumeric(t)?+t:void 0},e.isMultiValue=function(t){return"object"==typeof t&&("x"in t||"y"in t)},e.getMultiValue=function(t,n){return e.isMultiValue(t)?e.getNumberOrUndefined(t[n||"y"]):e.getNumberOrUndefined(t)},e.rho=function(t){if(1===t)return t;function e(t,n){return t%n==0?n:e(n,t%n)}function n(t){return t*t+1}var r,a=2,i=2;if(t%2==0)return 2;do{a=n(a)%t,i=n(n(i))%t,r=e(Math.abs(a-i),t)}while(1===r);return r},e.getBounds=function(t,n,r,a){var i,s,o,l=0,u={high:n.high,low:n.low};u.valueRange=u.high-u.low,u.oom=e.orderOfMagnitude(u.valueRange),u.step=Math.pow(10,u.oom),u.min=Math.floor(u.low/u.step)*u.step,u.max=Math.ceil(u.high/u.step)*u.step,u.range=u.max-u.min,u.numberOfSteps=Math.round(u.range/u.step);var c=e.projectLength(t,u.step,u)<r,h=a?e.rho(u.range):0;if(a&&e.projectLength(t,1,u)>=r)u.step=1;else if(a&&h<u.step&&e.projectLength(t,h,u)>=r)u.step=h;else for(;;){if(c&&e.projectLength(t,u.step,u)<=r)u.step*=2;else{if(c||!(e.projectLength(t,u.step/2,u)>=r))break;if(u.step/=2,a&&u.step%1!=0){u.step*=2;break}}if(l++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}function d(t,e){return t===(t+=e)&&(t*=1+(e>0?2221e-19:-2221e-19)),t}for(u.step=Math.max(u.step,2221e-19),s=u.min,o=u.max;s+u.step<=u.low;)s=d(s,u.step);for(;o-u.step>=u.high;)o=d(o,-u.step);u.min=s,u.max=o,u.range=u.max-u.min;var f=[];for(i=u.min;i<=u.max;i=d(i,u.step)){var p=e.roundWithPrecision(i);p!==f[f.length-1]&&f.push(p)}return u.values=f,u},e.polarToCartesian=function(t,e,n,r){var a=(r-90)*Math.PI/180;return{x:t+n*Math.cos(a),y:e+n*Math.sin(a)}},e.createChartRect=function(t,n,r){var a=!(!n.axisX&&!n.axisY),i=a?n.axisY.offset:0,s=a?n.axisX.offset:0,o=t.width()||e.quantity(n.width).value||0,l=t.height()||e.quantity(n.height).value||0,u=e.normalizePadding(n.chartPadding,r);o=Math.max(o,i+u.left+u.right),l=Math.max(l,s+u.top+u.bottom);var c={padding:u,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return a?("start"===n.axisX.position?(c.y2=u.top+s,c.y1=Math.max(l-u.bottom,c.y2+1)):(c.y2=u.top,c.y1=Math.max(l-u.bottom-s,c.y2+1)),"start"===n.axisY.position?(c.x1=u.left+i,c.x2=Math.max(o-u.right,c.x1+1)):(c.x1=u.left,c.x2=Math.max(o-u.right-i,c.x1+1))):(c.x1=u.left,c.x2=Math.max(o-u.right,c.x1+1),c.y2=u.top,c.y1=Math.max(l-u.bottom,c.y2+1)),c},e.createGrid=function(t,n,r,a,i,s,o,l){var u={};u[r.units.pos+"1"]=t,u[r.units.pos+"2"]=t,u[r.counterUnits.pos+"1"]=a,u[r.counterUnits.pos+"2"]=a+i;var c=s.elem("line",u,o.join(" "));l.emit("draw",e.extend({type:"grid",axis:r,index:n,group:s,element:c},u))},e.createGridBackground=function(t,e,n,r){var a=t.elem("rect",{x:e.x1,y:e.y2,width:e.width(),height:e.height()},n,!0);r.emit("draw",{type:"gridBackground",group:t,element:a})},e.createLabel=function(t,n,a,i,s,o,l,u,c,h,d){var f,p={};if(p[s.units.pos]=t+l[s.units.pos],p[s.counterUnits.pos]=l[s.counterUnits.pos],p[s.units.len]=n,p[s.counterUnits.len]=Math.max(0,o-10),h){var v=r.createElement("span");v.className=c.join(" "),v.setAttribute("xmlns",e.namespaces.xhtml),v.innerText=i[a],v.style[s.units.len]=Math.round(p[s.units.len])+"px",v.style[s.counterUnits.len]=Math.round(p[s.counterUnits.len])+"px",f=u.foreignObject(v,e.extend({style:"overflow: visible;"},p))}else f=u.elem("text",p,c.join(" ")).text(i[a]);d.emit("draw",e.extend({type:"label",axis:s,index:a,group:u,element:f,text:i[a]},p))},e.getSeriesOption=function(t,e,n){if(t.name&&e.series&&e.series[t.name]){var r=e.series[t.name];return r.hasOwnProperty(n)?r[n]:e[n]}return e[n]},e.optionsProvider=function(t,r,a){var i,s,o=e.extend({},t),l=[];function u(t){var l=i;if(i=e.extend({},o),r)for(s=0;s<r.length;s++)n.matchMedia(r[s][0]).matches&&(i=e.extend(i,r[s][1]));a&&t&&a.emit("optionsChanged",{previousOptions:l,currentOptions:i})}if(!n.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(r)for(s=0;s<r.length;s++){var c=n.matchMedia(r[s][0]);c.addListener(u),l.push(c)}return u(),{removeMediaQueryListeners:function(){l.forEach((function(t){t.removeListener(u)}))},getCurrentOptions:function(){return e.extend({},i)}}},e.splitIntoSegments=function(t,n,r){r=e.extend({},{increasingX:!1,fillHoles:!1},r);for(var a=[],i=!0,s=0;s<t.length;s+=2)void 0===e.getMultiValue(n[s/2].value)?r.fillHoles||(i=!0):(r.increasingX&&s>=2&&t[s]<=t[s-2]&&(i=!0),i&&(a.push({pathCoordinates:[],valueData:[]}),i=!1),a[a.length-1].pathCoordinates.push(t[s],t[s+1]),a[a.length-1].valueData.push(n[s/2]));return a}}(this||n,t),function(t,e){"use strict";e.Interpolation={},e.Interpolation.none=function(t){return t=e.extend({},{fillHoles:!1},t),function(n,r){for(var a=new e.Svg.Path,i=!0,s=0;s<n.length;s+=2){var o=n[s],l=n[s+1],u=r[s/2];void 0!==e.getMultiValue(u.value)?(i?a.move(o,l,!1,u):a.line(o,l,!1,u),i=!1):t.fillHoles||(i=!0)}return a}},e.Interpolation.simple=function(t){t=e.extend({},{divisor:2,fillHoles:!1},t);var n=1/Math.max(1,t.divisor);return function(r,a){for(var i,s,o,l=new e.Svg.Path,u=0;u<r.length;u+=2){var c=r[u],h=r[u+1],d=(c-i)*n,f=a[u/2];void 0!==f.value?(void 0===o?l.move(c,h,!1,f):l.curve(i+d,s,c-d,h,c,h,!1,f),i=c,s=h,o=f):t.fillHoles||(i=c=o=void 0)}return l}},e.Interpolation.cardinal=function(t){t=e.extend({},{tension:1,fillHoles:!1},t);var n=Math.min(1,Math.max(0,t.tension)),r=1-n;return function a(i,s){var o=e.splitIntoSegments(i,s,{fillHoles:t.fillHoles});if(o.length){if(o.length>1){var l=[];return o.forEach((function(t){l.push(a(t.pathCoordinates,t.valueData))})),e.Svg.Path.join(l)}if(i=o[0].pathCoordinates,s=o[0].valueData,i.length<=4)return e.Interpolation.none()(i,s);for(var u=(new e.Svg.Path).move(i[0],i[1],!1,s[0]),c=0,h=i.length;h-2>c;c+=2){var d=[{x:+i[c-2],y:+i[c-1]},{x:+i[c],y:+i[c+1]},{x:+i[c+2],y:+i[c+3]},{x:+i[c+4],y:+i[c+5]}];h-4===c?d[3]=d[2]:c||(d[0]={x:+i[c],y:+i[c+1]}),u.curve(n*(-d[0].x+6*d[1].x+d[2].x)/6+r*d[2].x,n*(-d[0].y+6*d[1].y+d[2].y)/6+r*d[2].y,n*(d[1].x+6*d[2].x-d[3].x)/6+r*d[2].x,n*(d[1].y+6*d[2].y-d[3].y)/6+r*d[2].y,d[2].x,d[2].y,!1,s[(c+2)/2])}return u}return e.Interpolation.none()([])}},e.Interpolation.monotoneCubic=function(t){return t=e.extend({},{fillHoles:!1},t),function n(r,a){var i=e.splitIntoSegments(r,a,{fillHoles:t.fillHoles,increasingX:!0});if(i.length){if(i.length>1){var s=[];return i.forEach((function(t){s.push(n(t.pathCoordinates,t.valueData))})),e.Svg.Path.join(s)}if(r=i[0].pathCoordinates,a=i[0].valueData,r.length<=4)return e.Interpolation.none()(r,a);var o,l,u=[],c=[],h=r.length/2,d=[],f=[],p=[],v=[];for(o=0;o<h;o++)u[o]=r[2*o],c[o]=r[2*o+1];for(o=0;o<h-1;o++)p[o]=c[o+1]-c[o],v[o]=u[o+1]-u[o],f[o]=p[o]/v[o];for(d[0]=f[0],d[h-1]=f[h-2],o=1;o<h-1;o++)0===f[o]||0===f[o-1]||f[o-1]>0!=f[o]>0?d[o]=0:(d[o]=3*(v[o-1]+v[o])/((2*v[o]+v[o-1])/f[o-1]+(v[o]+2*v[o-1])/f[o]),isFinite(d[o])||(d[o]=0));for(l=(new e.Svg.Path).move(u[0],c[0],!1,a[0]),o=0;o<h-1;o++)l.curve(u[o]+v[o]/3,c[o]+d[o]*v[o]/3,u[o+1]-v[o]/3,c[o+1]-d[o+1]*v[o]/3,u[o+1],c[o+1],!1,a[o+1]);return l}return e.Interpolation.none()([])}},e.Interpolation.step=function(t){return t=e.extend({},{postpone:!0,fillHoles:!1},t),function(n,r){for(var a,i,s,o=new e.Svg.Path,l=0;l<n.length;l+=2){var u=n[l],c=n[l+1],h=r[l/2];void 0!==h.value?(void 0===s?o.move(u,c,!1,h):(t.postpone?o.line(u,i,!1,s):o.line(a,c,!1,h),o.line(u,c,!1,h)),a=u,i=c,s=h):t.fillHoles||(a=i=s=void 0)}return o}}}(0,t),function(t,e){"use strict";e.EventEmitter=function(){var t=[];return{addEventHandler:function(e,n){t[e]=t[e]||[],t[e].push(n)},removeEventHandler:function(e,n){t[e]&&(n?(t[e].splice(t[e].indexOf(n),1),0===t[e].length&&delete t[e]):delete t[e])},emit:function(e,n){t[e]&&t[e].forEach((function(t){t(n)})),t["*"]&&t["*"].forEach((function(t){t(e,n)}))}}}}(0,t),function(t,e){"use strict";function n(t){var e=[];if(t.length)for(var n=0;n<t.length;n++)e.push(t[n]);return e}e.Class={extend:function(t,n){var r=n||this.prototype||e.Class,a=Object.create(r);e.Class.cloneDefinitions(a,t);var i=function(){var t,n=a.constructor||function(){};return t=this===e?Object.create(a):this,n.apply(t,Array.prototype.slice.call(arguments,0)),t};return i.prototype=a,i.super=r,i.extend=this.extend,i},cloneDefinitions:function(){var t=n(arguments),e=t[0];return t.splice(1,t.length-1).forEach((function(t){Object.getOwnPropertyNames(t).forEach((function(n){delete e[n],Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))})),e}}}(0,t),function(t,e){"use strict";var n=t.window;function r(){n.addEventListener("resize",this.resizeListener),this.optionsProvider=e.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(t){t instanceof Array?t[0](this,t[1]):t(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}e.Base=e.Class.extend({constructor:function(t,n,a,i,s){this.container=e.querySelector(t),this.data=n||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=a,this.options=i,this.responsiveOptions=s,this.eventEmitter=e.EventEmitter(),this.supportsForeignObject=e.Svg.isSupported("Extensibility"),this.supportsAnimations=e.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(r.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function(t,n,r){return t&&(this.data=t||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),n&&(this.options=e.extend({},r?this.options:this.defaultOptions,n),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=e.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function(){return this.initializeTimeoutId?n.clearTimeout(this.initializeTimeoutId):(n.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function(t,e){return this.eventEmitter.addEventHandler(t,e),this},off:function(t,e){return this.eventEmitter.removeEventHandler(t,e),this},version:e.version,supportsForeignObject:!1})}(this||n,t),function(t,e){"use strict";var n=t.document;e.Svg=e.Class.extend({constructor:function(t,r,a,i,s){t instanceof Element?this._node=t:(this._node=n.createElementNS(e.namespaces.svg,t),"svg"===t&&this.attr({"xmlns:ct":e.namespaces.ct})),r&&this.attr(r),a&&this.addClass(a),i&&(s&&i._node.firstChild?i._node.insertBefore(this._node,i._node.firstChild):i._node.appendChild(this._node))},attr:function(t,n){return"string"==typeof t?n?this._node.getAttributeNS(n,t):this._node.getAttribute(t):(Object.keys(t).forEach(function(n){if(void 0!==t[n])if(-1!==n.indexOf(":")){var r=n.split(":");this._node.setAttributeNS(e.namespaces[r[0]],n,t[n])}else this._node.setAttribute(n,t[n])}.bind(this)),this)},elem:function(t,n,r,a){return new e.Svg(t,n,r,this,a)},parent:function(){return this._node.parentNode instanceof SVGElement?new e.Svg(this._node.parentNode):null},root:function(){for(var t=this._node;"svg"!==t.nodeName;)t=t.parentNode;return new e.Svg(t)},querySelector:function(t){var n=this._node.querySelector(t);return n?new e.Svg(n):null},querySelectorAll:function(t){var n=this._node.querySelectorAll(t);return n.length?new e.Svg.List(n):null},getNode:function(){return this._node},foreignObject:function(t,r,a,i){if("string"==typeof t){var s=n.createElement("div");s.innerHTML=t,t=s.firstChild}t.setAttribute("xmlns",e.namespaces.xmlns);var o=this.elem("foreignObject",r,a,i);return o._node.appendChild(t),o},text:function(t){return this._node.appendChild(n.createTextNode(t)),this},empty:function(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function(t){return this._node.parentNode.replaceChild(t._node,this._node),t},append:function(t,e){return e&&this._node.firstChild?this._node.insertBefore(t._node,this._node.firstChild):this._node.appendChild(t._node),this},classes:function(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function(t){return this._node.setAttribute("class",this.classes(this._node).concat(t.trim().split(/\s+/)).filter((function(t,e,n){return n.indexOf(t)===e})).join(" ")),this},removeClass:function(t){var e=t.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter((function(t){return-1===e.indexOf(t)})).join(" ")),this},removeAllClasses:function(){return this._node.setAttribute("class",""),this},height:function(){return this._node.getBoundingClientRect().height},width:function(){return this._node.getBoundingClientRect().width},animate:function(t,n,r){return void 0===n&&(n=!0),Object.keys(t).forEach(function(a){function i(t,n){var i,s,o,l={};t.easing&&(o=t.easing instanceof Array?t.easing:e.Svg.Easing[t.easing],delete t.easing),t.begin=e.ensureUnit(t.begin,"ms"),t.dur=e.ensureUnit(t.dur,"ms"),o&&(t.calcMode="spline",t.keySplines=o.join(" "),t.keyTimes="0;1"),n&&(t.fill="freeze",l[a]=t.from,this.attr(l),s=e.quantity(t.begin||0).value,t.begin="indefinite"),i=this.elem("animate",e.extend({attributeName:a},t)),n&&setTimeout(function(){try{i._node.beginElement()}catch(e){l[a]=t.to,this.attr(l),i.remove()}}.bind(this),s),r&&i._node.addEventListener("beginEvent",function(){r.emit("animationBegin",{element:this,animate:i._node,params:t})}.bind(this)),i._node.addEventListener("endEvent",function(){r&&r.emit("animationEnd",{element:this,animate:i._node,params:t}),n&&(l[a]=t.to,this.attr(l),i.remove())}.bind(this))}t[a]instanceof Array?t[a].forEach(function(t){i.bind(this)(t,!1)}.bind(this)):i.bind(this)(t[a],n)}.bind(this)),this}}),e.Svg.isSupported=function(t){return n.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+t,"1.1")},e.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},e.Svg.List=e.Class.extend({constructor:function(t){var n=this;this.svgElements=[];for(var r=0;r<t.length;r++)this.svgElements.push(new e.Svg(t[r]));Object.keys(e.Svg.prototype).filter((function(t){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(t)})).forEach((function(t){n[t]=function(){var r=Array.prototype.slice.call(arguments,0);return n.svgElements.forEach((function(n){e.Svg.prototype[t].apply(n,r)})),n}}))}})}(this||n,t),function(t,e){"use strict";var n={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},r={accuracy:3};function a(t,n,r,a,i,s){var o=e.extend({command:i?t.toLowerCase():t.toUpperCase()},n,s?{data:s}:{});r.splice(a,0,o)}function i(t,e){t.forEach((function(r,a){n[r.command.toLowerCase()].forEach((function(n,i){e(r,n,a,i,t)}))}))}e.Svg.Path=e.Class.extend({constructor:function(t,n){this.pathElements=[],this.pos=0,this.close=t,this.options=e.extend({},r,n)},position:function(t){return void 0!==t?(this.pos=Math.max(0,Math.min(this.pathElements.length,t)),this):this.pos},remove:function(t){return this.pathElements.splice(this.pos,t),this},move:function(t,e,n,r){return a("M",{x:+t,y:+e},this.pathElements,this.pos++,n,r),this},line:function(t,e,n,r){return a("L",{x:+t,y:+e},this.pathElements,this.pos++,n,r),this},curve:function(t,e,n,r,i,s,o,l){return a("C",{x1:+t,y1:+e,x2:+n,y2:+r,x:+i,y:+s},this.pathElements,this.pos++,o,l),this},arc:function(t,e,n,r,i,s,o,l,u){return a("A",{rx:+t,ry:+e,xAr:+n,lAf:+r,sf:+i,x:+s,y:+o},this.pathElements,this.pos++,l,u),this},scale:function(t,e){return i(this.pathElements,(function(n,r){n[r]*="x"===r[0]?t:e})),this},translate:function(t,e){return i(this.pathElements,(function(n,r){n[r]+="x"===r[0]?t:e})),this},transform:function(t){return i(this.pathElements,(function(e,n,r,a,i){var s=t(e,n,r,a,i);(s||0===s)&&(e[n]=s)})),this},parse:function(t){var r=t.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce((function(t,e){return e.match(/[A-Za-z]/)&&t.push([]),t[t.length-1].push(e),t}),[]);"Z"===r[r.length-1][0].toUpperCase()&&r.pop();var a=r.map((function(t){var r=t.shift(),a=n[r.toLowerCase()];return e.extend({command:r},a.reduce((function(e,n,r){return e[n]=+t[r],e}),{}))})),i=[this.pos,0];return Array.prototype.push.apply(i,a),Array.prototype.splice.apply(this.pathElements,i),this.pos+=a.length,this},stringify:function(){var t=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(e,r){var a=n[r.command.toLowerCase()].map(function(e){return this.options.accuracy?Math.round(r[e]*t)/t:r[e]}.bind(this));return e+r.command+a.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function(t){var n=new e.Svg.Path(t||this.close);return n.pos=this.pos,n.pathElements=this.pathElements.slice().map((function(t){return e.extend({},t)})),n.options=e.extend({},this.options),n},splitByCommand:function(t){var n=[new e.Svg.Path];return this.pathElements.forEach((function(r){r.command===t.toUpperCase()&&0!==n[n.length-1].pathElements.length&&n.push(new e.Svg.Path),n[n.length-1].pathElements.push(r)})),n}}),e.Svg.Path.elementDescriptions=n,e.Svg.Path.join=function(t,n,r){for(var a=new e.Svg.Path(n,r),i=0;i<t.length;i++)for(var s=t[i],o=0;o<s.pathElements.length;o++)a.pathElements.push(s.pathElements[o]);return a}}(0,t),function(t,e){"use strict";t.window,t.document;var n={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};e.Axis=e.Class.extend({constructor:function(t,e,r,a){this.units=t,this.counterUnits=t===n.x?n.y:n.x,this.chartRect=e,this.axisLength=e[t.rectEnd]-e[t.rectStart],this.gridOffset=e[t.rectOffset],this.ticks=r,this.options=a},createGridAndLabels:function(t,n,r,a,i){var s=a["axis"+this.units.pos.toUpperCase()],o=this.ticks.map(this.projectValue.bind(this)),l=this.ticks.map(s.labelInterpolationFnc);o.forEach(function(u,c){var h,d={x:0,y:0};h=o[c+1]?o[c+1]-u:Math.max(this.axisLength-u,30),e.isFalseyButZero(l[c])&&""!==l[c]||("x"===this.units.pos?(u=this.chartRect.x1+u,d.x=a.axisX.labelOffset.x,"start"===a.axisX.position?d.y=this.chartRect.padding.top+a.axisX.labelOffset.y+(r?5:20):d.y=this.chartRect.y1+a.axisX.labelOffset.y+(r?5:20)):(u=this.chartRect.y1-u,d.y=a.axisY.labelOffset.y-(r?h:0),"start"===a.axisY.position?d.x=r?this.chartRect.padding.left+a.axisY.labelOffset.x:this.chartRect.x1-10:d.x=this.chartRect.x2+a.axisY.labelOffset.x+10),s.showGrid&&e.createGrid(u,c,this,this.gridOffset,this.chartRect[this.counterUnits.len](),t,[a.classNames.grid,a.classNames[this.units.dir]],i),s.showLabel&&e.createLabel(u,h,c,l,this,s.offset,d,n,[a.classNames.label,a.classNames[this.units.dir],"start"===s.position?a.classNames[s.position]:a.classNames.end],r,i))}.bind(this))},projectValue:function(t,e,n){throw new Error("Base axis can't be instantiated!")}}),e.Axis.units=n}(this||n,t),function(t,e){"use strict";t.window,t.document,e.AutoScaleAxis=e.Axis.extend({constructor:function(t,n,r,a){var i=a.highLow||e.getHighLow(n,a,t.pos);this.bounds=e.getBounds(r[t.rectEnd]-r[t.rectStart],i,a.scaleMinSpace||20,a.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},e.AutoScaleAxis.super.constructor.call(this,t,r,this.bounds.values,a)},projectValue:function(t){return this.axisLength*(+e.getMultiValue(t,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||n,t),function(t,e){"use strict";t.window,t.document,e.FixedScaleAxis=e.Axis.extend({constructor:function(t,n,r,a){var i=a.highLow||e.getHighLow(n,a,t.pos);this.divisor=a.divisor||1,this.ticks=a.ticks||e.times(this.divisor).map(function(t,e){return i.low+(i.high-i.low)/this.divisor*e}.bind(this)),this.ticks.sort((function(t,e){return t-e})),this.range={min:i.low,max:i.high},e.FixedScaleAxis.super.constructor.call(this,t,r,this.ticks,a),this.stepLength=this.axisLength/this.divisor},projectValue:function(t){return this.axisLength*(+e.getMultiValue(t,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||n,t),function(t,e){"use strict";t.window,t.document,e.StepAxis=e.Axis.extend({constructor:function(t,n,r,a){e.StepAxis.super.constructor.call(this,t,r,a.ticks,a);var i=Math.max(1,a.ticks.length-(a.stretch?1:0));this.stepLength=this.axisLength/i},projectValue:function(t,e){return this.stepLength*e}})}(this||n,t),function(t,e){"use strict";t.window,t.document;var n={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};e.Line=e.Base.extend({constructor:function(t,r,a,i){e.Line.super.constructor.call(this,t,r,n,e.extend({},n,a),i)},createChart:function(t){var r=e.normalizeData(this.data,t.reverseData,!0);this.svg=e.createSvg(this.container,t.width,t.height,t.classNames.chart);var a,i,s=this.svg.elem("g").addClass(t.classNames.gridGroup),o=this.svg.elem("g"),l=this.svg.elem("g").addClass(t.classNames.labelGroup),u=e.createChartRect(this.svg,t,n.padding);a=void 0===t.axisX.type?new e.StepAxis(e.Axis.units.x,r.normalized.series,u,e.extend({},t.axisX,{ticks:r.normalized.labels,stretch:t.fullWidth})):t.axisX.type.call(e,e.Axis.units.x,r.normalized.series,u,t.axisX),i=void 0===t.axisY.type?new e.AutoScaleAxis(e.Axis.units.y,r.normalized.series,u,e.extend({},t.axisY,{high:e.isNumeric(t.high)?t.high:t.axisY.high,low:e.isNumeric(t.low)?t.low:t.axisY.low})):t.axisY.type.call(e,e.Axis.units.y,r.normalized.series,u,t.axisY),a.createGridAndLabels(s,l,this.supportsForeignObject,t,this.eventEmitter),i.createGridAndLabels(s,l,this.supportsForeignObject,t,this.eventEmitter),t.showGridBackground&&e.createGridBackground(s,u,t.classNames.gridBackground,this.eventEmitter),r.raw.series.forEach(function(n,s){var l=o.elem("g");l.attr({"ct:series-name":n.name,"ct:meta":e.serialize(n.meta)}),l.addClass([t.classNames.series,n.className||t.classNames.series+"-"+e.alphaNumerate(s)].join(" "));var c=[],h=[];r.normalized.series[s].forEach(function(t,o){var l={x:u.x1+a.projectValue(t,o,r.normalized.series[s]),y:u.y1-i.projectValue(t,o,r.normalized.series[s])};c.push(l.x,l.y),h.push({value:t,valueIndex:o,meta:e.getMetaData(n,o)})}.bind(this));var d={lineSmooth:e.getSeriesOption(n,t,"lineSmooth"),showPoint:e.getSeriesOption(n,t,"showPoint"),showLine:e.getSeriesOption(n,t,"showLine"),showArea:e.getSeriesOption(n,t,"showArea"),areaBase:e.getSeriesOption(n,t,"areaBase")},f=("function"==typeof d.lineSmooth?d.lineSmooth:d.lineSmooth?e.Interpolation.monotoneCubic():e.Interpolation.none())(c,h);if(d.showPoint&&f.pathElements.forEach(function(r){var o=l.elem("line",{x1:r.x,y1:r.y,x2:r.x+.01,y2:r.y},t.classNames.point).attr({"ct:value":[r.data.value.x,r.data.value.y].filter(e.isNumeric).join(","),"ct:meta":e.serialize(r.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:r.data.value,index:r.data.valueIndex,meta:r.data.meta,series:n,seriesIndex:s,axisX:a,axisY:i,group:l,element:o,x:r.x,y:r.y})}.bind(this)),d.showLine){var p=l.elem("path",{d:f.stringify()},t.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:r.normalized.series[s],path:f.clone(),chartRect:u,index:s,series:n,seriesIndex:s,seriesMeta:n.meta,axisX:a,axisY:i,group:l,element:p})}if(d.showArea&&i.range){var v=Math.max(Math.min(d.areaBase,i.range.max),i.range.min),g=u.y1-i.projectValue(v);f.splitByCommand("M").filter((function(t){return t.pathElements.length>1})).map((function(t){var e=t.pathElements[0],n=t.pathElements[t.pathElements.length-1];return t.clone(!0).position(0).remove(1).move(e.x,g).line(e.x,e.y).position(t.pathElements.length+1).line(n.x,g)})).forEach(function(e){var o=l.elem("path",{d:e.stringify()},t.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:r.normalized.series[s],path:e.clone(),series:n,seriesIndex:s,axisX:a,axisY:i,chartRect:u,index:s,group:l,element:o})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:i.bounds,chartRect:u,axisX:a,axisY:i,svg:this.svg,options:t})}})}(this||n,t),function(t,e){"use strict";t.window,t.document;var n={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:e.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};e.Bar=e.Base.extend({constructor:function(t,r,a,i){e.Bar.super.constructor.call(this,t,r,n,e.extend({},n,a),i)},createChart:function(t){var r,a;t.distributeSeries?(r=e.normalizeData(this.data,t.reverseData,t.horizontalBars?"x":"y")).normalized.series=r.normalized.series.map((function(t){return[t]})):r=e.normalizeData(this.data,t.reverseData,t.horizontalBars?"x":"y"),this.svg=e.createSvg(this.container,t.width,t.height,t.classNames.chart+(t.horizontalBars?" "+t.classNames.horizontalBars:""));var i=this.svg.elem("g").addClass(t.classNames.gridGroup),s=this.svg.elem("g"),o=this.svg.elem("g").addClass(t.classNames.labelGroup);if(t.stackBars&&0!==r.normalized.series.length){var l=e.serialMap(r.normalized.series,(function(){return Array.prototype.slice.call(arguments).map((function(t){return t})).reduce((function(t,e){return{x:t.x+(e&&e.x)||0,y:t.y+(e&&e.y)||0}}),{x:0,y:0})}));a=e.getHighLow([l],t,t.horizontalBars?"x":"y")}else a=e.getHighLow(r.normalized.series,t,t.horizontalBars?"x":"y");a.high=+t.high||(0===t.high?0:a.high),a.low=+t.low||(0===t.low?0:a.low);var u,c,h,d,f,p=e.createChartRect(this.svg,t,n.padding);c=t.distributeSeries&&t.stackBars?r.normalized.labels.slice(0,1):r.normalized.labels,t.horizontalBars?(u=d=void 0===t.axisX.type?new e.AutoScaleAxis(e.Axis.units.x,r.normalized.series,p,e.extend({},t.axisX,{highLow:a,referenceValue:0})):t.axisX.type.call(e,e.Axis.units.x,r.normalized.series,p,e.extend({},t.axisX,{highLow:a,referenceValue:0})),h=f=void 0===t.axisY.type?new e.StepAxis(e.Axis.units.y,r.normalized.series,p,{ticks:c}):t.axisY.type.call(e,e.Axis.units.y,r.normalized.series,p,t.axisY)):(h=d=void 0===t.axisX.type?new e.StepAxis(e.Axis.units.x,r.normalized.series,p,{ticks:c}):t.axisX.type.call(e,e.Axis.units.x,r.normalized.series,p,t.axisX),u=f=void 0===t.axisY.type?new e.AutoScaleAxis(e.Axis.units.y,r.normalized.series,p,e.extend({},t.axisY,{highLow:a,referenceValue:0})):t.axisY.type.call(e,e.Axis.units.y,r.normalized.series,p,e.extend({},t.axisY,{highLow:a,referenceValue:0})));var v=t.horizontalBars?p.x1+u.projectValue(0):p.y1-u.projectValue(0),g=[];h.createGridAndLabels(i,o,this.supportsForeignObject,t,this.eventEmitter),u.createGridAndLabels(i,o,this.supportsForeignObject,t,this.eventEmitter),t.showGridBackground&&e.createGridBackground(i,p,t.classNames.gridBackground,this.eventEmitter),r.raw.series.forEach(function(n,a){var i,o,l=a-(r.raw.series.length-1)/2;i=t.distributeSeries&&!t.stackBars?h.axisLength/r.normalized.series.length/2:t.distributeSeries&&t.stackBars?h.axisLength/2:h.axisLength/r.normalized.series[a].length/2,(o=s.elem("g")).attr({"ct:series-name":n.name,"ct:meta":e.serialize(n.meta)}),o.addClass([t.classNames.series,n.className||t.classNames.series+"-"+e.alphaNumerate(a)].join(" ")),r.normalized.series[a].forEach(function(s,c){var m,y,b,_;if(_=t.distributeSeries&&!t.stackBars?a:t.distributeSeries&&t.stackBars?0:c,m=t.horizontalBars?{x:p.x1+u.projectValue(s&&s.x?s.x:0,c,r.normalized.series[a]),y:p.y1-h.projectValue(s&&s.y?s.y:0,_,r.normalized.series[a])}:{x:p.x1+h.projectValue(s&&s.x?s.x:0,_,r.normalized.series[a]),y:p.y1-u.projectValue(s&&s.y?s.y:0,c,r.normalized.series[a])},h instanceof e.StepAxis&&(h.options.stretch||(m[h.units.pos]+=i*(t.horizontalBars?-1:1)),m[h.units.pos]+=t.stackBars||t.distributeSeries?0:l*t.seriesBarDistance*(t.horizontalBars?-1:1)),b=g[c]||v,g[c]=b-(v-m[h.counterUnits.pos]),void 0!==s){var w={};w[h.units.pos+"1"]=m[h.units.pos],w[h.units.pos+"2"]=m[h.units.pos],!t.stackBars||"accumulate"!==t.stackMode&&t.stackMode?(w[h.counterUnits.pos+"1"]=v,w[h.counterUnits.pos+"2"]=m[h.counterUnits.pos]):(w[h.counterUnits.pos+"1"]=b,w[h.counterUnits.pos+"2"]=g[c]),w.x1=Math.min(Math.max(w.x1,p.x1),p.x2),w.x2=Math.min(Math.max(w.x2,p.x1),p.x2),w.y1=Math.min(Math.max(w.y1,p.y2),p.y1),w.y2=Math.min(Math.max(w.y2,p.y2),p.y1);var k=e.getMetaData(n,c);y=o.elem("line",w,t.classNames.bar).attr({"ct:value":[s.x,s.y].filter(e.isNumeric).join(","),"ct:meta":e.serialize(k)}),this.eventEmitter.emit("draw",e.extend({type:"bar",value:s,index:c,meta:k,series:n,seriesIndex:a,axisX:d,axisY:f,chartRect:p,group:o,element:y},w))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:u.bounds,chartRect:p,axisX:d,axisY:f,svg:this.svg,options:t})}})}(this||n,t),function(t,e){"use strict";t.window,t.document;var n={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:e.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function r(t,e,n){var r=e.x>t.x;return r&&"explode"===n||!r&&"implode"===n?"start":r&&"implode"===n||!r&&"explode"===n?"end":"middle"}e.Pie=e.Base.extend({constructor:function(t,r,a,i){e.Pie.super.constructor.call(this,t,r,n,e.extend({},n,a),i)},createChart:function(t){var a,i,s,o,l,u=e.normalizeData(this.data),c=[],h=t.startAngle;this.svg=e.createSvg(this.container,t.width,t.height,t.donut?t.classNames.chartDonut:t.classNames.chartPie),i=e.createChartRect(this.svg,t,n.padding),s=Math.min(i.width()/2,i.height()/2),l=t.total||u.normalized.series.reduce((function(t,e){return t+e}),0);var d=e.quantity(t.donutWidth);"%"===d.unit&&(d.value*=s/100),s-=t.donut&&!t.donutSolid?d.value/2:0,o="outside"===t.labelPosition||t.donut&&!t.donutSolid?s:"center"===t.labelPosition?0:t.donutSolid?s-d.value/2:s/2,o+=t.labelOffset;var f={x:i.x1+i.width()/2,y:i.y2+i.height()/2},p=1===u.raw.series.filter((function(t){return t.hasOwnProperty("value")?0!==t.value:0!==t})).length;u.raw.series.forEach(function(t,e){c[e]=this.svg.elem("g",null,null)}.bind(this)),t.showLabel&&(a=this.svg.elem("g",null,null)),u.raw.series.forEach(function(n,i){if(0!==u.normalized.series[i]||!t.ignoreEmptyValues){c[i].attr({"ct:series-name":n.name}),c[i].addClass([t.classNames.series,n.className||t.classNames.series+"-"+e.alphaNumerate(i)].join(" "));var v=l>0?h+u.normalized.series[i]/l*360:0,g=Math.max(0,h-(0===i||p?0:.2));v-g>=359.99&&(v=g+359.99);var m,y,b,_=e.polarToCartesian(f.x,f.y,s,g),w=e.polarToCartesian(f.x,f.y,s,v),k=new e.Svg.Path(!t.donut||t.donutSolid).move(w.x,w.y).arc(s,s,0,v-h>180,0,_.x,_.y);t.donut?t.donutSolid&&(b=s-d.value,m=e.polarToCartesian(f.x,f.y,b,h-(0===i||p?0:.2)),y=e.polarToCartesian(f.x,f.y,b,v),k.line(m.x,m.y),k.arc(b,b,0,v-h>180,1,y.x,y.y)):k.line(f.x,f.y);var x=t.classNames.slicePie;t.donut&&(x=t.classNames.sliceDonut,t.donutSolid&&(x=t.classNames.sliceDonutSolid));var E=c[i].elem("path",{d:k.stringify()},x);if(E.attr({"ct:value":u.normalized.series[i],"ct:meta":e.serialize(n.meta)}),t.donut&&!t.donutSolid&&(E._node.style.strokeWidth=d.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:u.normalized.series[i],totalDataSum:l,index:i,meta:n.meta,series:n,group:c[i],element:E,path:k.clone(),center:f,radius:s,startAngle:h,endAngle:v}),t.showLabel){var T,S;T=1===u.raw.series.length?{x:f.x,y:f.y}:e.polarToCartesian(f.x,f.y,o,h+(v-h)/2),S=u.normalized.labels&&!e.isFalseyButZero(u.normalized.labels[i])?u.normalized.labels[i]:u.normalized.series[i];var O=t.labelInterpolationFnc(S,i);if(O||0===O){var M=a.elem("text",{dx:T.x,dy:T.y,"text-anchor":r(f,T,t.labelDirection)},t.classNames.label).text(""+O);this.eventEmitter.emit("draw",{type:"label",index:i,group:a,element:M,text:""+O,x:T.x,y:T.y})}}h=v}}.bind(this)),this.eventEmitter.emit("created",{chartRect:i,svg:this.svg,options:t})},determineAnchorPosition:r})}(this||n,t),t}()}.apply(e,[]))||(t.exports=r)}).call(this,n(14))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));let r=(t=21)=>{let e="",n=t;for(;n--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__11__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__12__},function(t,e,n){var r=n(18);t.exports=function(t,e,n){var a={},i="SAFE_EVAL_"+Math.floor(1e6*Math.random());a[i]={};return t="\n    (function(){\n      Function = undefined;\n      const keys = Object.getOwnPropertyNames(this).concat(['constructor']);\n      keys.forEach((key) => {\n        const item = this[key];\n        if(!item || typeof item.constructor !== 'function') return;\n        this[key].constructor = undefined;\n      });\n    })();\n  "+i+"="+t,e&&Object.keys(e).forEach((function(t){a[t]=e[t]})),r.runInNewContext(t,a,n),a[i]}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__15__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__16__},function(t,e){},function(module,exports){var indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,n){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(t){return function(t,e,n){t[e]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var n=e.contentWindow,r=n.eval,a=n.execScript;!r&&a&&(a.call(n,"null"),r=n.eval),forEach(Object_keys(t),(function(e){n[e]=t[e]})),forEach(globals,(function(e){t[e]&&(n[e]=t[e])}));var i=Object_keys(n),s=r.call(n,this.code);return forEach(Object_keys(n),(function(e){(e in t||-1===indexOf(i,e))&&(t[e]=n[e])})),forEach(globals,(function(e){e in t||defineProp(t,e,n[e])})),document.body.removeChild(e),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),n=this.runInContext(e);return t&&forEach(Object_keys(e),(function(n){t[n]=e[n]})),n},forEach(Object_keys(Script.prototype),(function(t){exports[t]=Script[t]=function(e){var n=Script(e);return n[t].apply(n,[].slice.call(arguments,1))}})),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"==typeof t&&forEach(Object_keys(t),(function(n){e[n]=t[n]})),e}},function(t){t.exports=JSON.parse('{"type":"panel","name":"FlowCharting","id":"agenty-flowcharting-panel","info":{"description":"Flowcharting is a Grafana plugin. Use it to display complexe diagrams using the online graphing library draw.io like a vsio","author":{"name":"Arnaud GENTY","url":"https://github.com/algenty/grafana-flowcharting"},"keywords":["flowchart","panel","diagram","workflow","floorplan","map","organigram","draw.io","visio","mxgraph"],"links":[{"name":"Project site","url":"https://github.com/algenty/grafana-flowcharting"},{"name":"Documentation","url":"https://algenty.github.io/flowcharting-repository/"},{"name":"Demonstration","url":"https://play.grafana.org/d/Unu5JcjWk/flowcharting-index?orgId=1"},{"name":"Apache License","url":"https://github.com/algenty/grafana-flowcharting/blob/master/LICENSE"}],"version":"1.0.0e","updated":"2023-12-14","logos":{"small":"img/agenty-flowcharting.svg","large":"img/agenty-flowcharting.svg"}},"dependencies":{"grafanaVersion":"7.x.x","plugins":[]}}')},function(t,e,n){function r(t,e,n,r,a,i,s){try{var o=t[i](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var s=t.apply(e,n);function o(t){r(s,a,i,o,l,"next",t)}function l(t){r(s,a,i,o,l,"throw",t)}o(void 0)}))}}var i=n(8),s=n(21),o=n(13);t.exports={stringToBytes:function(t){for(var e=new Array(t.length),n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},bytesToString:function(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e},encode:function(t,e,n,r){var a=t;if(e)try{a=encodeURIComponent(a)}catch(t){return}if(n&&a.length>0)try{a=this.bytesToString(i.deflateRaw(a))}catch(t){return}if(r)try{a=btoa(a)}catch(t){return}return a},removeLinebreaks:function(t){return t.replace(/(\r\n|\n|\r)/gm,"")},isencoded:function(t){try{var e=this.parseXml(t).documentElement;if(null==e||"mxfile"!==e.nodeName)return-1===t.indexOf("mxGraphModel");if(e.getElementsByTagName("diagram").length>0)return!0}catch(t){return!0}return!1},decode:function(t,e,n,r){try{var a=this.parseXml(t).documentElement;if(null!=a&&"mxfile"===a.nodeName){var s=a.getElementsByTagName("diagram");s.length>0&&(t=this.getTextContent(s[0]))}}catch(t){}return r&&(t=atob(t)),n&&t.length>0&&(t=this.bytesToString(i.inflateRaw(t))),e&&(t=decodeURIComponent(t)),t},parseXml:function(t){if(window.DOMParser)return(new DOMParser).parseFromString(t,"text/xml");var e=this.createXmlDocument();return e.async="false",e.loadXML(t),e},createXmlDocument:function(){var t=null;return document.implementation&&document.implementation.createDocument?t=document.implementation.createDocument("","",null):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLDOM")),t},decodeFromUri:function(t){try{t=decodeURIComponent(t)}catch(t){return}return t},getTextContent:function(t){return null!=t?t[void 0===t.textContent?"text":"textContent"]:""},normalizeXml:function(t){try{var e=t;return e=(e=e.replace(/>\s*/g,">")).replace(/\s*</g,"<"),t}catch(t){return}},sleep:function(t,e){return a(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(t){return new Promise((function(e){return setTimeout(e,t)}))},e.next=3,n(t);case 3:case 4:case"end":return e.stop()}}),e)})))()},uniqueID:function(){function t(){return Math.random().toString(16).slice(-4)}return"".concat(t()+t(),"-").concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t()).concat(t()).concat(t())},stringToJsRegex:function(t){if("/"!==t[0])return new RegExp("^".concat(t,"$"));var e=t.match(new RegExp("^/(.*?)/(g?i?m?y?)$"));return new RegExp(e[1],e[2])},matchString:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||null==e||0===t.length||0===e.length)return!1;if(t===e)return!0;if(n){var r=this.stringToJsRegex(e);return t.toString().match(r)}return!1},minify:function(t){try{return s.xmlmin(t,!1)}catch(e){return this.log(3,"Error in minify",e),t}},prettify:function(t){try{return s.xml(t)}catch(e){return this.log(3,"Error in prettify",e),t}},prettifyJSON:function(t){try{return s.json(t)}catch(e){return this.log(3,"Error in prettify",e),t}},addScript:function(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t);var n=document.getElementsByTagName("script")[0];null!=n&&n.parentNode.insertBefore(e,n)},loadJS:function(t){try{var e=this.loadFile(t);e&&this.evalRaw(e)}catch(t){window.console}},loadFile:function(t){try{var e=mxUtils.load(t);if(null!=e&&e.getStatus()>=200&&e.getStatus()<=299)return e.getText()}catch(t){window.console}},$loadFile:function(t){var e;return $.ajax({type:"GET",url:t,async:!1,success:function(t){e=t},error:function(t){}}),e},$evalFile:function(t){$.ajax({type:"GET",url:t,async:!1,success:function(t){eval.call(window,t)},error:function(t){}})},evalRaw:function(t){try{eval.call(window,t)}catch(t){window.console}},evalIt:function(t){var e=t;try{e=o(t)}catch(n){e=t}return e},getfileContent:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){(function(){var e=a(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:e.sent;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}))}},function(t,e){function n(t){var e="    ";if(isNaN(parseInt(t)))e=t;else switch(t){case 1:e=" ";break;case 2:e="  ";break;case 3:e="   ";break;case 4:e="    ";break;case 5:e="     ";break;case 6:e="      ";break;case 7:e="       ";break;case 8:e="        ";break;case 9:e="         ";break;case 10:e="          ";break;case 11:e="           ";break;case 12:e="            "}for(var n=["\n"],r=0;r<100;r++)n.push(n[r]+e);return n}function r(){this.step="    ",this.shift=n(this.step)}function a(t,e){return e-(t.replace(/\(/g,"").length-t.replace(/\)/g,"").length)}function i(t,e){return t.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+e+e+"AND ").replace(/ BETWEEN /gi,"~::~"+e+"BETWEEN ").replace(/ CASE /gi,"~::~"+e+"CASE ").replace(/ ELSE /gi,"~::~"+e+"ELSE ").replace(/ END /gi,"~::~"+e+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+e+"ON ").replace(/ OR /gi,"~::~"+e+e+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+e+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+e).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+e+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}r.prototype.xml=function(t,e){var r=t.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),a=r.length,i=!1,s=0,o="",l=0,u=e?n(e):this.shift;for(l=0;l<a;l++)r[l].search(/<!/)>-1?(o+=u[s]+r[l],i=!0,(r[l].search(/-->/)>-1||r[l].search(/\]>/)>-1||r[l].search(/!DOCTYPE/)>-1)&&(i=!1)):r[l].search(/-->/)>-1||r[l].search(/\]>/)>-1?(o+=r[l],i=!1):/^<\w/.exec(r[l-1])&&/^<\/\w/.exec(r[l])&&/^<[\w:\-\.\,]+/.exec(r[l-1])==/^<\/[\w:\-\.\,]+/.exec(r[l])[0].replace("/","")?(o+=r[l],i||s--):r[l].search(/<\w/)>-1&&-1==r[l].search(/<\//)&&-1==r[l].search(/\/>/)?o=o+=i?r[l]:u[s++]+r[l]:r[l].search(/<\w/)>-1&&r[l].search(/<\//)>-1?o=o+=i?r[l]:u[s]+r[l]:r[l].search(/<\//)>-1?o=o+=i?r[l]:u[--s]+r[l]:r[l].search(/\/>/)>-1?o=o+=i?r[l]:u[s]+r[l]:r[l].search(/<\?/)>-1||r[l].search(/xmlns\:/)>-1||r[l].search(/xmlns\=/)>-1?o+=u[s]+r[l]:o+=r[l];return"\n"==o[0]?o.slice(1):o},r.prototype.json=function(t,e){e=e||this.step;return"undefined"==typeof JSON?t:"string"==typeof t?JSON.stringify(JSON.parse(t),null,e):"object"==typeof t?JSON.stringify(t,null,e):t},r.prototype.css=function(t,e){var r=t.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),a=r.length,i=0,s="",o=0,l=e?n(e):this.shift;for(o=0;o<a;o++)/\{/.exec(r[o])?s+=l[i++]+r[o]:/\}/.exec(r[o])?s+=l[--i]+r[o]:(/\*\\/.exec(r[o]),s+=l[i]+r[o]);return s.replace(/^\n{1,}/,"")},r.prototype.sql=function(t,e){var r=t.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),s=r.length,o=[],l=0,u=this.step,c=0,h="",d=0,f=e?n(e):this.shift;for(d=0;d<s;d++)o=d%2?o.concat(r[d]):o.concat(i(r[d],u));for(s=o.length,d=0;d<s;d++){c=a(o[d],c),/\s{0,}\s{0,}SELECT\s{0,}/.exec(o[d])&&(o[d]=o[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\s{0,}SET\s{0,}/.exec(o[d])&&(o[d]=o[d].replace(/\,/g,",\n"+u+u)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(o[d])?h+=f[++l]+o[d]:/\'/.exec(o[d])?(c<1&&l&&l--,h+=o[d]):(h+=f[l]+o[d],c<1&&l&&l--)}return h=h.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},r.prototype.xmlmin=function(t,e){return(e?t:t.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},r.prototype.jsonmin=function(t){return"undefined"==typeof JSON?t:JSON.stringify(JSON.parse(t),null,0)},r.prototype.cssmin=function(t,e){return(e?t:t.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},r.prototype.sqlmin=function(t){return t.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},t.exports=new r},function(t,e){t.exports={executeLayout:function(t,e,n,r){if(t.isEnabled()){t.getModel().beginUpdate();try{e()}catch(t){throw t}finally{t.getModel().endUpdate(),null!=r&&r()}}},executeLayoutList:function(t,e,n){for(var r=t.getSelectionCells(),a=0;a<e.length;a++){var i=new window[e[a].layout](t);if(null!=e[a].config)for(var s in e[a].config)i[s]=e[a].config[s];this.executeLayout(t,(function(){i.execute(t.getDefaultParent(),0===r.length?null:r)}),a===e.length-1,n)}},csvToArray:function(t){if(!/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/.test(t))return null;var e=[];return t.replace(/(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g,(function(t,n,r,a){return void 0!==n?e.push(n.replace(/\\'/g,"'")):void 0!==r?e.push(r.replace(/\\"/g,'"')):void 0!==a&&e.push(a),""})),/,\s*$/.test(t)&&e.push(""),e},importCsv:function(t,e){try{var n=e.split("\n"),r=[],a=[],i={};if(n.length>0){var s={},o=null,l=null,u=null,c=null,h=null,d=null,f=null,p=null,v="",g="auto",m="auto",y=null,b=null,_=40,w=40,k=100,x=0,E=(t.view,t.getGraphBounds(),function(){}),T=t.getFreeInsertPoint(),S=T.x,O=T.y,M=O,C=null,R="auto";p=null;for(var D=[],A=null,L=null,P=0;P<n.length&&"#"===n[P].charAt(0);){for(e=n[P],P++;P<n.length&&"\\"===e.charAt(e.length-1)&&"#"===n[P].charAt(0);)e=e.substring(0,e.length-1)+mxUtils.trim(n[P].substring(1)),P++;if("#"!==e.charAt(1)){var N=e.indexOf(":");if(N>0){var I=mxUtils.trim(e.substring(1,N)),H=mxUtils.trim(e.substring(N+1));"label"===I?C=t.sanitizeHtml(H):"labelname"===I&&H.length>0&&"-"!==H?c=H:"labels"===I&&H.length>0&&"-"!==H?h=JSON.parse(H):"style"===I?o=H:"parentstyle"===I?d=H:"stylename"===I&&H.length>0&&"-"!==H?u=H:"styles"===I&&H.length>0&&"-"!==H?l=JSON.parse(H):"identity"===I&&H.length>0&&"-"!==H?f=H:"parent"===I&&H.length>0&&"-"!==H?p=H:"namespace"===I&&H.length>0&&"-"!==H?v=H:"width"===I?g=H:"height"===I?m=H:"left"===I&&H.length>0?y=H:"top"===I&&H.length>0?b=H:"ignore"===I?L=H.split(","):"connect"===I?D.push(JSON.parse(H)):"link"===I?A=H:"padding"===I?x=parseFloat(H):"edgespacing"===I?_=parseFloat(H):"nodespacing"===I?w=parseFloat(H):"levelspacing"===I?k=parseFloat(H):"layout"===I&&(R=H)}}}if(null==n[P])throw new Error(mxResources.get("invalidOrMissingFile"));for(var F=this.csvToArray(n[P]),z=null,V=null,U=[],j=0;j<F.length;j++)f===F[j]&&(z=j),p===F[j]&&(V=j),U.push(mxUtils.trim(F[j]).replace(/[^a-z0-9]+/gi,"_").replace(/^\d+/,"").replace(/_+$/,""));if(null==C&&(C="%"+U[0]+"%"),null!=D)for(var B=0;B<D.length;B++)null==s[D[B].to]&&(s[D[B].to]={});for(var G=[],$=P+1;$<n.length;$++){var Y=this.csvToArray(n[$]);if(null==Y){var X=n[$].length>40?n[$].substring(0,40)+"...":n[$];throw new Error(X+" ("+$+"):\n"+mxResources.get("containsValidationErrors"))}Y.length>0&&G.push(Y)}t.model.beginUpdate();try{for(var W=0;W<G.length;W++){var Z=G[W],q=null,K=null!=z?v+Z[z]:null;null!=K&&(q=t.model.getCell(K));var J=null!=q,Q=new mxCell(C,new mxGeometry(S,M,0,0),o||"whiteSpace=wrap;html=1;");Q.vertex=!0,Q.id=K;for(var tt=0;tt<Z.length;tt++)t.setAttributeForCell(Q,U[tt],Z[tt]);if(null!=c&&null!=h){var et=h[Q.getAttribute(c)];null!=et&&t.labelChanged(Q,et)}if(null!=u&&null!=l){var nt=l[Q.getAttribute(u)];null!=nt&&(Q.style=nt)}if(t.setAttributeForCell(Q,"placeholders","1"),Q.style=t.replacePlaceholders(Q,Q.style),J&&(t.model.setGeometry(q,Q.geometry),t.model.setStyle(q,Q.style),mxUtils.indexOf(a,q)<0&&a.push(q)),q=Q,!J)for(var rt=0;rt<D.length;rt++)s[D[rt].to][q.getAttribute(D[rt].to)]=q;null!=A&&"link"!==A&&(t.setLinkForCell(q,q.getAttribute(A)),t.setAttributeForCell(q,A,null)),t.fireEvent(new mxEventObject("cellsInserted","cells",[q]));var at=t.getPreferredSizeForCell(q);q.vertex&&(null!=y&&null!=q.getAttribute(y)&&(q.geometry.x=S+parseFloat(q.getAttribute(y))),null!=b&&null!=q.getAttribute(b)&&(q.geometry.y=O+parseFloat(q.getAttribute(b))),"@"===g.charAt(0)&&null!=q.getAttribute(g.substring(1))?q.geometry.width=parseFloat(q.getAttribute(g.substring(1))):q.geometry.width="auto"===g?at.width+x:parseFloat(g),"@"===m.charAt(0)&&null!=q.getAttribute(m.substring(1))?q.geometry.height=parseFloat(q.getAttribute(m.substring(1))):q.geometry.height="auto"===m?at.height+x:parseFloat(m),M+=q.geometry.height+w),J?(null==i[K]&&(i[K]=[]),i[K].push(q)):(p=null!=V?t.model.getCell(v+Z[V]):null,r.push(q),null!=p?(p.style=t.replacePlaceholders(p,d),t.addCell(q,p)):a.push(t.addCell(q)))}for(var it=a.slice(),st=a.slice(),ot=0;ot<D.length;ot++)for(var lt=D[ot],ut=0;ut<r.length;ut++){q=r[ut];var ct=mxUtils.bind(this,(function(e,n,r){var a=n.getAttribute(r.from);if(null!=a&&(t.setAttributeForCell(n,r.from,null),""!==a))for(var i=a.split(","),o=0;o<i.length;o++){var l=s[r.to][i[o]];if(null!=l){var u=r.label;null!=r.fromlabel&&(u=(n.getAttribute(r.fromlabel)||"")+(u||"")),null!=r.tolabel&&(u=(u||"")+(l.getAttribute(r.tolabel)||""));var c="target"===r.placeholders==!r.invert?l:e,h=null!=r.style?t.replacePlaceholders(c,r.style):t.createCurrentEdgeStyle();st.push(t.insertEdge(null,null,u||"",r.invert?l:e,r.invert?e:l,h)),mxUtils.remove(r.invert?e:l,it)}}}));if(ct(q,q,lt),null!=i[q.id])for(var ht=0;ht<i[q.id].length;ht++)ct(q,i[q.id][ht],lt)}if(null!=L)for(var dt=0;dt<r.length;dt++){q=r[dt];for(var ft=0;ft<L.length;ft++)t.setAttributeForCell(q,mxUtils.trim(L[ft]),null)}if(a.length>0){var pt=new mxParallelEdgeLayout(t);pt.spacing=_;var vt=function(){pt.spacing>0&&pt.execute(t.getDefaultParent());for(var e=0;e<a.length;e++){var n=t.getCellGeometry(a[e]);n.x=Math.round(t.snap(n.x)),n.y=Math.round(t.snap(n.y)),"auto"===g&&(n.width=Math.round(t.snap(n.width))),"auto"===m&&(n.height=Math.round(t.snap(n.height)))}};if("["===R.charAt(0)){var gt=E;t.view.validate(),this.executeLayoutList(t,JSON.parse(R),(function(){vt(),gt()})),E=null}else if("circle"===R){var mt=new mxCircleLayout(t);mt.resetEdges=!1;var yt=mt.isVertexIgnored;mt.isVertexIgnored=function(t){return yt.apply(this,arguments)||mxUtils.indexOf(a,t)<0},this.executeLayout(t,(function(){mt.execute(t.getDefaultParent()),vt()}),!0,E),E=null}else if("horizontaltree"===R||"verticaltree"===R||"auto"===R&&st.length===2*a.length-1&&1===it.length){t.view.validate();var bt=new mxCompactTreeLayout(t,"horizontaltree"===R);bt.levelDistance=w,bt.edgeRouting=!1,bt.resetEdges=!1,this.executeLayout(t,(function(){bt.execute(t.getDefaultParent(),it.length>0?it[0]:null)}),!0,E),E=null}else if("horizontalflow"===R||"verticalflow"===R||"auto"===R&&1===it.length){t.view.validate();var _t=new mxHierarchicalLayout(t,"horizontalflow"===R?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH);_t.intraCellSpacing=w,_t.parallelEdgeSpacing=_,_t.interRankCellSpacing=k,_t.disableEdgeStyle=!1,this.executeLayout(t,(function(){_t.execute(t.getDefaultParent(),st),t.moveCells(st,S,O)}),!0,E),E=null}else if("organic"===R||"auto"===R&&st.length>a.length){t.view.validate();var wt=new mxFastOrganicLayout(t);wt.forceConstant=3*w,wt.resetEdges=!1;var kt=wt.isVertexIgnored;wt.isVertexIgnored=function(t){return kt.apply(this,arguments)||mxUtils.indexOf(a,t)<0},(pt=new mxParallelEdgeLayout(t)).spacing=_,this.executeLayout(t,(function(){wt.execute(t.getDefaultParent()),vt()}),!0,E),E=null}}}finally{t.model.endUpdate()}null!=E&&E()}}catch(B){}},anonymize:function(t){var e=document.createElement("div"),n=t.model,r=function(t,e){for(var n=[],r=0;r<t.length;r++){var a=t.charAt(r);"\n\t`~!@#$%^&*()_+{}|:\"<>?-=[];'./,\n\t".indexOf(a)>=0?n.push(a):isNaN(parseInt(a))?a.toLowerCase()!==a?n.push(String.fromCharCode(65+Math.round(25*Math.random()))):a.toUpperCase()!==a?n.push(String.fromCharCode(97+Math.round(25*Math.random()))):/\s/.test(a)?n.push(" "):n.push("?"):n.push(e?"0":Math.round(9*Math.random()))}return n.join("")},a=function(t){return e.innerHTML=t,function t(e){if(null!=e.nodeValue&&(e.nodeValue=r(e.nodeValue)),e.nodeType===mxConstants.NODETYPE_ELEMENT)for(var n=e.firstChild;null!=n;)t(n),n=n.nextSibling}(e),e.innerHTML};n.beginUpdate();try{var i=[];for(var s in n.cells){var o=n.cells[s],l=t.getLabel(o);l=t.isHtmlLabel(o)?a(l):r(l),i.push({cell:o,label:l})}for(var u=0;u<i.length;u++)n.setValue(i[u].cell,i[u].label)}finally{n.endUpdate()}},addExtFont:function(t,e,n){if(t&&e){var r="extFont_"+t;if(null===document.getElementById(r))if(0===e.indexOf(Editor.GOOGLE_FONTS))mxClient.link("stylesheet",e,null,r);else{document.getElementsByTagName("head")[0];var a=document.createElement("style");a.appendChild(document.createTextNode('@font-face {\n\tfont-family: "'+t+'";\n\tsrc: url("'+e+'");\n}')),a.setAttribute("id",r),document.getElementsByTagName("head")[0].appendChild(a)}if(!n){null==this.extFonts&&(this.extFonts=[]);for(var i=this.extFonts,s=!0,o=0;o<i.length;o++)if(i[o].name===t){s=!1;break}s&&this.extFonts.push({name:t,url:e})}}}}},function(t,e,n){"use strict";(function(t){var r=n(24),a=n(25),i=n(26);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),a=(t=o(t,r)).write(e,n);a!==r&&(t=t.slice(0,a));return t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|f(e.length);return 0===(t=o(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?o(t,0):d(t,e);if("Buffer"===e.type&&i(e.data))return d(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=o(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(r)return V(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,a){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(a)return-1;n=t.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,a);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,a);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,a){var i,s=1,o=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,o/=2,l/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(a){var c=-1;for(i=n;i<o;i++)if(u(t,i)===u(e,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===l)return c*s}else-1!==c&&(i-=i-c),c=-1}else for(n+l>o&&(n=o-l),i=n;i>=0;i--){for(var h=!0,d=0;d<l;d++)if(u(t,i+d)!==u(e,d)){h=!1;break}if(h)return i}return-1}function b(t,e,n,r){n=Number(n)||0;var a=t.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var o=parseInt(e.substr(2*s,2),16);if(isNaN(o))return s;t[n+s]=o}return s}function _(t,e,n,r){return j(V(e,t.length-n),t,n,r)}function w(t,e,n,r){return j(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function k(t,e,n,r){return w(t,e,n,r)}function x(t,e,n,r){return j(U(e),t,n,r)}function E(t,e,n,r){return j(function(t,e){for(var n,r,a,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,a=n%256,i.push(a),i.push(r);return i}(e,t.length-n),t,n,r)}function T(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],a=e;a<n;){var i,s,o,l,u=t[a],c=null,h=u>239?4:u>223?3:u>191?2:1;if(a+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(i=t[a+1]))&&(l=(31&u)<<6|63&i)>127&&(c=l);break;case 3:i=t[a+1],s=t[a+2],128==(192&i)&&128==(192&s)&&(l=(15&u)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:i=t[a+1],s=t[a+2],o=t[a+3],128==(192&i)&&128==(192&s)&&128==(192&o)&&(l=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),a+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,a=0,i=Math.min(n,r);a<i;++a)if(t[a]!==e[a]){n=t[a],r=e[a];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){var s=t[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,a),a+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):v.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,a){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),e<0||n>t.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&e>=n)return 0;if(r>=a)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(a>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),o=Math.min(i,s),u=this.slice(r,a),c=t.slice(e,n),h=0;h<o;++h)if(u[h]!==c[h]){i=u[h],s=c[h];break}return i<s?-1:s<i?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-e;if((void 0===n||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return x(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(127&t[a]);return r}function M(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(t[a]);return r}function C(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=e;i<n;++i)a+=z(t[i]);return a}function R(t,e,n){for(var r=t.slice(e,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function A(t,e,n,r,a,i){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r){e<0&&(e=65535+e+1);for(var a=0,i=Math.min(t.length-n,2);a<i;++a)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function P(t,e,n,r){e<0&&(e=4294967295+e+1);for(var a=0,i=Math.min(t.length-n,4);a<i;++a)t[n+a]=e>>>8*(r?a:3-a)&255}function N(t,e,n,r,a,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function I(t,e,n,r,i){return i||N(t,0,n,4),a.write(t,e,n,r,23,4),n+4}function H(t,e,n,r,i){return i||N(t,0,n,8),a.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var a=e-t;n=new l(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],a=1;e>0&&(a*=256);)r+=this[t+--e]*a;return r},l.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,a=1,i=this[t+--r];r>0&&(a*=256);)i+=this[t+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),a.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),a.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),a.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),a.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||A(this,t,e,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[e]=255&t;++i<n&&(a*=256);)this[e+i]=t/a&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||A(this,t,e,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[e+a]=255&t;--a>=0&&(i*=256);)this[e+a]=t/i&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):P(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);A(this,t,e,n,a-1,-a)}var i=0,s=1,o=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===o&&0!==this[e+i-1]&&(o=1),this[e+i]=(t/s>>0)-o&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);A(this,t,e,n,a-1,-a)}var i=n-1,s=1,o=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===o&&0!==this[e+i+1]&&(o=1),this[e+i]=(t/s>>0)-o&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):P(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return I(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return I(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return H(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return H(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var a,i=r-n;if(this===t&&n<e&&e<r)for(a=i-1;a>=0;--a)t[a+e]=this[a+n];else if(i<1e3||!l.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=l.isBuffer(t)?t:V(new l(t,r).toString()),o=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%o]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var n;e=e||1/0;for(var r=t.length,a=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(e-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function j(t,e,n,r){for(var a=0;a<r&&!(a+n>=e.length||a>=t.length);++a)e[a+n]=t[a];return a}}).call(this,n(14))},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),s=r[0],o=r[1],l=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,o)),c=0,h=o>0?s-4:s;for(n=0;n<h;n+=4)e=a[t.charCodeAt(n)]<<18|a[t.charCodeAt(n+1)]<<12|a[t.charCodeAt(n+2)]<<6|a[t.charCodeAt(n+3)],l[c++]=e>>16&255,l[c++]=e>>8&255,l[c++]=255&e;2===o&&(e=a[t.charCodeAt(n)]<<2|a[t.charCodeAt(n+1)]>>4,l[c++]=255&e);1===o&&(e=a[t.charCodeAt(n)]<<10|a[t.charCodeAt(n+1)]<<4|a[t.charCodeAt(n+2)]>>2,l[c++]=e>>8&255,l[c++]=255&e);return l},e.fromByteArray=function(t){for(var e,n=t.length,a=n%3,i=[],s=0,o=n-a;s<o;s+=16383)i.push(c(t,s,s+16383>o?o:s+16383));1===a?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===a&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],a=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],a[s.charCodeAt(o)]=o;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var a,i,s=[],o=e;o<n;o+=3)a=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),s.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,a){var i,s,o=8*a-r-1,l=(1<<o)-1,u=l>>1,c=-7,h=n?a-1:0,d=n?-1:1,f=t[e+h];for(h+=d,i=f&(1<<-c)-1,f>>=-c,c+=o;c>0;i=256*i+t[e+h],h+=d,c-=8);for(s=i&(1<<-c)-1,i>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=d,c-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),i-=u}return(f?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,a,i){var s,o,l,u=8*i-a-1,c=(1<<u)-1,h=c>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(o=0,s=c):s+h>=1?(o=(e*l-1)*Math.pow(2,a),s+=h):(o=e*Math.pow(2,h-1)*Math.pow(2,a),s=0));a>=8;t[n+f]=255&o,f+=p,o/=256,a-=8);for(s=s<<a|o,u+=a;u>0;t[n+f]=255&s,f+=p,s/=256,u-=8);t[n+f-p]|=128*v}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports={customize:function(){mxTooltipHandler.prototype.show=function(t,e,n){this.destroyed||null!=t&&0!==t.length&&(null==this.div&&this.init(),mxUtils.isNode(t)?(this.div.innerHTML="",this.div.appendChild(t)):this.div.innerHTML=t.replace(/\n/g,"<br>"),this.$div.place_tt(e+20,n),this.div.style.visibility="",mxUtils.fit(this.div))},mxTooltipHandler.prototype.init=function(){null!==this.div&&void 0!==this.div||(this.$div=$('<div class="graph-tooltip">'),this.div=this.$div[0],mxEvent.addGestureListeners(this.div,mxUtils.bind(this,(function(t){this.hideTooltip()}))))},mxTooltipHandler.prototype.hideTooltip=function(){null!=this.div&&(this.div.style.visibility="hidden",this.div.innerHTML="")},mxTooltipHandler.prototype.delay=200,Graph.prototype.getTooltipForCell=function(t){var e=!1,n=document.createElement("div");if(mxUtils.isNode(t.value)){var r=t.value.getAttribute("tooltip");if(null!=r){e=!0,null!=r&&this.isReplacePlaceholders(t)&&(r=this.replacePlaceholders(t,r));var a=document.createElement("div");a.className="tooltip-text",a.innerHTML=this.sanitizeHtml(r),n.appendChild(a)}}if(void 0!==t.gf){var i=t.gf.tooltip.tooltipHandler;if(t.gf.tooltip.enableTooltip)null!==i.getDiv(n)&&(e=!0)}return e?n:""},mxEvent.addMouseWheelListener=function(t,e){if(null!=t){var n=function(e){var n;null==e&&(e=window.event),n=mxClient.IS_FF?-e.detail/2:e.wheelDelta/120,0!==n&&t(e,0<n)};mxClient.IS_NS&&null==document.documentMode?mxEvent.addListener(mxClient.IS_GC&&null!=e?e:window,mxClient.IS_SF||mxClient.IS_GC?"mousewheel":"DOMMouseScroll",n):mxEvent.addListener(document,"mousewheel",n)}}}}},,,function(t,e,n){"use strict";n.r(e);var r=n(1),a=n(7),i=n(2),s=n(0),o=n(4),l=n(11),u=n.n(l),c=n(15),h=n.n(c),d=n(12),f=n(16),p={formatValue:function(t,e,n){return u.a.valueFormats[e](t,n,null).toString()},getUnitFormats:function(){return u.a.getUnitFormats()},loadCss:function(){Object(a.loadPluginCss)({dark:"plugins/agenty-flowcharting-panel/styles/dark.css",light:"plugins/agenty-flowcharting-panel/styles/light.css"})},getTimeSeries:function(t){return new h.a({datapoints:t.datapoints||[],alias:t.target,unit:t.unit})},getFormatedDate:function(t,e){return Object(d.dateTime)(t).format(e)},appEvents:n.n(f).a,MetricsPanelCtrl:a.MetricsPanelCtrl,PanelEvents:d.PanelEvents},v=n(5),g=n.n(v);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(){y=function(t,e){return new n(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function n(t,r,a){var i=new RegExp(t,r);return e.set(i,a||e.get(t)),_(i,n.prototype)}function r(t,n){var r=e.get(n);return Object.keys(r).reduce((function(e,n){return e[n]=t[r[n]],e}),Object.create(null))}return b(n,RegExp),n.prototype.exec=function(e){var n=t.exec.call(this,e);return n&&(n.groups=r(n,this)),n},n.prototype[Symbol.replace]=function(n,a){if("string"==typeof a){var i=e.get(this);return t[Symbol.replace].call(this,n,a.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+i[e]})))}if("function"==typeof a){var s=this;return t[Symbol.replace].call(this,n,(function(){var t=arguments;return"object"!=m(t[t.length-1])&&(t=[].slice.call(t)).push(r(t,s)),a.apply(this,t)}))}return t[Symbol.replace].call(this,n,a)},y.apply(this,arguments)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return k(this,n)}}function k(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e,n){return e&&T(t.prototype,e),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var O=["threshold_initalized","threshold_changed","threshold_freed"],M=function(){function t(e,n,r,a,o){E(this,t),this._hidden=!1,this.validComp=[],this.type="unknown",this.reduce=!0,this.events=i.a.create(O),this.uid=s.a.genUid(this.constructor.name),this.data=a,this.data.value=r,this.data.color=e,this.data.comparator=n,o&&this.import(o),this._setType(),this.init()}return S(t,[{key:"init",value:function(){this._eventsConnect(),this.events.emit("threshold_initalized",this)}},{key:"change",value:function(){this.events.emit("threshold_changed",this)}},{key:"clear",value:function(){this.validComp=[]}},{key:"free",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clear(),this._eventsDisconnect(),t.next=4,this.events.emit("threshold_freed",this);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"value",get:function(){return this.data.value},set:function(t){("string"!=typeof t||t&&0!==t.length)&&this.data.value!==t&&(this.data.value=t,this.change())}},{key:"color",get:function(){return this.data.color},set:function(t){t&&0!==t.length&&this.data.color!==t&&(this.data.color=t,this.change())}},{key:"comparator",get:function(){return this.data.comparator},set:function(t){t&&0!==t.length&&this.data.comparator!==t&&(this.data.comparator=t,this.change())}},{key:"hidden",get:function(){return this._hidden},set:function(t){t!==this._hidden&&(this._hidden=t,this.change())}},{key:"_eventsConnect",value:function(){}},{key:"_eventsDisconnect",value:function(){}},{key:"import",value:function(t,e,n){return e&&n?this.data.color=n:(t.color?this.data.color=t.color:this.data.color="",t.comparator&&(this.data.comparator=t.comparator),t.value?this.data.value=t.value:this.data.value=void 0,t.level&&(this.data.comparator=t.level)),this}},{key:"isValidComp",value:function(t){return-1!==this.validComp.indexOf(t)}},{key:"isValidValue",value:function(){return!0}},{key:"getData",value:function(){return this.data}}]),t}(),C=function(t){b(n,t);var e=w(n);function n(){var t;return E(this,n),(t=e.apply(this,arguments)).validComp=["ge","gt"],t}return S(n,[{key:"_setType",value:function(){this.type="number"}},{key:"isValidValue",value:function(){return"number"==typeof this.data.value}},{key:"match",value:function(t){if(void 0===this.value)return!0;if(void 0===t)return!1;switch(this.comparator){case"ge":return t>=this.data.value;case"gt":return t>this.value;default:throw new Error("Unknown comparator: "+this.comparator)}}}],[{key:"getDefaultData",value:function(){return{color:"rgba(245, 54, 54, 0.9)",comparator:"ge",value:50,level:0}}}]),n}(M),R=function(t){b(n,t);var e=w(n);function n(){var t;return E(this,n),(t=e.apply(this,arguments)).type="string",t.validComp=["eq","ne"],t}return S(n,[{key:"_setType",value:function(){this.type="string"}},{key:"isValidValue",value:function(){try{new RegExp(this.value)}catch(t){return!1}return!0}},{key:"match",value:function(t){if(void 0===this.value)return!0;if(void 0===t)return!1;var e=s.a.matchString(t,this.value);switch(this.comparator){case"eq":return e;case"ne":return!e;default:throw new Error("Unknown comparator: "+this.comparator)}}}],[{key:"getDefaultData",value:function(){return{color:"rgba(245, 54, 54, 0.9)",comparator:"eq",value:"/.*/",level:0}}}]),n}(M),D=function(t){b(n,t);var e=w(n);function n(){var t;return E(this,n),(t=e.apply(this,arguments)).pattern=y(/^(\+|\x2D)?(\d+\.?\d*)(d|w|M|Q|y|h|m|s|ms)$/,{signe:1,number:2,precision:3}),t.matchs=[],t.isValidated=!1,t.isDate=!1,t.isPattern=!1,t.type="date",t.validComp=["eq","ne","ge","gt"],t}return S(n,[{key:"_setType",value:function(){this.type="date"}},{key:"isValidValue",value:function(){return this.testedValue===this.value&&this.isValidated?this.isValidated:(this.testedValue=this.value,this.isValidated=!1,this.isPattern=!1,this.isDate=!1,void 0===this.testedValue||null===this.testedValue||0===this.testedValue.toString().length?this.isValidated:g()(this.testedValue).isValid()?(this.date=g()(this.testedValue),this.isDate=!0,this.isValidated=!0,this.isValidated):!0===this.pattern.test(this.testedValue.toString())?(this.matchs=this.pattern.exec(this.testedValue.toString()),this.isValidated=!0,this.isPattern=!0,null!==this.matchs&&void 0!==this.matchs.groups&&void 0===this.matchs.groups.signe&&(this.matchs.groups.signe="+"),this.isValidated):this.isValidated)}},{key:"match",value:function(t){if(void 0===this.value)return!0;if(void 0===t)return!1;if(!this.isValidated&&!this.isValidValue())return!1;return this.isDate?this._matchDate(t):!!this.isPattern&&this._matchPattern(t)}},{key:"_matchDate",value:function(t){return n.compareDates(this.date,t,this.data.comparator,"d")}},{key:"_matchPattern",value:function(t){if(this.isValidated&&null!==this.matchs&&void 0!==this.matchs.groups){var e=g()(),r=this.matchs.groups.signe,a=parseFloat("".concat(this.matchs.groups.number)),i=void 0!==this.matchs.groups.precision?this.matchs.groups.precision:"d";return e="-"===r?g()(e).subtract(a,i):g()(e).add(a,i),n.compareDates(e,t,this.data.comparator,i)}return!1}}],[{key:"getDefaultData",value:function(){return{color:"rgba(245, 54, 54, 0.9)",comparator:"ge",value:"-1d",level:0}}},{key:"isValidDate",value:function(t){try{var e=g()(t),n=g()(t).isValid();return!(n&&e.year()<=1980)&&n}catch(t){return!1}}},{key:"compareDates",value:function(t,e,n,r){switch(n){case"eq":return g()(e).isSame(t,r);case"ne":return!g()(e).isSame(t,r);case"ge":return g()(e).isSame(t,r)||g()(e).isAfter(t,r);case"gt":return g()(e).isAfter(t,r);default:return!1}}}]),n}(M);function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=["rule_initalized","rule_updated","rule_changed","rule_freed"],P=function(){function t(e,n,r,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.metrics=new Map,this.mapsObj={shapes:[],texts:[],links:[],events:[]},this.valueMaps=[],this.rangeMaps=[],this.numberTH=[],this.stringTH=[],this.dateTH=[],this.removeClick=2,this.states=new Map,this.shapeStates=new Map,this.textStates=new Map,this.linkStates=new Map,this.eventStates=new Map,this.highestLevel=-1,this.highestColor="",this.highestFormattedValue="",this.highestValue=void 0,this.execTimes=0,this.events=i.a.create(L),this.$gf=e,this.uid=s.a.genUid(this.constructor.name),this.data=r,this.data.pattern=n,a&&this._convert(a),this.init(),this.change()}var e,n,a;return e=t,a=[{key:"getDefaultData",value:function(){return{order:1,pattern:".*",unit:"short",type:"number",metricType:"serie",alias:"myRule",refId:"A",column:"Time",hidden:!1,aggregation:"current",decimals:2,reduce:!0,dateColumn:"Time",dateFormat:"YYYY-MM-DD HH:mm:ss",numberTHData:[],stringTHData:[],dateTHData:[],invert:!1,gradient:!1,overlayIcon:!1,tooltip:!1,tooltipLabel:"",tooltipColors:!1,tooltipOn:"a",tpDirection:"v",tpMetadata:!1,tpGraph:!1,tpGraphSize:"100%",tpGraphType:"line",tpGraphLow:null,tpGraphHigh:null,tpGraphScale:"linear",mapsDat:{shapes:{options:t.getDefaultMapOptions(),dataList:[]},texts:{options:t.getDefaultMapOptions(),dataList:[]},links:{options:t.getDefaultMapOptions(),dataList:[]},events:{options:t.getDefaultMapOptions(),dataList:[]}},mappingType:1,valueData:[],rangeData:[],sanitize:!1,newRule:!0}}},{key:"getDefaultMapOptions",value:function(){return{identByProp:"id",metadata:"",enableRegEx:!0}}}],(n=[{key:"update",value:function(){return this.initCycle(),this.events.emit("rule_updated",this),this}},{key:"init",value:function(){return this._eventsConnect(),this.events.emit("rule_initalized",this),this}},{key:"_eventsConnect",value:function(){var t,e,n,r;return null===(e=null===(t=this.$gf)||void 0===t?void 0:t.metricHandler)||void 0===e||e.events.connect("metric_created",this,this._on_metricHandler_metric_created.bind(this)),null===(r=null===(n=this.$gf)||void 0===n?void 0:n.metricHandler)||void 0===r||r.events.connect("metric_deleted",this,this._on_metricHandler_metric_deleted.bind(this)),this}},{key:"_eventsDisconnect",value:function(){var t,e,n,a,i=this;return null===(e=null===(t=this.$gf)||void 0===t?void 0:t.metricHandler)||void 0===e||e.events.connect("metric_created",this,this._on_metricHandler_metric_created.bind(this)),null===(a=null===(n=this.$gf)||void 0===n?void 0:n.metricHandler)||void 0===a||a.events.connect("metric_deleted",this,this._on_metricHandler_metric_deleted.bind(this)),this.getThresholds().map((function(t){return Object(r.a)(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.events.disconnect("threshold_changed",this);case 1:case"end":return e.stop()}}),e,this)})))})),this}},{key:"change",value:function(){return this.events.emit("rule_changed",this),this}},{key:"free",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.events.emit("rule_freed",this);case 2:return this._eventsDisconnect(),this.events.clear(),t.abrupt("return",this);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){return this.shapeStates.clear(),this.textStates.clear(),this.linkStates.clear(),this}},{key:"reduce",get:function(){return this.data.reduce},set:function(t){this.data.reduce!==t&&(this.data.reduce=t)}},{key:"name",get:function(){return this.data.alias},set:function(t){var e;t&&0!==t.length&&t!==this.data.alias&&((null===(e=this.$gf.rulesHandler)||void 0===e?void 0:e.getRule(t))?this.$gf.notify("Rule with name ".concat(t," already exit"),"error"):this.data.alias=t)}},{key:"metric",get:function(){var t,e,n="";return(null===(t=this.$gf.metricHandler)||void 0===t?void 0:t.isMultipleType())?"serie"===this.data.metricType?n+="Series/"+this.data.pattern:n+="Tables/"+this.data.refId+"/"+this.data.column:n=(null===(e=this.$gf.metricHandler)||void 0===e?void 0:e.isTypeOf("serie"))?this.data.pattern:this.data.refId+"/"+this.data.column,n},set:function(t){var e,n,r;if(t||0!==t.length){var a=t.split("/"),i=a.length;if(null===(e=this.$gf.metricHandler)||void 0===e?void 0:e.isMultipleType())if(3===i){if("Tables"!==a[0])return void this.$gf.notify("Invalid name metric : "+t,"error");this.data.metricType="table",this.data.refId=a[1],this.data.column=a[2]}else{if(2!==i)return void this.$gf.notify("Invalid name metric : "+t,"error");if("Series"!==a[0])return void this.$gf.notify("Invalid name metric : "+t,"error");this.data.metricType="serie",this.data.pattern=a[1]}else if(null===(n=this.$gf.metricHandler)||void 0===n?void 0:n.isTypeOf("serie"))this.data.metricType="serie",this.data.pattern=a[0];else{if(!(null===(r=this.$gf.metricHandler)||void 0===r?void 0:r.isTypeOf("table")))return void this.$gf.notify("Invalid name metric : "+t,"error");this.data.metricType="table",this.data.refId=a[0],this.data.column=a[1]}this.change()}}},{key:"metricType",get:function(){return this.data.metricType},set:function(t){this.data.metricType=t}},{key:"metricPattern",get:function(){return this.data.pattern},set:function(t){t&&0!==t.length&&("serie"===this.metricType&&this.data.pattern!==t&&(this.data.pattern=t,this.change()),this.metricType)}},{key:"metricTable",get:function(){return this.data.refId},set:function(t){t&&0!==t.length&&this.data.refId!==t&&(this.data.refId=t,this.change())}},{key:"metricColumn",get:function(){return this.data.column},set:function(t){(t||0!==t.length||this.data.column!==t)&&(this.data.column=t,this.change())}},{key:"hidden",get:function(){return this.data.hidden},set:function(t){this.data.hidden!==t&&(this.data.hidden=t,this.change())}},{key:"tooltip",get:function(){return this.data.tooltip},set:function(t){this.data.tooltip!==t&&(this.data.tooltip=t,this.change())}},{key:"tooltipLabel",get:function(){return this.data.tooltipLabel},set:function(t){this.data.tooltipLabel!==t&&(this.data.tooltipLabel=t,this.change())}},{key:"tooltipOn",get:function(){return this.data.tooltipOn},set:function(t){t&&0!==t.length&&this.data.tooltipOn===t||(this.data.tooltipOn=t,this.change())}},{key:"tooltipMetadata",get:function(){return this.data.tpMetadata},set:function(t){t!==this.data.tpMetadata&&(this.data.tpMetadata=t,this.change())}},{key:"tooltipColors",get:function(){return this.data.tooltipColors},set:function(t){t!==this.data.tooltipColors&&(this.data.tooltipColors=t,this.change())}},{key:"tooltipForGraph",get:function(){return this.data.tpGraph},set:function(t){this.data.tpGraph!==t&&(this.data.tpGraph=t,this.change())}},{key:"graphDirection",get:function(){return this.data.tpDirection},set:function(t){t&&0!==t.length&&this.data.tpDirection===t||(this.data.tpDirection=t,this.change())}},{key:"graphType",get:function(){return this.data.tpGraphType},set:function(t){t&&0!==t.length&&this.data.tpGraphType===t||(this.data.tpGraphType=t,this.change())}},{key:"graphSize",get:function(){return this.data.tpGraphSize},set:function(t){t&&0!==t.length&&this.data.tpGraphSize===t||(this.data.tpGraphSize=t,this.change())}},{key:"graphLow",get:function(){return this.data.tpGraphLow},set:function(t){t!==this.data.tpGraphLow&&(this.data.tpGraphLow=t,this.change())}},{key:"graphHigh",get:function(){return this.data.tpGraphHigh},set:function(t){t!==this.data.tpGraphHigh&&(this.data.tpGraphHigh=t,this.change())}},{key:"graphScale",get:function(){return this.data.tpGraphScale},set:function(t){t&&0!==t.length&&this.data.tpGraphScale===t||(this.data.tpGraphScale=t,this.change())}},{key:"aggregation",get:function(){return this.data.aggregation},set:function(t){t&&this.data.aggregation!==t&&(this.data.aggregation=t,this.change())}},{key:"dataType",get:function(){return this.data.type},set:function(t){t&&this.data.type!==t&&(this.data.type=t,this.change())}},{key:"dataUnit",get:function(){return this.data.unit},set:function(t){t&&0!==t.length&&this.data.type!==t&&(this.data.unit=t,this.change())}},{key:"dataDecimals",get:function(){return this.data.decimals},set:function(t){t||(t=0),t!==this.data.decimals&&(this.data.decimals=t,this.change())}},{key:"value",set:function(t){t&&0!==t.length&&this.data.dateFormat!==t&&(this.data.dateFormat=t,this.change())}},{key:"dateFormat",get:function(){return this.data.dateFormat}},{key:"sanitize",get:function(){return this.data.sanitize},set:function(t){t&&this.data.sanitize!==t&&(this.data.sanitize=t)}},{key:"mappingType",get:function(){return this.data.mappingType},set:function(t){t!==this.data.mappingType&&(this.data.mappingType=t,this.change())}},{key:"invert",get:function(){return this.data.invert},set:function(t){t!==this.data.invert&&(this.data.invert=t,this.invertThesholdsColors())}},{key:"gradient",get:function(){return this.data.gradient},set:function(t){t!==this.data.gradient&&(this.data.gradient=t,this.change())}},{key:"overlayIcon",get:function(){return this.data.overlayIcon},set:function(t){t!==this.data.overlayIcon&&(this.data.overlayIcon=t,this.change())}},{key:"_convert",value:function(t){var e=this;t.unit&&(this.data.unit=t.unit),t.type&&(this.data.type=t.type),t.metricType&&(this.data.metricType=t.metricType),t.alias&&(this.data.alias=t.alias),t.refId&&(this.data.refId=t.refId),t.column&&(this.data.column=t.column),t.aggregation&&(this.data.aggregation=t.aggregation),(t.decimals||0===t.decimals)&&(this.data.decimals=t.decimals),this.data.reduce&&(this.data.reduce=!0);var n=void 0;t.colorOn&&(n=t.colorOn);var r=void 0;t.style&&(r=t.style);var a=!1,i=void 0,s=void 0;t.link&&(a=t.link),t.linkUrl&&(i=t.linkUrl),t.linkParams&&(s=t.linkParams);var o=void 0;t.linkOn&&(o=t.linkOn);var l=void 0;t.textOn&&(l=t.textOn);var u=void 0,c=void 0;if(t.textReplace&&(u=t.textReplace),t.textPattern&&(c=t.textPattern),t.pattern&&(this.data.pattern=t.pattern),t.dateColumn&&(this.data.dateColumn=t.dateColumn),t.dateFormat&&(this.data.dateFormat=t.dateFormat),this.data.numberTHData=[],this.numberTH=[],t.thresholds&&t.colors){var h=0,d=0;t.colors.forEach((function(n){if(0===h)e._addNumberThreshold(h++,n).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e));else{var r=t.thresholds[d++];"string"==typeof r&&r.length>0&&(r=parseFloat(r)),e._addNumberThreshold(h++,n,r).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e))}}))}else if(t.numberTHData){var f=t.numberTHData;void 0!==f&&null!=f&&f.length>0&&f.forEach((function(t){e._addNumberThreshold().import(t).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e))}))}0===this.numberTH.length&&(this._addNumberThreshold(0,"rgba(245, 54, 54, 0.9)",0).events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addNumberThreshold(1,"rgba(237, 129, 40, 0.89)",50).events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addNumberThreshold(2,"rgba(50, 172, 45, 0.97)",80).events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)));var p=[];if(this.data.stringTHData=[],this.stringTH=[],t.stringThresholds&&(p=t.stringThresholds.slice(0)),t.stringWarning&&(p[1]=t.stringWarning),t.stringCritical&&(p[0]=t.stringCritical),p&&t.colors){var v=0,g=0;t.colors.forEach((function(t){if(0===v)e._addStringThreshold(v++,t).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e));else{var n=p[g++];"number"==typeof n&&(n=n.toString()),e._addStringThreshold(v++,t,n).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e))}}))}else if(t.stringTHData){var m=t.stringTHData;void 0!==m&&null!=m&&m.length>0&&m.forEach((function(t){e._addStringThreshold().import(t).events.connect("threshold_changed",e,e._on_TH_threshold_changed.bind(e))}))}0===this.stringTH.length&&(this._addStringThreshold(0,"rgba(245, 54, 54, 0.9)","/.*/").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addStringThreshold(1,"rgba(237, 129, 40, 0.89)","/.*warning.*/").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addStringThreshold(2,"rgba(50, 172, 45, 0.97)","/.*(success|ok).*/").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this))),0===this.dateTH.length&&(this._addDateThreshold(0,"rgba(245, 54, 54, 0.9)","0d").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addDateThreshold(1,"rgba(237, 129, 40, 0.89)","-1d").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),this._addDateThreshold(2,"rgba(50, 172, 45, 0.97)","-1w").events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this))),(t.invert||!1===t.invert)&&(this.data.invert=t.invert),(t.gradient||!1===t.gradient)&&(this.data.gradient=t.gradient),(t.overlayIcon||!1===t.overlayIcon)&&(this.data.overlayIcon=t.overlayIcon),(t.tooltip||!1===t.tooltip)&&(this.data.tooltip=t.tooltip),t.tooltipLabel&&(this.data.tooltipLabel=t.tooltipLabel),(t.tooltipColors||!1===t.tooltipColors)&&(this.data.tooltipColors=t.tooltipColors),t.tooltipOn&&(this.data.tooltipOn=t.tooltipOn),t.tpDirection&&(this.data.tpDirection=t.tpDirection),t.tpMetadata&&(this.data.tpMetadata=t.tpMetadata),(t.tpGraph||!1===this.data.tpGraph)&&(this.data.tpGraph=t.tpGraph),t.tpGraphSize&&(this.data.tpGraphSize=t.tpGraphSize),t.tpGraphType&&(this.data.tpGraphType=t.tpGraphType),(t.tpGraphLow||0===t.tpGraphLow)&&(this.data.tpGraphLow=t.tpGraphLow),(t.tpGraphHigh||0===t.tpGraphHigh)&&(this.data.tpGraphHigh=t.tpGraphHigh),t.tpGraphScale&&(this.data.tpGraphScale=t.tpGraphScale);var y=[];return t.shapeProp&&(this.data.mapsDat.shapes.options.identByProp=t.shapeProp),(t.shapeRegEx||!1===t.shapeRegEx)&&(this.data.mapsDat.shapes.options.enableRegEx=t.shapeRegEx),t.mapsDat&&t.mapsDat.shapes&&(this.data.mapsDat.shapes.options.identByProp=void 0!==t.mapsDat.shapes.options.identByProp?t.mapsDat.shapes.options.identByProp:this.data.mapsDat.shapes.options.identByProp,this.data.mapsDat.shapes.options.enableRegEx=t.mapsDat.shapes.options.enableRegEx,this.data.mapsDat.shapes.options.metadata=t.mapsDat.shapes.options.metadata),y=[],this.data.mapsDat.shapes.dataList=[],null!=(y=void 0!==t.shapeMaps&&null!==t.shapeMaps?t.shapeMaps:void 0!==t.shapeData&&null!==t.shapeData?t.shapeData:t.mapsDat.shapes.dataList)&&y.length>0&&y.forEach((function(t){r&&(t.style=r),n&&(t.colorOn=n),e.addShapeMap().import(t)})),t.textProp&&(this.data.mapsDat.texts.options.identByProp=t.textProp),(t.textRegEx||!1===t.textRegEx)&&(this.data.mapsDat.texts.options.enableRegEx=t.textRegEx),t.mapsDat&&t.mapsDat.texts&&(this.data.mapsDat.texts.options.identByProp=void 0!==t.mapsDat.texts.options.identByProp?t.mapsDat.texts.options.identByProp:this.data.mapsDat.texts.options.identByProp,this.data.mapsDat.texts.options.enableRegEx=t.mapsDat.texts.options.enableRegEx,this.data.mapsDat.texts.options.metadata=t.mapsDat.texts.options.metadata),y=[],this.data.mapsDat.texts.dataList=[],void 0!==(y=void 0!==t.textMaps&&null!==t.textMaps?t.textMaps:void 0!==t.textData&&null!==t.textData?t.textData:t.mapsDat.texts.dataList)&&null!=y&&y.length>0&&y.forEach((function(t){u&&(t.textReplace=u),c&&(t.textPattern=c),l&&(t.textOn=l),e.addTextMap().import(t)})),t.linkProp&&(this.data.mapsDat.links.options.identByProp=t.linkProp),(t.linkRegEx||!1===t.linkRegEx)&&(this.data.mapsDat.links.options.enableRegEx=t.linkRegEx),t.mapsDat&&t.mapsDat.links&&(this.data.mapsDat.links.options.identByProp=void 0!==t.mapsDat.links.options.identByProp?t.mapsDat.links.options.identByProp:this.data.mapsDat.links.options.identByProp,this.data.mapsDat.links.options.enableRegEx=t.mapsDat.links.options.enableRegEx,this.data.mapsDat.links.options.metadata=t.mapsDat.links.options.metadata),this.data.mapsDat.links.dataList=[],y=[],(y=void 0!==t.linkMaps&&null!==t.linkMaps?t.linkMaps:void 0!==t.linkData&&null!==t.linkData?t.linkData:t.mapsDat.links.dataList).length>0&&y.forEach((function(t){i&&a&&(t.linkUrl=i),s&&a&&(t.linkParams=s),o&&(t.linkOn=o),e.addLinkMap().import(t)})),t.eventProp&&(this.data.mapsDat.events.options.identByProp=t.eventProp),(t.eventRegEx||!1===t.eventRegEx)&&(this.data.mapsDat.events.options.enableRegEx=t.eventRegEx),t.mapsDat&&t.mapsDat.events&&(this.data.mapsDat.events.options.identByProp=void 0!==t.mapsDat.events.options.identByProp?t.mapsDat.events.options.identByProp:this.data.mapsDat.events.options.identByProp,this.data.mapsDat.events.options.enableRegEx=t.mapsDat.events.options.enableRegEx,this.data.mapsDat.events.options.metadata=t.mapsDat.events.options.metadata),this.data.mapsDat.events.dataList=[],y=[],void 0!==t.eventData&&null!=t.eventData&&(y=t.eventData),void 0!==t.eventsMap&&null!==t.eventsMap&&(y=t.eventsMap.dataList),t.mapsDat&&t.mapsDat.events&&t.mapsDat.events.dataList&&(y=t.mapsDat.events.dataList),void 0!==y&&null!=y&&y.length>0&&y.forEach((function(t){e.addEventMap().import(t)})),this.data.mappingType=t.mappingType||1,this.data.valueData=[],void 0!==t.valueData&&null!=t.valueData&&t.valueData.length>0&&t.valueData.forEach((function(t){e.addValueMap("value","text").import(t),e.change()})),this.data.rangeData=[],void 0!==t.rangeData&&null!=t.rangeData&&t.rangeData.length>0&&t.rangeData.forEach((function(t){e.addRangeMap("from","to","text").import(t),e.change()})),this.data.sanitize=t.sanitize||!1,this.data.newRule=!1,this}},{key:"getMetrics",value:function(){return this.metrics}},{key:"getData",value:function(){return this.data}},{key:"highlightXCells",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.states){t.next=2;break}return t.abrupt("return",Promise.all(Array.from(this.states.values()).map((function(t){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.highlightCell();case 1:case"end":return e.stop()}}),e)})))}))));case 2:return t.abrupt("return");case 3:case"end":return t.stop()}}),t,this)})))}},{key:"unhighlightXCells",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.states){t.next=2;break}return t.abrupt("return",Promise.all(Array.from(this.states.values()).map((function(t){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.unhighlightCell();case 1:case"end":return e.stop()}}),e)})))}))));case 2:return t.abrupt("return");case 3:case"end":return t.stop()}}),t,this)})))}},{key:"enableMapping",value:function(){var t=[];Object.values(this.mapsObj).forEach((function(e){e.forEach((function(e){e.onMapping=!0,t.push(e.setPattern.bind(e))}))})),this.$gf.setMappingCallBack(t)}},{key:"setOrder",value:function(t){return this.data.order=t,this}},{key:"getOrder",value:function(){return this.data.order}},{key:"_invertColorOrder",value:function(){return this._invertColorOrderFor(this.numberTH),this._invertColorOrderFor(this.stringTH),this._invertColorOrderFor(this.dateTH),this}},{key:"_invertColorOrderFor",value:function(t){var e=[];t.forEach((function(t){e.push(t.color)})),e.reverse();var n=0;return t.forEach((function(t){t.color=e[n++]})),this}},{key:"invertThesholds",value:function(){return this._invertColorOrder(),this.data.invert=!this.data.invert,this}},{key:"invertThesholdsColors",value:function(){return this._invertColorOrder(),this.change(),this}},{key:"addThreshold",value:function(t,e,n){var r;switch(this.data.type){case"number":r=this._addNumberThreshold(t,e,n);break;case"string":r=this._addStringThreshold(t,e,n);break;case"date":r=this._addDateThreshold(t,e,n);break;default:throw new Error("Type of threshold unknown : "+this.data.type)}return r.events.connect("threshold_changed",this,this._on_TH_threshold_changed.bind(this)),r}},{key:"getThreshold",value:function(t){switch(this.data.type){case"number":return this.numberTH[t];case"string":return this.stringTH[t];case"date":return this.dateTH[t];default:throw new Error("Type of threshold unknown : "+this.data.type)}}},{key:"cloneThreshold",value:function(t){var e=this.getThreshold(t);return void 0!==e&&this.addThreshold(t,e.color,e.value).import(e.getData()),this.change(),e}},{key:"_addNumberThreshold",value:function(t,e,n){var r=this.numberTH,a=this.data.numberTHData,i=e,o=n,l=C.getDefaultData(),u=new C(l.color,l.comparator,l.value,l),c=a.length;void 0!==t&&0!==c||(t=c),t>c-1&&(t=c-1);var h=t;if(0===t&&c>1&&(h=1),c>0){var d=r[h];if(u.import(d.getData()),void 0===i){var f=d.color;if(h<c-1&&0!==t){var p=r[h+1].color;i=s.a.calculateColorForRatio(f,p,.5)}else i=f}if(void 0===o){var v=d.value;if(h<c-1&&0!==t){var g=r[h+1].value;o=s.a.calculateValueForRatio(v,g,.5)}else o=v}}return void 0!==i&&(u.color=i),void 0!==o&&(u.value=o),r.splice(t+1,0,u),a.splice(t+1,0,l),u}},{key:"_addStringThreshold",value:function(t,e,n){var r=this.stringTH,a=this.data.stringTHData,i=e,o=n,l=R.getDefaultData(),u=new R(l.color,l.comparator,l.value,l),c=a.length;void 0!==t&&0!==c||(t=c),t>c-1&&(t=c-1);var h=t;if(0===t&&c>1&&(h=1),c>0){var d=r[h];if(u.import(d.getData()),void 0===i){var f=d.color;if(h<c-1&&0!==t){var p=r[h+1].color;i=s.a.calculateColorForRatio(f,p,.5)}else i=f}void 0===o&&(o=d.value)}return void 0!==i&&(u.color=i),void 0!==o&&(u.value=o),r.splice(t+1,0,u),a.splice(t+1,0,l),u}},{key:"_addDateThreshold",value:function(t,e,n,r){var a=this.dateTH,i=this.data.dateTHData,o=e,l=n,u=D.getDefaultData(),c=new D(u.color,u.comparator,u.value,u,r),h=i.length;void 0!==t&&0!==h||(t=h),t>h-1&&(t=h-1);var d=t;if(0===t&&h>1&&(d=1),h>0){var f=a[d];if(c.import(f.getData()),void 0===o){var p=f.color;if(d<h-1&&0!==t){var v=a[d+1].color;o=s.a.calculateColorForRatio(p,v,.5)}else o=p}void 0===l&&(l=f.value)}return void 0!==o&&(c.color=o),void 0!==l&&(c.value=l),a.splice(t+1,0,c),i.splice(t+1,0,u),c}},{key:"removeThreshold",value:function(t){var e=this.getThresholds(),n=this.getThresholdDatas();return e.splice(t,1),n.splice(t,1),this.change(),this}},{key:"getThresholds",value:function(){switch(this.data.type){case"number":return this.numberTH;case"string":return this.stringTH;case"date":return this.dateTH;default:throw new Error("Type of threshold unknown : "+this.data.type)}}},{key:"clearThresholds",value:function(){return this._clearNumberThresholds(),this._clearStringThresholds(),this._clearDateThresholds(),this}},{key:"initThresholds",value:function(){return this._initNumberThresholds(),this._initStringThresholds(),this._initDateThresholds(),this}},{key:"_clearNumberThresholds",value:function(){return this.data.numberTHData=[],this.numberTH=[],this}},{key:"_initNumberThresholds",value:function(){return this._clearNumberThresholds(),this._addNumberThreshold(0,"rgba(245, 54, 54, 0.9)",0),this._addNumberThreshold(1,"rgba(237, 129, 40, 0.89)",50),this._addNumberThreshold(2,"rgba(50, 172, 45, 0.97)",80),this}},{key:"_clearStringThresholds",value:function(){return this.data.stringTHData=[],this.stringTH=[],this}},{key:"_initStringThresholds",value:function(){return this._clearStringThresholds(),this._addStringThreshold(0,"rgba(245, 54, 54, 0.9)","/.*/"),this._addStringThreshold(1,"rgba(237, 129, 40, 0.89)","/.*warning.*/"),this._addStringThreshold(2,"rgba(50, 172, 45, 0.97)","/.*(success|ok).*/"),this}},{key:"_clearDateThresholds",value:function(){return this.data.dateTHData=[],this.dateTH=[],this}},{key:"_initDateThresholds",value:function(){return this._clearDateThresholds(),this._addDateThreshold(0,"rgba(245, 54, 54, 0.9)","0d"),this._addDateThreshold(1,"rgba(237, 129, 40, 0.89)","-1d"),this._addDateThreshold(2,"rgba(50, 172, 45, 0.97)","-1w"),this}},{key:"getThresholdDatas",value:function(){switch(this.data.type){case"number":return this.data.numberTHData;case"string":return this.data.stringTHData;case"date":return this.data.dateTHData;default:throw new Error("Type of threshold unknown : "+this.data.type)}}},{key:"getThresholdCount",value:function(){return this.getThresholds().length}},{key:"toIconize",value:function(t){return!1!==this.data.overlayIcon&&!0===this.data.overlayIcon&&t>=1}},{key:"toTooltipize",value:function(t){return(!1!==this.data.tooltip||!1!==this.data.tpMetadata)&&("a"===this.data.tooltipOn||"wc"===this.data.tooltipOn&&t>=1)}},{key:"MatchState",value:function(t){var e=t.getXCell(),n=this.getShapeMapOptions(),r=e.getDefaultValues(n);return!!(this.matchShape(r,n)||(n=this.getTextMapOptions(),r=e.getDefaultValues(n),this.matchText(r,n)||(n=this.getLinkMapOptions(),r=e.getDefaultValues(n),this.matchLink(r,n)||(n=this.getEventMapOptions(),r=e.getDefaultValues(n),this.matchEvent(r,n)))))}},{key:"_matchMaps",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getMapsOptions(t),r=this._getMapsObjType(t),a=!1,i=r.length,s=0;s<i;s++){var o=r[s];if(a=o.match(e,n))break}return a}},{key:"_getMapsDat",value:function(){return this.data.mapsDat}},{key:"_getRuleMapsData",value:function(t){return this._getMapsDat()["".concat(t,"s")]}},{key:"_getMapsObj",value:function(){return this.mapsObj}},{key:"_getMapsObjType",value:function(t){return this._getMapsObj()["".concat(t,"s")]}},{key:"_getMapsDatList",value:function(t){return this._getRuleMapsData(t).dataList}},{key:"_getMapsOptions",value:function(t){return this._getRuleMapsData(t).options}},{key:"_addMaps",value:function(t){var e=this._getMapsObjType(t.getType()),n=this._getMapsDatList(t.getType());e.push(t),n.push(t.getData())}},{key:"_removeMaps",value:function(t,e){var n=this._getMapsObjType(e),r=this._getMapsDatList(e),a=-1;"number"!=typeof t&&(a=n.indexOf(t)),"number"==typeof t&&(a=t),-1!==a&&(n[a].events.disconnect("map_changed",this),n[a].free(),n.splice(a,1),r.splice(a,1)),this.change()}},{key:"addShapeMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=W.getDefaultData(),n=new W(this.$gf,t,e);return n.setOptions(this.getShapeMapOptions()),this._addMaps(n),n.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),n}},{key:"cloneShapeMap",value:function(t){return this.addShapeMap().import(t)}},{key:"removeShapeMap",value:function(t){return this._removeMaps(t,"shape"),this}},{key:"getShapeMapOptions",value:function(){return this._getMapsOptions("shape")}},{key:"getShapeMap",value:function(t){var e=this._getMapsObjType("shape")[t];if(e instanceof W)return e;throw new Error("map is not an instance of ShapeMap")}},{key:"getShapeMaps",value:function(){return this._getMapsObj().shapes}},{key:"matchShape",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getShapeMapOptions();return this._matchMaps("shape",t,e)}},{key:"addTextMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=Z.getDefaultData(),n=new Z(this.$gf,t,e);return n.setOptions(this.getTextMapOptions()),this._addMaps(n),n.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),n}},{key:"cloneTextMap",value:function(t){return this.addTextMap().import(t)}},{key:"removeTextMap",value:function(t){return this._removeMaps(t,"text"),this}},{key:"getTextMapOptions",value:function(){return this._getMapsOptions("text")}},{key:"getTextMap",value:function(t){var e=this._getMapsObjType("text")[t];if(e instanceof Z)return e;throw new Error("map is not an instance of TextMap")}},{key:"getTextMaps",value:function(){return this._getMapsObj().texts}},{key:"matchText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTextMapOptions();return this._matchMaps("text",t,e)}},{key:"addEventMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=K.getDefaultData(),n=new K(this.$gf,t,e);return n.setOptions(this.getEventMapOptions()),this._addMaps(n),n.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),n}},{key:"cloneEventMap",value:function(t){return this.addEventMap().import(t.getData())}},{key:"removeEventMap",value:function(t){return this._removeMaps(t,"event"),this}},{key:"getEventMapOptions",value:function(){return this._getMapsOptions("event")}},{key:"getEventMap",value:function(t){var e=this._getMapsObjType("event")[t];if(e instanceof K)return e;throw new Error("map is not an instance of EventMap")}},{key:"getEventMaps",value:function(){return this._getMapsObj().events}},{key:"matchEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getEventMapOptions();return this._matchMaps("event",t,e)}},{key:"addLinkMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=q.getDefaultData(),n=new q(this.$gf,t,e);return n.setOptions(this.getLinkMapOptions()),this._addMaps(n),n.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),n}},{key:"cloneLinkMap",value:function(t){return this.addLinkMap().import(t)}},{key:"removeLinkMap",value:function(t){return this._removeMaps(t,"link"),this}},{key:"getLinkMapOptions",value:function(){return this._getMapsOptions("link")}},{key:"getLinkMap",value:function(t){var e=this._getMapsObjType("link")[t];if(e instanceof q)return e;throw new Error("map is not an instance of LinkMap")}},{key:"getLinkMaps",value:function(){return this._getMapsObj().links}},{key:"matchLink",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLinkMapOptions();return this._matchMaps("link",t,e)}},{key:"addValueMap",value:function(t,e){var n=Q.getDefaultdata(),r=new Q(t,e,n);return r.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),this.valueMaps.push(r),this.data.valueData.push(n),this.change(),r}},{key:"cloneValueMap",value:function(t){var e=this.getValueMap(t).getData();return this.addValueMap().import(e)}},{key:"removeValueMap",value:function(t){var e=-1;if(t instanceof Q&&(e=this.valueMaps.indexOf(t)),"number"==typeof t&&(e=t,t=this.valueMaps[e]),-1===e)throw new Error("map is not an instance of ValueMap");return t.events.disconnect("map_changed",this),t.free(),this.data.valueData.splice(e,1),this.valueMaps.splice(e,1),this.change(),this}},{key:"getValueMap",value:function(t){return this.valueMaps[t]}},{key:"getValueMaps",value:function(){return this.valueMaps}},{key:"addRangeMap",value:function(t,e,n){var r=tt.getDefaultData(),a=new tt(t,e,n,r);return a.events.connect("map_changed",this,this._on_map_map_changed.bind(this)),this.rangeMaps.push(a),this.data.rangeData.push(r),this.change(),a}},{key:"cloneRangeMap",value:function(t){var e=this.getRangeMap(t).getData(),n=this.addRangeMap().import(e);return this.change(),n}},{key:"removeRangeMap",value:function(t){var e=-1;if(t instanceof tt&&(e=this.rangeMaps.indexOf(t)),"number"==typeof t&&(e=t,t=this.rangeMaps[e]),-1===e)throw new Error("map is not an instance of RangeMap");t.events.disconnect("map_changed",this),t.free(),this.data.rangeData.splice(e,1),this.rangeMaps.splice(e,1),this.change()}},{key:"getRangeMap",value:function(t){return this.rangeMaps[t]}},{key:"getRangeMaps",value:function(){return this.rangeMaps}},{key:"getExectedTime",value:function(){return"number"==typeof this.execTimes?"".concat(this.execTimes.toFixed(2)," ms"):"".concat(this.execTimes," ms")}},{key:"getThresholdColor",value:function(t){switch(this.data.type){case"number":return this._getColorForNumberTH(t);case"string":return this._getColorForStringTH(t);case"date":return this._getColorForDateTH(t);default:throw new Error("Data type unknown"+this.data.type)}}},{key:"_getColorForNumberTH",value:function(t){var e=this._getIndexNumberTHForValue(t);if(this.data.gradient){if(0===e)return this.numberTH[e].color;if(e===this.numberTH.length-1)return this.numberTH[e].color;var n=this.numberTH[e].color,r=this.numberTH[e].value,a=this.numberTH[e+1].color,i=this.numberTH[e+1].value,o=s.a.calculateRatioForValue(r,i,t);return s.a.calculateColorForRatio(n,a,o)}return this.numberTH[e].color}},{key:"_getIndexTHForValue",value:function(t){switch(this.data.type){case"number":return this._getIndexNumberTHForValue(t);case"string":return this._getIndexStringTHForValue(t);case"date":return this._getIndexDateTHForValue(t);default:throw new Error("Type of threshold unknown : "+this.data.type)}}},{key:"_getIndexNumberTHForValue",value:function(t){for(var e=-1,n=0;n<this.numberTH.length;n++){var r=this.numberTH[n];if(0===n)e=n;else if(!r.hidden){if(!r.match(t))break;e=n}}return e}},{key:"_getIndexStringTHForValue",value:function(t){for(var e=-1,n=0;n<this.stringTH.length;n++){var r=this.stringTH[n];(0===n||!r.hidden&&r.match(t))&&(e=n)}return e}},{key:"_getColorForStringTH",value:function(t){return this.stringTH[this._getIndexStringTHForValue(t)].color}},{key:"_getIndexDateTHForValue",value:function(t){for(var e=-1,n=0;n<this.dateTH.length;n++){var r=this.dateTH[n];(0===n||!r.hidden&&r.match(t))&&(e=n)}return e}},{key:"_getColorForDateTH",value:function(t){return this.dateTH[this._getIndexDateTHForValue(t)].color}},{key:"getThresholdColorForLevel",value:function(t){var e=this.getThresholdIndexForLevel(t);return this.getThreshold(e).color}},{key:"getThresholdIndexForLevel",value:function(t){var e=this.getThresholds().length;return this.data.invert?t:e-1-t}},{key:"getThresholdLevel",value:function(t){var e=this._getIndexTHForValue(t),n=this.getThresholds().length;return this.data.invert&&-1!==e?e:-1!==e?n-1-e:e}},{key:"getThresholdLevelForTH",value:function(t){var e=this.getThresholds().indexOf(t);return-1!==e?this.data.invert?e:this.getThresholdCount()-1-e:e}},{key:"getThresholdLevelForIndex",value:function(t){return-1!==t?this.data.invert?t:this.getThresholdCount()-1-t:t}},{key:"getValueForMetric",value:function(t){if(this.matchMetric(t))try{return t.getValue(this.data.aggregation,this.data.column)}catch(t){return s.c.error("Datapoint for metric is null",t),null}return"-"}},{key:"getFormattedValueForMetric",value:function(t){var e=this.getValueForMetric(t);return this.getFormattedValue(e)}},{key:"getFormattedValue",value:function(t){if("number"===this.data.type){if(!Object(o.isFinite)(t))return"null";if(null==t)return"-";var e=this._decimalPlaces(t);return e="number"==typeof this.data.decimals?Math.min(this.data.decimals,e):e,p.formatValue(t,this.data.unit,this.data.decimals)}if("string"===this.data.type){null==t&&(t="null"),Object(o.isArray)(t)&&(t=t.join(", "));var n=this.data.mappingType||0;if(1===n&&this.valueMaps){for(var r=0;r<this.valueMaps.length;r+=1){var a=this.valueMaps[r];if(!a.hidden&&a.match(t))return a.getFormattedText(t)}return t.toString()}if(2===n&&this.rangeMaps){for(var i=0;i<this.rangeMaps.length;i+=1){var s=this.rangeMaps[i];if(!s.hidden&&s.match(t))return s.getFormattedText(t)}return t.toString()}if(null==t)return"null"}return"date"===this.data.type?null==t?"-":(Object(o.isArray)(t)&&(t=t[0]),p.getFormatedDate(t,this.data.dateFormat)):t}},{key:"$sanitize",value:function(t){throw new Error("Method not implemented.")}},{key:"_decimalPlaces",value:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}},{key:"initCycle",value:function(){return this.highestLevel=-1,this.highestFormattedValue="",this.highestColor="",this.highestValue="",this.execTimes=0,this}},{key:"matchMetric",value:function(t){return"serie"===this.data.metricType&&"serie"===t.type?s.a.matchString(t.getName(),this.data.pattern):"table"===this.data.metricType&&"table"===t.type&&t.getName()===this.data.refId}},{key:"clearMetrics",value:function(){return this.metrics.clear(),this}},{key:"hasMetric",value:function(t){return this.metrics.has(t.uid)}},{key:"_on_metricHandler_metric_deleted",value:function(t){this.constructor.name,this.metrics.has(t.uid)&&(this.metrics.delete(t.uid),this.update())}},{key:"_on_metricHandler_metric_created",value:function(t){this.constructor.name,this.matchMetric(t)&&(this.metrics.set(t.uid,t),this.update())}},{key:"_on_TH_threshold_changed",value:function(){this.constructor.name,this.change()}},{key:"_on_map_map_changed",value:function(){this.constructor.name,this.change()}}])&&A(e.prototype,n),a&&A(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=H(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function H(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function V(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var a=j(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return U(this,n)}}function U(t,e){if(e&&("object"===N(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $(t,e,n){return e&&G(t.prototype,e),n&&G(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Y=["map_initalized","map_changed","map_freed"],X=function(){function t(e,n,r,a){B(this,t),this.type="shape",this.options=P.getDefaultMapOptions(),this.reduce=!0,this.onMapping=!1,this.events=i.a.create(Y),this.$gf=e,this.uid=s.a.genUid(),this.data=r,this.data.pattern=n,a&&this.import(a),this.init()}return $(t,[{key:"init",value:function(){this._setType(),this.events.emit("map_initalized",this),this.$gf.events.connect("mapping_disabled",this,this._on_global_mapping_disabled.bind(this))}},{key:"change",value:function(){this.events.emit("map_changed",this)}},{key:"free",value:function(){this.clear(),this.$gf.events.disconnect("mapping_disabled",this),this.events.emit("map_freed",this)}},{key:"clear",value:function(){this.events.clear()}},{key:"import",value:function(t){return t.metadata&&(this.data.pattern=t.metadata),t.pattern&&(this.data.pattern=t.pattern),t.hidden&&(this.data.hidden=t.hidden),this}},{key:"pattern",get:function(){return this.data.pattern},set:function(t){t&&0!==t.length&&t!==this.data.pattern&&(this.data.pattern=t,this.change())}},{key:"hidden",get:function(){return this.data.hidden},set:function(t){t!==this.data.hidden&&(this.data.hidden=t,this.change())}},{key:"getData",value:function(){return this.data}},{key:"getType",value:function(){return this.type}},{key:"setOptions",value:function(t){return this.options=t,this}},{key:"getOptions",value:function(){return this.options}},{key:"setPattern",value:function(t){var e=t.getDefaultValues(this.options);Array.isArray(e)?this.pattern=e[0]:this.pattern=e}},{key:"match",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.getDefaultMapOptions(),n=arguments.length>2?arguments[2]:void 0,r=this.data.pattern;return void 0!==n&&(r=n.replaceText(r)),null!=t&&0!==t.length&&s.a.matchString(t,r,e.enableRegEx)}},{key:"enableMapping",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.onMapping=t,this.$gf.setMappingCallBack(this.setPattern.bind(this))}},{key:"export",value:function(){return{pattern:this.data.pattern,hidden:this.data.hidden}}},{key:"_on_global_mapping_disabled",value:function(){this.constructor.name,this.onMapping=!1}}],[{key:"getDefaultMethods",value:function(){return this.methods}},{key:"getDefaultPlaceHolder",value:function(t){var e=this.methods.find((function(e){return e.value===t}));if(void 0!==e)return e.placeholder}},{key:"getDefaultValue",value:function(t){var e=this.methods.find((function(e){return e.value===t}));if(void 0!==e)return e.default}}]),t}();X.methods=[];var W=function(t){F(n,t);var e=V(n);function n(){return B(this,n),e.apply(this,arguments)}return $(n,[{key:"_setType",value:function(){this.type="shape"}},{key:"condition",get:function(){return this.data.colorOn},set:function(t){t&&0!==t.length&&t!==this.data.colorOn&&(this.data.colorOn=t,this.change())}},{key:"style",get:function(){return this.data.style},set:function(t){t&&0!==t.length&&t!==this.data.style&&(this.data.style=t,this.change())}},{key:"isEligible",value:function(t){return-1!==t&&("n"!==this.data.colorOn&&("a"===this.data.colorOn||"wc"===this.data.colorOn&&t>=1))}},{key:"import",value:function(t){return I(j(n.prototype),"import",this).call(this,t),t.style&&(this.data.style=t.style),t.colorOn&&(this.data.colorOn=t.colorOn),this}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,style:"fillColor",colorOn:"a"}}}]),n}(X),Z=function(t){F(n,t);var e=V(n);function n(){return B(this,n),e.apply(this,arguments)}return $(n,[{key:"_setType",value:function(){this.type="text"}},{key:"condition",get:function(){return this.data.textOn},set:function(t){t&&0!==t.length&&t!==this.data.textOn&&(this.data.textOn=t,this.change())}},{key:"method",get:function(){return this.data.textReplace},set:function(t){t&&0!==t.length&&t!==this.data.textReplace&&(this.data.textReplace=t,this.change())}},{key:"textToReplace",get:function(){return this.data.textPattern},set:function(t){t&&0!==t.length&&t!==this.data.textPattern&&(this.data.textPattern=t,this.change())}},{key:"isEligible",value:function(t){return"wmd"===this.data.textOn||"n"!==this.data.textOn&&("wc"===this.data.textOn&&t>=1||"co"===this.data.textOn&&t>=2)}},{key:"import",value:function(t){return I(j(n.prototype),"import",this).call(this,t),t.textReplace&&(this.data.textReplace=t.textReplace),t.textPattern&&(this.data.textPattern=t.textPattern),t.textOn&&(this.data.textOn=t.textOn),this}},{key:"getReplaceText",value:function(t,e){if("content"===this.data.textReplace)return e;if("pattern"===this.data.textReplace){var n=s.a.stringToRegEx(this.data.textPattern);return n&&t.toString().match(n)?t.toString().replace(n,e):t}return"as"===this.data.textReplace?"".concat(t," ").concat(e):"anl"===this.data.textReplace?"".concat(t,"\n").concat(e):t}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,textReplace:"content",textPattern:"/.*/",textOn:"wmd"}}}]),n}(X),q=function(t){F(n,t);var e=V(n);function n(){return B(this,n),e.apply(this,arguments)}return $(n,[{key:"_setType",value:function(){this.type="link"}},{key:"condition",get:function(){return this.data.linkOn},set:function(t){t&&0!==t.length&&t!==this.data.linkOn&&(this.data.linkOn=t,this.change())}},{key:"url",get:function(){return this.data.linkUrl},set:function(t){t&&0!==t.length&&t!==this.data.linkUrl&&(this.data.linkUrl=t,this.change())}},{key:"dasboardParams",set:function(t){t!==this.data.linkParams&&(this.data.linkParams=t,this.change())}},{key:"dashboardParams",get:function(){return this.data.linkParams}},{key:"getLink",value:function(){return this.data.linkParams?this.data.linkUrl+window.location.search:this.data.linkUrl}},{key:"import",value:function(t){return I(j(n.prototype),"import",this).call(this,t),t.linkUrl&&(this.data.linkUrl=t.linkUrl),t.linkParams&&(this.data.linkParams=t.linkParams),t.linkOn&&(this.data.linkOn=t.linkOn),this}},{key:"isEligible",value:function(t){return"a"===this.data.linkOn||"wc"===this.data.linkOn&&t>=1}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,linkUrl:"",linkParams:!1,linkOn:"a"}}}]),n}(X),K=function(t){F(n,t);var e=V(n);function n(){var t;return B(this,n),(t=e.apply(this,arguments)).validComp=["lt","le","eq","ne","ge","gt","al"],t}return $(n,[{key:"_setType",value:function(){this.type="event"}},{key:"level",get:function(){return this.data.eventOn},set:function(t){t!==this.data.eventOn&&(this.data.eventOn=t)}},{key:"comparator",get:function(){return this.data.comparator},set:function(t){t&&0!==t.length&&t!==this.data.comparator&&(this.data.comparator=t,this.change())}},{key:"animation",get:function(){return this.data.style},set:function(t){t&&0!==t.length&&t!==this.data.style&&(this.data.style=t,this.change())}},{key:"value",get:function(){return this.data.value},set:function(t){t&&0!==t.length&&t!==this.data.value&&(this.data.value=t,this.change())}},{key:"getPlaceHolder",value:function(){var t=n.getDefaultPlaceHolder(this.data.style);return void 0!==t?t:""}},{key:"isValidComp",value:function(t){return-1!==this.validComp.indexOf(t)}},{key:"getTypeahead",value:function(){var t=this,e=this.$gf.getFullAvailableVarNames(),r=n.methods.find((function(e){return e.value===t.data.style}));if(void 0!==r&&void 0!==r.typeahead)return e=e.concat(r.typeahead.split("|"));if("shape"===this.data.style){var a=this.getFormNames();Array.prototype.push.apply(e,a)}return e}},{key:"getValueByDefault",value:function(){var t=n.getDefaultValue(this.data.style);return void 0!==t?t:""}},{key:"getFormNames",value:function(){if(n.shapes.length>0)return n.shapes;var t=s.a.utils.loadFile(s.d.getRootPath()+s.b.CONF_FILE_SHAPESTXT);return void 0!==t&&0===n.shapes.length?(n.shapes=n.shapes.concat(t.split(/\n/)),n.shapes):n.shapes}},{key:"isEligible",value:function(t){switch(this.data.comparator){case"al":return!0;case"lt":return t<this.data.eventOn;case"le":return t<=this.data.eventOn;case"eq":return t===this.data.eventOn;case"ne":return t!==this.data.eventOn;case"ge":return t>=this.data.eventOn;case"gt":return t>this.data.eventOn;default:return-1===this.data.eventOn||t===this.data.eventOn}}},{key:"import",value:function(t){return I(j(n.prototype),"import",this).call(this,t),t.style&&(this.data.style=t.style),t.comparator&&(this.data.comparator=t.comparator),t.eventOn&&(this.data.eventOn=t.eventOn,-1===this.data.eventOn&&(this.data.comparator="al",this.data.eventOn=0)),t.value&&(this.data.value=t.value),this}}],[{key:"getDefaultData",value:function(){return{pattern:"",hidden:!1,style:"shape",comparator:"eq",eventOn:0,value:""}}}]),n}(X);K.methods=s.b.EVENTMETHODS,K.shapes=[];var J=function(){function t(e){B(this,t),this.uid=s.a.genUid(this.constructor.name),this.reduce=!0,this.events=i.a.create(Y),this.data=e,this.init()}return $(t,[{key:"init",value:function(){this.events.emit("map_initalized",this)}},{key:"change",value:function(){this.events.emit("map_changed",this)}},{key:"free",value:function(){this.events.clear(),this.events.emit("map_freed",this)}},{key:"hidden",get:function(){return this.data.hidden},set:function(t){t!==this.data.hidden&&(this.data.hidden=t,this.change())}},{key:"text",get:function(){var t;return null!==(t=this.data.text)&&void 0!==t?t:""},set:function(t){t!==this.data.text&&(this.data.text=t.trim(),this.change())}},{key:"import",value:function(t){return t.text&&(this.data.text=t.text),this}},{key:"getData",value:function(){return this.data}}]),t}(),Q=function(t){F(n,t);var e=V(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;return B(this,n),(t=e.call(this,i)).data.value=r,t.data.text=a,t.import(i),t}return $(n,[{key:"value",get:function(){var t;return null!==(t=this.data.value)&&void 0!==t?t:""},set:function(t){t!==this.data.value&&(this.data.value=t,this.change())}},{key:"import",value:function(t){return this.data.value=t.value||this.data.value||void 0,this.data.text=t.text||this.data.text||void 0,this.data.hidden=t.hidden||this.data.hidden||!1,this}},{key:"match",value:function(t){return null==t?"null"===this.data.value:!Object(o.isString)(t)&&Number(this.data.value)===Number(t)||s.a.matchString(t.toString(),this.data.value)}},{key:"getFormattedText",value:function(t){return null!=t||"null"!==this.data.value&&"undefined"!==this.data.value?this.match(t)?this.data.text?this.data.text:"":"".concat(t):this.data.text?this.data.text:""}}],[{key:"getDefaultdata",value:function(){return{value:void 0,text:void 0,hidden:!1}}}]),n}(J),tt=function(t){F(n,t);var e=V(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0;return B(this,n),(t=e.call(this,o)).reduce=!0,t.uid=s.a.genUid(),t.data=o,t.data.from=r,t.data.to=a,t.data.text=i,t.data.hidden=!1,t}return $(n,[{key:"to",get:function(){var t;return null!==(t=this.data.to)&&void 0!==t?t:""},set:function(t){t!==this.data.to&&(this.data.to=t,this.change())}},{key:"from",get:function(){var t;return null!==(t=this.data.from)&&void 0!==t?t:""},set:function(t){t!==this.data.from&&(this.data.from=t,this.change())}},{key:"import",value:function(t){return this.data.from=t.from?t.from:void 0,this.data.to=t.to?t.to:void 0,this.data.text=t.text?t.text:void 0,this.data.hidden=!(!t.hidden&&!1!==t.hidden)&&t.hidden,this}},{key:"match",value:function(t){if(void 0!==t&&"string"==typeof t&&t.length>0||void 0!==t&&"number"==typeof t){var e=Number(t);return void 0!==this.data.from&&"string"==typeof t&&this.data.from.length>0||void 0!==this.data.from&&"number"==typeof t?e>=Number(this.data.from)&&(!(void 0!==this.data.to&&"string"==typeof this.data.to&&this.data.to.length>0||void 0!==this.data.from&&"number"==typeof this.data.to)||e<Number(this.data.to)):!(void 0!==this.data.to&&"string"==typeof this.data.to&&this.data.to.length>0||void 0!==this.data.to&&"number"==typeof this.data.to)||e<Number(this.data.to)}return!1}},{key:"getFormattedText",value:function(t){return this.match(t)?this.data.text:t}}],[{key:"getDefaultData",value:function(){return{from:void 0,to:void 0,text:void 0,hidden:!1}}}]),n}(J);function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}rt.$inject=["$q","uiSegmentSrv"];var nt=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.style=s.b.COLORMETHODS,this.metricTypes=s.b.METRIC_TYPES,this.colorOn=s.b.COLOR_APPLYON,this.linkOn=s.b.LINK_APPLYON,this.tooltipOn=s.b.TOOLTIP_APPLYON,this.textOn=s.b.TEXT_APPLYON,this.textReplace=s.b.TEXTMETHODS,this.comparator=s.b.COMPARATOR_TYPES,this.EventType=K.getDefaultMethods(),this.tpDirection=s.b.TOOLTIP_DIRECTION_TYPES,this.propTypes=s.b.IDENT_TYPES,this.textPattern="/.*/",this.valueTypes=s.b.VALUE_TYPES,this.dateFormats=s.b.VALUE_DATEFORMAT_TYPES,this.aggregationTypes=s.b.AGGREGATION_TYPES,this.mappingTypes=s.b.VALUEMAPPINGTYPES,this.tpGraphType=s.b.TOOLTIP_GRAPH_TYPES,this.tpGraphScale=s.b.TOOLTIP_GRAPH_SCALE_TYPES,this.tpGraphSize=s.b.TOOLTIP_GRAPH_SIZE_TYPES,this.currentParams=new Map,this.getCellNamesTypeHead=function(){var t=r.getCurrentMap(),e=[],n=void 0;return(n=t?t.getOptions():r.getCurrentParam("currentOptions"))&&(e=r.getCellNames4(n)),e},this.getCellNamesMD=function(){var t,e=r.getCurrentMap(),n=[];if(e){var a=e.getOptions(),i=null===(t=r.flowchartHandler)||void 0===t?void 0:t.getFlowchart();i&&(n=i.getNamesByOptions(a,"value"))}return n},e.editor=this,this.$scope=e,this.ctrl=e.ctrl,e.GFPlugin=this.ctrl.GFPlugin,e.$GF=this.ctrl.$gf,this.$gf=this.ctrl.$gf;var a=n.find("#templateMapping");this.parentDiv=a[0],this.rulesHandler=this.ctrl.rulesHandler,this.flowchartHandler=this.ctrl.flowchartHandler,this.rulesHandler=this.ctrl.rulesHandler,this.metricHandler=this.ctrl.metricHandler,this.unitFormats=p.getUnitFormats(),this.tpGraphSize=s.b.TOOLTIP_GRAPH_SIZE_TYPES;var i=0;this.rulesTableData={data:[],columns:[{index:i++,id:"expand",label:"<>",desc:"Show/Hide detail",width:"30px",sort:"asc",select:!1},{index:i++,id:"rule",label:"Rule",desc:"Rule Name",width:"100px",sort:"asc",select:!1},{index:i++,id:"metric",label:"Metric",desc:"Metric Name",width:"100px",sort:"asc",select:!1},{index:i++,id:"level",label:"Lvl",desc:"Highest level",width:"40px",sort:"asc",select:!1},{index:i++,id:"fval",label:"F. val.",desc:"Formated value",width:"50px",sort:"asc",select:!1},{index:i++,id:"color",label:"Color",desc:"Highest color",width:"50px",sort:"asc",select:!1},{index:i++,id:"options",label:"Options",desc:"Options",width:"80px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"120px",sort:"asc",select:!1}]},i=0,this.shapesTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"what",label:"What",desc:"What is the shape to apply this rule",width:"100px",sort:"asc",select:!1},{index:i++,id:"when",label:"When",desc:"When to apply this rule on shape",width:"100px",sort:"asc",select:!1},{index:i++,id:"how",label:"How",desc:"How to apply this rule on shape",width:"100px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.textsTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"what",label:"What",desc:"What is the shape/label to apply this rule",width:"100px",sort:"asc",select:!1},{index:i++,id:"when",label:"When",desc:"When to apply this rule on shape",width:"100px",sort:"asc",select:!1},{index:i++,id:"how",label:"How",desc:"How to apply this rule on shape",width:"100px",sort:"asc",select:!1},{index:i++,id:"with",label:"With",desc:"Text to replace",width:"100px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.linksTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"what",label:"What",desc:"What is the shape/label to apply this rule",width:"100px",sort:"asc",select:!1},{index:i++,id:"when",label:"When",desc:"When to apply this rule on shape",width:"100px",sort:"asc",select:!1},{index:i++,id:"url",label:"URL",desc:"URL relative or absolute",width:"150px",sort:"asc",select:!1},{index:i++,id:"options",label:"Options",desc:"Options",width:"45px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.eventsTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"what",label:"What",desc:"What is the shape/label to apply this rule",width:"100px",sort:"asc",select:!1},{index:i++,id:"when",label:"When",desc:"When current level is",width:"80px",sort:"asc",select:!1},{index:i++,id:"level",label:"Lvl",desc:"Threshold level",width:"60px",sort:"asc",select:!1},{index:i++,id:"then",label:"Then",desc:"Then execute this action",width:"120px",sort:"asc",select:!1},{index:i++,id:"with",label:"With",desc:"With this value/parameter",width:"80px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.THsTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",align:"center",sort:"asc",select:!1},{index:i++,id:"colors",label:"Colors",desc:"Colorize object",align:"center",width:"75px",sort:"asc",select:!1},{index:i++,id:"when",label:"When",desc:"When metric value like...",width:"67px",sort:"asc",select:!1},{index:i++,id:"value",label:"Than",desc:"Enter a value to define the level",width:"80px",align:"left",sort:"asc",select:!1},{index:i++,id:"level",label:"lvl.",desc:"Level",width:"50px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.valuesTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"value",label:"Value",desc:"Origin value",width:"100px",sort:"asc",select:!1},{index:i++,id:"text",label:"Text",desc:"Final value",width:"100px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]},i=0,this.rangesTableData={data:[],columns:[{index:i++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:i++,id:"from",label:"From",desc:"Min of value to replace",width:"100px",sort:"asc",select:!1},{index:i++,id:"to",label:"To",desc:"Max of value to replace",width:"100px",sort:"asc",select:!1},{index:i++,id:"text",label:"Text",desc:"Final value",width:"100px",sort:"asc",select:!1},{index:i++,id:"actions",label:"Actions",desc:"Actions",width:"100px",sort:"asc",select:!1}]};var o=a.find("#RulesTable")[0];this.rulesTable=new s.e(this.rulesTableData,o);var l=a.find("#ShapesTable")[0];this.shapesTable=new s.e(this.shapesTableData,l);var u=a.find("#TextsTable")[0];this.textsTable=new s.e(this.textsTableData,u);var c=a.find("#LinksTable")[0];this.linksTable=new s.e(this.linksTableData,c);var h=a.find("#EventsTable")[0];this.eventsTable=new s.e(this.eventsTableData,h);var d=a.find("#THsTable")[0];this.THsTable=new s.e(this.THsTableData,d);var f=a.find("#ValuesTable")[0];this.valuesTable=new s.e(this.valuesTableData,f);var v=a.find("#RangesTable")[0];this.rangesTable=new s.e(this.rangesTableData,v),this.getMetricNames=function(){return r.metricHandler?r.metricHandler.getNames("serie"):[]},this.getVariables=function(){return r.$gf.getFullAvailableVarNames()},this.getEventValues=[]}var e,n,a;return t.$inject=["$scope","$element"],e=t,(n=[{key:"setCurrentParam",value:function(t,e){this.currentParams.set(t,e)}},{key:"unsetCurrentParam",value:function(t){this.currentParams.delete(t)}},{key:"setCurrentMap",value:function(t){this.setCurrentParam("currentMap",t)}},{key:"unsetCurrentMap",value:function(){this.unsetCurrentParam("currentMap")}},{key:"getCurrentMap",value:function(){return this.getCurrentParam("currentMap")}},{key:"getCurrentParam",value:function(t){return this.currentParams.get(t)}},{key:"getCellNames4",value:function(t){var e,n=[];if(t){var r=null===(e=this.flowchartHandler)||void 0===e?void 0:e.getFlowchart();r&&(n=r.getNamesByOptions(t))}return n}},{key:"isFirstRule",value:function(t){return 0===t}},{key:"isOnlySeries",value:function(){var t,e,n=(null===(t=this.metricHandler)||void 0===t?void 0:t.isTypeOf("serie"))&&!(null===(e=this.metricHandler)||void 0===e?void 0:e.isTypeOf("table"));return void 0!==n&&n}},{key:"isOnlyTables",value:function(){var t,e,n=!(null===(t=this.metricHandler)||void 0===t?void 0:t.isTypeOf("serie"))&&(null===(e=this.metricHandler)||void 0===e?void 0:e.isTypeOf("table"));return void 0!==n&&n}},{key:"isMultipleType",value:function(){var t,e,n=(null===(t=this.metricHandler)||void 0===t?void 0:t.isTypeOf("serie"))&&(null===(e=this.metricHandler)||void 0===e?void 0:e.isTypeOf("table"));return void 0!==n&&n}},{key:"initType",value:function(t){this.isOnlyTables()?t.data.metricType="table":this.isOnlySeries()&&(t.data.metricType="serie")}},{key:"getTablesName",value:function(){return this.metricHandler?this.metricHandler.getNames("table"):[]}},{key:"getColumnsForTable",value:function(t){return this.metricHandler?this.metricHandler.getColumnsName(t,"table"):[]}},{key:"getFastEditMectricNames",value:function(t){var e;return this.$gf.metricHandler?null===(e=this.$gf.metricHandler)||void 0===e?void 0:e.getMetricNames():[]}},{key:"ValidateDate",value:function(t){if("date"!==t.dataType)return!0;try{var e="serie",n=t.metricPattern,r=void 0;if("table"===t.metricType&&(e="table",n=t.metricTable,r=t.metricColumn),this.metricHandler)for(var a=this.metricHandler.findMetrics(n,e),i=a.length,s=0;s<i;s++){var o=a[s],l=o.getValue(t.aggregation,r);if(!D.isValidDate(l))return this.$gf.notify("The value for the metric ".concat(o.getName()," and the aggregation ").concat(this.$gf.GetT4V(this.aggregationTypes,t.aggregation)," is not a valid date : ").concat(l)),!1}return!0}catch(t){return!1}}},{key:"getColumnsNameForRule",value:function(t){var e="serie",n=t.data.pattern;return"table"===t.data.metricType&&(e="table",n=t.metricTable),this.metricHandler?this.metricHandler.getColumnsName(n,e):[]}},{key:"isLastRule",value:function(t){var e,n=null===(e=this.rulesHandler)||void 0===e?void 0:e.countRules();return void 0!==n&&t===n-1}},{key:"render",value:function(){this.ctrl.render()}},{key:"setUnitFormat",value:function(t,e){t.data.unit=e.value}},{key:"onRulesChange",value:function(t){var e;return t?t.change():null===(e=this.ctrl.rulesHandler)||void 0===e||e.change(),!0}},{key:"removeShapeMap",value:function(t,e){var n=t.getShapeMap(e);this.unhighlightXCells(n),t.removeShapeMap(e)}},{key:"removeTextMap",value:function(t,e){var n=t.getTextMap(e);this.unhighlightXCells(n),t.removeTextMap(e)}},{key:"removeLinkMap",value:function(t,e){var n=t.getLinkMap(e);this.unhighlightXCells(n),t.removeLinkMap(e)}},{key:"removeEventMap",value:function(t,e){var n=t.getEventMap(e);this.unhighlightXCells(n),t.removeEventMap(e)}},{key:"onColorChange",value:function(t){return function(e){t.color=e}}},{key:"highlightXCells",value:function(t){var e,n=null===(e=this.flowchartHandler)||void 0===e?void 0:e.getFlowchart(),r=null==n?void 0:n.getXGraph();r&&r.highlightXCells(t.pattern,t.getOptions(),!0)}},{key:"unhighlightXCells",value:function(t){var e,n=null===(e=this.flowchartHandler)||void 0===e?void 0:e.getFlowchart(),r=null==n?void 0:n.getXGraph();r&&r.highlightXCells(t.pattern,t.getOptions(),!1)}},{key:"highlightXCells4Rule",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.highlightXCells();case 1:case"end":return e.stop()}}),e)})))}},{key:"unhighlightXCells4Rule",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.unhighlightXCells();case 1:case"end":return e.stop()}}),e)})))}},{key:"unhighlightAllCells",value:function(){var t;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null===(t=this.flowchartHandler)||void 0===t?void 0:t.getFlowchart(),(r=null==n?void 0:n.getXGraph())&&r.unhighlightCells();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"removeRule",value:function(t,e){var n;(1===t.removeClick||e)&&(this.unhighlightAllCells(),null===(n=this.rulesHandler)||void 0===n||n.removeRule(t),this.onRulesChange()),t.removeClick=1,window.setInterval((function(){t&&(t.removeClick=2)}),2e3)}},{key:"cloneRule",value:function(t){var e;null===(e=this.rulesHandler)||void 0===e||e.cloneRule(t),this.onRulesChange()}},{key:"moveRule",value:function(t,e){var n,r;e?null===(n=this.rulesHandler)||void 0===n||n.moveRuleToUp(t):null===(r=this.rulesHandler)||void 0===r||r.moveRuleToDown(t),this.onRulesChange()}},{key:"onEventValue",value:function(t){this.getEventValues=t.getTypeahead()}}])&&et(e.prototype,n),a&&et(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rt(t,e){return{restrict:"E",scope:!0,templateUrl:"".concat(s.d.getPartialPath(),"/rules/rulesTab.html"),controller:nt}}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}st.$inject=["$q","$sce","uiSegmentSrv"];var it=function(){function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceTypes=s.b.SOURCE_TYPES,this.themes=s.b.DIOTHEME_TYPES,this.errorSourceFlag=!1,this.errorSourceMsg="",this.errorDownloadFlag=!1,this.errorDownloadMsg="",this.editMode=!1,this.newName="",this.currentFlowchartName="Main",e.editor=this,this.ctrl=e.ctrl,e.GFPlugin=this.ctrl.GFPlugin,e.$GF=this.ctrl.$gf,this.$gf=this.ctrl.$gf,this.$scope=e,this.flowchartHandler=this.ctrl.flowchartHandler,this.currentFlowchart=null===(n=this.flowchartHandler)||void 0===n?void 0:n.getFlowchart();var r=0;this.flowchartsTableData={data:[],columns:[{index:r++,id:"expand",label:"",desc:"Expand/collapse",width:"30px",sort:"asc",select:!1},{index:r++,id:"name",label:"Flowchart name",desc:"Flowchart Name",width:"120px",sort:"asc",select:!1},{index:r++,id:"type",label:"Type",desc:"XML or CSV",width:"45px",sort:"asc",select:!1},{index:r++,id:"source",label:"source",desc:"Src. origin",width:"60px",sort:"asc",select:!1},{index:r++,id:"background",label:"BG Col.",desc:"Background color",width:"60px",sort:"asc",select:!1},{index:r++,id:"options",label:"Options",desc:"Checked options",width:"150px",sort:"asc",select:!1}]},this.flowchartsTable=new s.e(this.flowchartsTableData)}var e,n,r;return t.$inject=["$scope"],e=t,(n=[{key:"render",value:function(){var t;null===(t=this.flowchartHandler)||void 0===t||t.render()}},{key:"onColorChange",value:function(t){return function(e){t.background=e}}},{key:"getFlowcharts",value:function(){return this.flowchartHandler?this.flowchartHandler.getFlowcharts():[]}},{key:"addFlowchart",value:function(){var t;this.editMode=!0,this.currentFlowchart=null===(t=this.flowchartHandler)||void 0===t?void 0:t.addFlowchart(this.flowchartHandler.getFlowchartTmpName()),this.currentFlowchart}},{key:"removeFlowchart",value:function(){}},{key:"selectFlowchart",value:function(){var t,e;null===(t=this.flowchartHandler)||void 0===t||t.setCurrentFlowchart(this.flowchartHandler.currentFlowchartName),this.currentFlowchart=null===(e=this.flowchartHandler)||void 0===e?void 0:e.getCurrentFlowchart(),this.flowchartHandler&&this.currentFlowchart&&(this.currentFlowchartName=this.flowchartHandler.getCurrentFlowchartName(),this.ctrl.notify(this.currentFlowchartName))}},{key:"cancelFlowchart",value:function(){}},{key:"edit",value:function(t){var e,n,r=null===(e=this.flowchartHandler)||void 0===e?void 0:e.getFlowchart(t);r&&!r.data.download&&(null===(n=this.flowchartHandler)||void 0===n||n.openDrawEditor(t))}},{key:"getNames",value:function(){return this.flowchartHandler?this.flowchartHandler.getFlowchartNames():[]}},{key:"getCurrentFlowchart",value:function(){var t,e=null===(t=this.flowchartHandler)||void 0===t?void 0:t.getCurrentFlowchart();return e?[e]:this.flowchartHandler&&this.flowchartHandler.flowcharts.length>0?[this.flowchartHandler.flowcharts[0]]:[]}}])&&at(e.prototype,n),r&&at(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function st(t,e,n){return{restrict:"E",scope:!0,templateUrl:"".concat(s.d.getPartialPath(),"/flowcharts/flowchartsTab.html"),controller:it}}var ot=n(6),lt=n.n(ot);function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isHidden=!1,this._isHighlighted=!1,this._isBlink=!1,this._surroundHL=new Map,this.percent=100,this._mxcellHL=null,this.uid=s.a.genUid("xcell"),this.graph=e,this.mxcell=n,this.uid=n.getId(),this.gf=this._getDefaultGFXCell(),this.mxcell.gf=this.gf,this._isHidden=!this.graph.model.isVisible(this.mxcell)}var e,n,a;return e=t,a=[{key:"refactore",value:function(e,n){return new t(e,n)}}],(n=[{key:"_getDefaultGFXCell",value:function(){return{defaultValues:{id:void 0,value:void 0,metadata:void 0,link:void 0,styles:void 0,dimension:void 0},tooltip:{enableTooltip:!1,displayMetadata:!1,tooltipHandler:void 0}}}},{key:"_getDefaultValue",value:function(t){this._initDefaultValue(t);var e=this.gf.defaultValues[t];return void 0===e?null:e}},{key:"_initDefaultValue",value:function(t){return void 0===this.gf.defaultValues[t]&&this._setDefaultValue(t),this}},{key:"getDefaultValue",value:function(t){return this._getDefaultValue(t)}},{key:"getValue",value:function(t){switch(t){case"id":return this.getId();case"value":return this.getLabel();case"link":return this.getLink();case"metadata":return this.getDefaultValue("metadata");default:throw new Error("Type ".concat(t," not implemented in method getValue()"))}}},{key:"getValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.getDefaultMapOptions(),e=this.getValue(t.identByProp);return"metadata"===t.identByProp&&(e=this.getDefaultMetadatasValues(t.metadata,t.enableRegEx)),e}},{key:"getDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.getDefaultMapOptions(),e=this.getDefaultValue(t.identByProp);return"metadata"===t.identByProp&&(e=this.getDefaultMetadatasValues(t.metadata,t.enableRegEx)),e}},{key:"_setDefaultValue",value:function(t){switch(t){case"id":var e=this.mxcell.getId();return this.gf.defaultValues.id=e,e;case"value":var n=this.getLabel();return this.gf.defaultValues.value=n,n;case"link":var r=this.getLink();this.gf.defaultValues.link=r;case"dimension":this.gf.defaultValues.dimension=this.getDimension();case"metadata":return this.gf.defaultValues.metadata=this.getMetadatas();case"styles":return this._setDefaultStyles();default:throw new Error("Unknow type : "+t)}}},{key:"getId",value:function(){return this.mxcell.getId()}},{key:"getDefaultId",value:function(){return this.getDefaultValue("id")}},{key:"setId",value:function(t){return this._initDefaultValue("id"),this.mxcell.id=t,this}},{key:"restoreId",value:function(){return this.setId(this.getDefaultId()),this}},{key:"getDefaultLabel",value:function(){return this.getDefaultValue("value")}},{key:"getLabel",value:function(){return mxUtils.isNode(this.mxcell.value)?this.mxcell.getAttribute("label"):this.mxcell.getValue()}},{key:"setLabel",value:function(t){return this._initDefaultValue("value"),this.graph.cellLabelChanged(this.mxcell,t,!1),this}},{key:"restoreLabel",value:function(){return this.setLabel(this.getDefaultLabel()),this}},{key:"getDefaultLink",value:function(){return this.getDefaultValue("link")}},{key:"getLink",value:function(){return this.graph.getLinkForCell(this.mxcell)}},{key:"setLink",value:function(t){return this._initDefaultValue("link"),this.graph.setLinkForCell(this.mxcell,t),this}},{key:"restoreLink",value:function(){this.setLink(this.getDefaultLink())}},{key:"getMetadatas",value:function(){var t=new Map;if(this.mxcell&&mxUtils.isNode(this.mxcell.value))for(var e=["label","tooltip","placeholders","placeholder","link"],n=this.mxcell.value.attributes,r=n.length,a=0;a<r;a++)if(!e.includes(n[a].nodeName)){var i=n[a].nodeName,s=n[a].nodeValue;t.set(i,s)}return t}},{key:"setMetadata",value:function(t,e){return this._initDefaultValue("metadata"),this.mxcell.setAttribute(t,e),this}},{key:"getMetadata",value:function(t){return this.mxcell.getAttribute(t)}},{key:"getDefaultMetadatasKeys",value:function(){var t=this._getDefaultValue("metadata");return void 0!==t?Array.from(t.keys()):[]}},{key:"getDefaultMetadatasValues",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._getDefaultValue("metadata"),r=n;if(!e&&r.has(t)){var a=r.get(t);return null!=a?[a]:[]}var i=this.getDefaultMetadatasKeys();if(void 0!==i){for(var o=[],l=i.length,u=0;u<l;u++){var c=i[u];if(s.a.matchString(c,t,e)){var h=r.get(t);null!=h&&o.push(h)}}return o}return[]}},{key:"hasMetadataName",value:function(t){return this.getDefaultMetadatasKeys().includes(t)}},{key:"_matchMetadata",value:function(t,e){for(var n=this.getDefaultMetadatasValues(e.metadata,e.enableRegEx),r=n.length,a=0;a<r;a++){var i=n[a];if(s.a.matchString(i,t,e.enableRegEx))return!0}return!1}},{key:"_setDefaultMetadatas",value:function(){var t=new Map;if(this.mxcell&&mxUtils.isNode(this.mxcell.value))for(var e=["label","tooltip","placeholders","placeholder","link"],n=this.mxcell.value.attributes,r=n.length,a=0;a<r;a++)if(!e.includes(n[a].nodeName)){var i=n[a].nodeName,s=n[a].nodeValue;t.set(i,s)}return this.gf.defaultValues.metadata=t,t}},{key:"_initDefaultStyle",value:function(t){return void 0!==this.gf.defaultValues.styles&&this.gf.defaultValues.styles.has(t)||this._setDefaultStyle(t),this}},{key:"_setDefaultStyles",value:function(){return void 0===this.gf.defaultValues.styles&&(this.gf.defaultValues.styles=new Map),this.gf.defaultValues.styles}},{key:"_setDefaultStyle",value:function(t){void 0===this.gf.defaultValues.styles&&this._setDefaultStyles();var e=this.graph.view.getState(this.mxcell),n=null;return e&&(n=e.style[t]),void 0!==this.gf.defaultValues.styles&&this.gf.defaultValues.styles.set(t,n),n}},{key:"getDefaultStyle",value:function(t){return void 0!==this.gf.defaultValues.styles&&this.gf.defaultValues.styles.has(t)?this.gf.defaultValues.styles.get(t):this._setDefaultStyle(t)}},{key:"setStyle",value:function(t,e){return this._initDefaultStyle(t),this.graph.setCellStyles(t,e,[this.mxcell]),this}},{key:"getStyle",value:function(t){var e=this.graph.view.getState(this.mxcell);return e?e.style[t]:null}},{key:"isStyleChanged",value:function(t){return this.getDefaultStyle(t)===this.getStyle(t)}},{key:"restoreStyle",value:function(t){var e=this.getDefaultStyle(t);return this.setStyle(t,e),this}},{key:"getDefaultDimension",value:function(){return this.getDefaultValue("dimension")}},{key:"getDimension",value:function(){return this.graph.model.getGeometry(this.mxcell)}},{key:"setDimension",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.graph.resizeCell(this.mxcell,t,!0);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"restoreDimension",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.getDefaultValue("dimension"),this.setDimension(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getMxCell",value:function(){return this.mxcell}},{key:"getMxCellState",value:function(){return this.graph.view.getState(this.mxcell)}},{key:"isVertex",value:function(){return this.mxcell.isVertex()}},{key:"getSvgNode",value:function(){var t=this.getMxCellState();return t&&t.shape.node?t.shape.node:null}},{key:"cloneSVG",value:function(){var t=document.createElement("svg"),e=this.getSvgNode();if(null!==e){var n=e.cloneNode(!0);return t.appendChild(n),t}return t}},{key:"cloneMxCell",value:function(){return this.graph.cloneCell(this.mxcell,!0)}},{key:"match",value:function(t,e){if("id"===e.identByProp||"value"===e.identByProp){var n=this.getDefaultValue(e.identByProp);return s.a.matchString(n,t,e.enableRegEx)}if("metadata"===e.identByProp)return this._matchMetadata(t,e);throw new Error("Type is unknown : "+e)}},{key:"hide",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!this._isHidden&&t?this.graph.model.setVisible(this.mxcell,!1):this._isHidden&&!t&&this.graph.model.setVisible(this.mxcell,!0),this._isHidden=t}},{key:"show",value:function(){this.hide(!1)}},{key:"isHidden",value:function(){return this._isHidden}},{key:"highlight",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=s.b.CONF_HIGHTLIGHT_COLOR;!this._isHighlighted&&t?(this._isHighlighted=!0,this.surround(e,!0,!0)):this._isHighlighted&&!t&&(this.surround(e,!0,!1),this._isHighlighted=!1),this._isHighlighted=t}},{key:"unhighlight",value:function(){this.highlight(!1)}},{key:"isHighlighted",value:function(){return this._isHighlighted}},{key:"collapse",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.graph.isCellCollapsed(this.mxcell);!e&&t?this.graph.foldCells(!0,!1,[this.mxcell],null,null):e&&!t&&this.graph.foldCells(!1,!1,[this.mxcell],null,null)}},{key:"isCollapsed",value:function(){return this.graph.isCellCollapsed(this.mxcell)}},{key:"expand",value:function(){this.collapse(!1)}},{key:"enableTooltip",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.gf.tooltip.enableTooltip=t,t||(this.gf.tooltip.tooltipHandler&&this.gf.tooltip.tooltipHandler.destroy(),this.gf.tooltip.tooltipHandler=void 0),this}},{key:"setTooltipHandler",value:function(t){return this.gf.tooltip.tooltipHandler=t,this}},{key:"zoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,a,i,s,o,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.getDefaultDimension(),100!==t?(this._initDefaultValue("dimension"),null!==n&&(r=n.x,a=n.width,i=n.y,s=n.height,r-=((o=a*(t/100))-a)/2,i-=((l=s*(t/100))-s)/2,u=new mxRectangle(r,i,o,l),this.setDimension(u),this.percent=t)):100!==this.percent&&(this.setDimension(n),this.percent=100);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"resize",value:function(t,e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,a,i,s,o,l,u,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this._initDefaultValue("dimension"),null!==(r=this.getDimension())&&(a=r.x,i=r.width,s=r.y,o=r.height,a=void 0!==t&&t<0?a+t+i:a,s=void 0!==e&&e<0?s+e+o:s,l=void 0!==e?Math.abs(e):r.height,u=void 0!==t?Math.abs(t):r.width,c=new mxRectangle(a,s,u,l),this.setDimension(c));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"isSurrounded",value:function(t){return void 0!==this._surroundHL?this._surroundHL.has(t):(this._surroundHL=new Map,!1)}},{key:"surround",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(r&&!this.isSurrounded(t)){var a=100,i=this.getMxCellState();if(null!==i){var s=Math.max(5,mxUtils.getValue(i.style,mxConstants.STYLE_STROKEWIDTH,1)+4),o=new mxCellHighlight(this.graph,t,s,!1);null!==a&&(o.opacity=a),o.highlight(i),this._surroundHL.set(t,o)}}else if(!r&&this.isSurrounded(t)){var l=this._surroundHL.get(t),u=300;l&&null!==l.shape&&void 0!==l.shape&&(n&&mxUtils.setPrefixedStyle(l.shape.node.style,"transition","all ".concat(u,"ms ease-in-out")),l.shape.node.style.opacity=0,n?window.setTimeout((function(){l.destroy(),e._surroundHL.delete(t)}),u):(l.destroy(),this._surroundHL.delete(t)))}return this}},{key:"unsurround",value:function(){return this.surround("",!1),this}},{key:"blink",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="blink-".concat(this.uid),r=s.b.CONF_BLINK_COLOR;if(e&&!this._isBlink){this._isBlink=!0;var a=s.f.create(n);a.addStep(this.surround.bind(this,r,!1),t),a.addStep(this.surround.bind(this,r,!1,!1),2*t),a.setCyclic(),a.start()}else!e&&this._isBlink&&(s.f.stop(n),this.surround(r,!1,!1),this._isBlink=!1);this._isBlink=e}},{key:"unblink",value:function(){this.blink(1e3,!1)}},{key:"isBlink",value:function(){return this._isBlink}},{key:"addOverlay",value:function(t){var e,n,r;return this.graph.addCellOverlay(this.mxcell,(e=this.graph.warningImage,n="State: ".concat(t),(r=new mxCellOverlay(e,n)).addListener(mxEvent.CLICK,(function(t,e){mxUtils.alert("".concat(n,"\nLast update: ").concat(new Date))})),r)),this}},{key:"removeOverlay",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.graph.removeCellOverlays(this.mxcell),t.abrupt("return",this);case 2:case"end":return t.stop()}}),t,this)})))}}])&&ut(e.prototype,n),a&&ut(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ht=n(3);function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ft=n(22),pt=["graph_initialized","graph_updated","graph_changed","graph_freed"],vt=function(){function t(e,n,r,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isGraphIniatilized=!1,this._xmlGraph="",this._csvGraph="",this._type="xml",this._graph=void 0,this._scale=!0,this._tooltip=!0,this._lock=!0,this._center=!0,this._AllowDioRessources=!1,this._animation=!0,this._definition="",this._cumulativeZoomFactor=1,this._grid=!1,this._zoomPercent="1",this.events=i.a.create(pt),this.$gf=e,this.uid=s.a.genUid(this.constructor.name),this.container=n,this._type=r,this.xcells=[],this._definition=a,this.init()}var e,n,a;return e=t,a=[{key:"isMxGraphStyle",value:function(t){var e=t;return s.b.MXGRAPH_STYLES.includes(e)}},{key:"isMxGraphAnimStyle",value:function(t){var e=t;return s.b.MXGRAPH_STYLES_ANIM.includes(e)}},{key:"isMxGraphStaticStyle",value:function(t){var e=t;return s.b.MXGRAPH_STYLES_STATIC.includes(e)}},{key:"preview",value:function(t,e){var n=new Graph(t);if(n)try{var r=n.getModel();r.beginUpdate(),r.clear();var a=e.cloneMxCell();n.setTooltips(!1);var i=r.getChildAt(r.getRoot(),0);r.add(i,a),n.updateCssTransform(),n.selectUnlockedLayer(),n.view.rendering=!0,n.setEnabled(!1),n.getModel().endUpdate();var o=2,l=3,u=n.getGraphBounds(),c=n.container.clientWidth-o,h=n.container.clientHeight-o,d=u.width/n.view.scale,f=u.height/n.view.scale,p=Math.min(l,Math.min(c/d,h/f));n.view.scaleAndTranslate(p,(o+c-d*p)/(2*p)-u.x/n.view.scale,(o+h-f*p)/(2*p)-u.y/n.view.scale)}catch(t){s.c.error("Error in preview",t)}}}],(n=[{key:"init",value:function(){return this._eventsConnect(),"xml"===this._type&&(ht.a.isEncoded(this._definition)?this._xmlGraph=ht.a.decode(this._definition):this._xmlGraph=this._definition),"csv"===this._type&&(this._csvGraph=this._definition),ht.a.isInitalized()&&this.init_graph(),this}},{key:"change",value:function(){return this.events.emit("graph_changed",this),this}},{key:"update",value:function(){return this.update_graph(),this.events.emit("graph_updated",this),this}},{key:"clear",value:function(){this.xcells=[]}},{key:"free",value:function(){return s.c.debug("".concat(this.constructor.name,".").concat("free","() : ").concat(this.uid)),this.free_graph(),this.clear(),this.events.emit("graph_freed",this),this._eventsDisconnect(),this.events.clear(),this}},{key:"source",get:function(){return"csv"===this._type?this._csvGraph:this._xmlGraph},set:function(t){"xml"===this._type&&(this._xmlGraph=t),"csv"===this._type&&this._csvGraph===t&&(this._csvGraph=t)}},{key:"_eventsConnect",value:function(){this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),ht.a.events.connect("drawio_initialized",this,this._on_drawio_drawio_initialized.bind(this))}},{key:"_eventsDisconnect",value:function(){this.$gf.events.disconnect("debug_asked",this),ht.a.events.disconnect("drawio_initialized",this)}},{key:"init_graph",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isGraphIniatilized||!ht.a.isInitalized()){t.next=13;break}return this._isGraphIniatilized=!0,t.next=4,this._init_mxGraph();case 4:return this._init_fonts(),t.next=7,this._display();case 7:return t.next=9,this.update_options();case 9:return t.next=11,this._init_xcells();case 11:this.events.emit("graph_initialized"),this.change();case 13:return t.abrupt("return");case 14:case"end":return t.stop()}}),t,this)})))}},{key:"isInitialized",value:function(){return this._isGraphIniatilized}},{key:"_init_mxGraph",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._graph=new Graph(this.container),this._graph.setPanning(!0),this.dioClick=this._graph.click.bind(this._graph),this._graph.click=this._on_xgraph_mxcell_clicked.bind(this),this.dioDbclick=this._graph.dblClick,mxEvent.addMouseWheelListener(mxUtils.bind(this,this.eventMouseWheel),this.container),(mxClient.IS_IE||mxClient.IS_EDGE)&&mxEvent.addListener(this.container,"wheel",mxUtils.bind(this,this.eventMouseWheel)),mxEvent.addListener(document,"keydown",mxUtils.bind(this,this.eventKey)),this.container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._graph.dblClick=this.eventDbClick.bind(this),t.abrupt("return");case 11:case"end":return t.stop()}}),t,this)})))}},{key:"_display",value:function(){if(void 0===this._graph)throw new Error("Graph class was not created");this._graph.getModel().beginUpdate(),this._graph.getModel().clear();try{if("xml"===this._type){var t=mxUtils.parseXml(this._xmlGraph),e=new mxCodec(t);this._graph.model.clear(),this._graph.view.scale=1,e.decode(t.documentElement,this._graph.getModel()),this._init_fonts(),this._graph.updateCssTransform(),this._graph.selectUnlockedLayer()}if("csv"===this._type)try{ft.importCsv(this._graph,this._csvGraph),this.update_graph()}catch(t){s.c.error("Bad CSV format",t),this.$gf.notify("Bad CSV format","error")}}catch(t){s.c.error("Error in draw",t)}finally{this._graph.getModel().endUpdate(),this._init_xcells()}return this}},{key:"_init_xcells",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._graph.getModel(),this.xcells=[],n=Object.values(e.cells),t.abrupt("return",Promise.all(n.map((function(t){return Object(r.a)(a,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ct.refactore(this._graph,t),this.xcells.push(n);case 2:case"end":return e.stop()}}),e,this)})))}))));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_init_fonts",value:function(){var t;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._graph){e.next=2;break}return e.abrupt("return");case 2:if(n=this._graph.getModel(),r=n.extFonts)try{for(r=r.split("|").map((function(t){var e=t.split("^");return{name:e[0],url:e[1]}})),a=0;a<r.length;a++)null===(t=this._graph)||void 0===t||t.addExtFont(r[a].name,r[a].url)}catch(t){s.c.error("ExtFonts format error:",t.message)}return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})))}},{key:"update_options",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isInitialized()){t.next=2;break}return t.abrupt("return",this);case 2:return this.zoomDisplay(),this.enableTooltip(),this.enableLock(),this.scaleDisplay(),this.centerDisplay(),this.gridDisplay(),this.enableDioRessources(),this.enableAnimation(),this._graph.foldingEnabled=!0,this._graph.cellRenderer.forceControlClickHandler=!0,t.abrupt("return");case 13:case"end":return t.stop()}}),t,this)})))}},{key:"update_graph",value:function(){return this.isInitialized()?(this._cumulativeZoomFactor=1,this._graph.zoomActual(),this.update_options(),this._graph.refresh(),this):this}},{key:"free_graph",value:function(){var t;return null===(t=this._graph)||void 0===t||t.destroy(),this._graph=void 0,this}},{key:"enableLock",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._lock;return this._lock=t,this.isInitialized()?(t?this._graph.setEnabled(!1):this._graph.setEnabled(!0),this):this}},{key:"enableTooltip",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._tooltip;return this._tooltip=t,this._isGraphIniatilized?(t?this._graph.setTooltips(!0):this._graph.setTooltips(!1),this):this}},{key:"anonymize",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:ft.anonymize(this._graph);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"enableDioRessources",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._AllowDioRessources;return this._isGraphIniatilized?(this._AllowDioRessources=t,this._isGraphIniatilized?t?(mxUrlConverter.prototype.baseUrl=s.b.CONF_EDITOR_URL,mxUrlConverter.prototype.baseDomain="",this):(mxUrlConverter.prototype.baseUrl=null,mxUrlConverter.prototype.baseDomain=null,this):this):this}},{key:"enableAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._animation;return this._animation=t,this}},{key:"centerDisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._center;return this._center=t,this._isGraphIniatilized?(this._graph.centerZoom=!1,!0===this._center&&(!0===this._scale?this._fitDisplay():this._graph.center(!0,!0)),!1===this._center&&this._graph.center(!1,!1),this):this}},{key:"scaleDisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._scale;return this._scale=t,this._isGraphIniatilized?(!1===this._scale&&this.zoomDisplay(),!0===this._scale?(this._center?this._fitDisplay():(this._graph.fit(),this._graph.zoomActual()),this):this):this}},{key:"_fitDisplay",value:function(){if(!this._isGraphIniatilized)return this;var t=this._graph.getGraphBounds(),e=this._graph.container.clientWidth-2,n=this._graph.container.clientHeight-2,r=t.width/this._graph.view.scale,a=t.height/this._graph.view.scale,i=Math.min(3,Math.min(e/r,n/a));return this._graph.view.scaleAndTranslate(i,(2+e-r*i)/(2*i)-t.x/this._graph.view.scale,(2+n-a*i)/(2*i)-t.y/this._graph.view.scale),this}},{key:"gridDisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._grid;return this._grid=t,this.container.style.backgroundImage=t?"url('data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=')":"",this}},{key:"zoomDisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._zoomPercent;if(this._zoomPercent=t,!this.isInitialized())return this;if(this._scale)this._fitDisplay();else{if(t&&t.length>0&&"100%"!==t&&"0%"!==t){var e=Number(t.replace("%",""))/100;this._graph.zoomTo(e,!0)}this._graph.zoomActual()}return this}},{key:"getMxGraph",value:function(){return this._graph}},{key:"getXCells",value:function(){return this.xcells}},{key:"getXCellValues",value:function(t){var e=[];return this.getXCells().forEach((function(n){return e.push(n.getDefaultValue(t))})),e}},{key:"getXCell",value:function(t){for(var e=this.xcells.length,n=0;n<e;n++){var r=this.xcells[n];if(r.getDefaultValue("id")===t)return r}}},{key:"findXCells",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.getDefaultMapOptions(),n=this.getXCells(),r=[],a=n.length,i=0;i<a;i++){var s=n[i];s.match(t,e)&&r.push(s)}return r}},{key:"highlightXCells",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var i,s=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=this.findXCells(t,e),a.abrupt("return",i.map((function(t){return Object(r.a)(s,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.highlight(n);case 1:case"end":return e.stop()}}),e)})))})));case 2:case"end":return a.stop()}}),a,this)})))}},{key:"unhighlightXCells",value:function(t,e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.highlightXCells(t,e,!1));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"getDefaultValues",value:function(t){return this.getXCellValues(t.identByProp)}},{key:"getDefaultValuesWithKey",value:function(t,e){for(var n=this.getXCells(),r=n.length,a=new Set,i=0;i<r;i++)n[i].getDefaultValues(t).forEach((function(t){null!=t&&t.length>0&&a.add(t)}));return Array.from(a.keys())}},{key:"getXmlModel",value:function(){var t=(new mxCodec).encode(this._graph.getModel());return mxUtils.getXml(t)}},{key:"isAnimated",value:function(){return this._animation}},{key:"setAnimColorCell",value:function(t,e,n){if(this.isAnimated()&&n)try{var r="".concat(e,"-").concat(this.uid,"-").concat(t.uid),a=t.getStyle(e);if(a){for(var i=n,o=lt.a.scale([a,i]).mode("lrgb").colors(s.b.CONF_COLORS_STEPS+1),l=s.f.create(r),u=s.b.CONF_COLORS_MS,c=1;c<o.length;c++)l.addStep(t.setStyle.bind(t,e,o[c]),u*c);l.start()}else{var h=lt()(n).hex();t.setStyle(e,h)}}catch(r){s.c.error("Error on graduate color",r),t.setStyle(e,n)}else{if(null!==n)try{n=lt()(n).hex()}catch(t){s.c.error("Invalid Color",n)}t.setStyle(e,n)}return this}},{key:"setAnimStyleCell",value:function(t,e,n,a){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,l,u,c,h,d,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.isAnimated()&&null!==n)try{if(i=Number(n),o=Number(void 0!==a?a:t.getStyle(e)),i!==o){for(l="".concat(e,"-").concat(this.uid,"-").concat(t.uid),u=s.a.calculateIntervalCounter(o,i,s.b.CONF_ANIMS_STEP),c=u.length,h=s.f.create(l),d=s.b.CONF_ANIMS_MS,f=1;f<c;f++)h.addStep(t.setStyle.bind(t,e,u[f].toString()),d*f);h.start()}}catch(r){this._graph.setCellStyles(e,n,[t])}else t.setStyle(e,n);case 1:case"end":return r.stop()}}),r,this)})))}},{key:"eventDebug",value:function(t){}},{key:"eventDbClick",value:function(t,e){if(void 0!==e){var n=this.getXCell(e.id);n&&this.lazyZoomCell(n)}}},{key:"eventMouseWheel",value:function(t,e){if(this._graph.isZoomWheelEvent(t)){null==e&&(e=t.deltaY<0);var n=this.container.getBoundingClientRect(),r=t.clientX-n.left,a=t.clientY-n.top;this._cumulativeZoomFactor=e?1.2*this._cumulativeZoomFactor:.8*this._cumulativeZoomFactor,this.lazyZoomPointer(this._cumulativeZoomFactor,r,a),mxEvent.consume(t)}}},{key:"eventKey",value:function(t){mxEvent.isConsumed(t)||27!==t.keyCode||this.update_graph()}},{key:"lazyZoomCenter",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._graph.zoomTo(t,!0);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"lazyZoomPointer",value:function(t,e,n){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var a,i,s,o,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=2*e,i=2*n,t=Math.max(.01,Math.min(this._graph.view.scale*t,160))/this._graph.view.scale,t=this._cumulativeZoomFactor/this._graph.view.scale,s=Math.round(this._graph.view.scale*t*100)/100,(t=s/this._graph.view.scale)>1?(a*=-(o=(t-1)/(2*s)),i*=-o):(l=(1/t-1)/(2*this._graph.view.scale),a*=l,i*=l),this._graph.view.scaleAndTranslate(s,this._graph.view.translate.x+a,this._graph.view.translate.y+i);case 8:case"end":return r.stop()}}),r,this)})))}},{key:"highlightCells",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getXCells();return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=0;n<t.length;n++)t[n].highlight();case 1:case"end":return e.stop()}}),e)})))}},{key:"unhighlightCells",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getXCells();return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=0;n<t.length;n++)t[n].highlight(!1);case 1:case"end":return e.stop()}}),e)})))}},{key:"setAnimZoomCell",value:function(t,e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,a,i,o,l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isAnimated()){for(r="setAnimZoomCell-".concat(this.uid).concat(t.getId),a=s.a.calculateIntervalCounter(t.percent,e,s.b.CONF_ANIMS_STEP),i=s.f.create(r),o=a.length,l=s.b.CONF_ANIMS_MS,u=1;u<o;u++)i.addStep(t.zoom.bind(t,a[u]),l*u);i.start()}else t.zoom(e);case 1:case"end":return n.stop()}}),n,this)})))}},{key:"setAnimSizeCell",value:function(t,e,n){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var a,i,o,l,u,c,h,d,f,p;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=t.getDimension(),i=void 0!==e&&e>=0?1:-1,o=void 0!==n&&n>=0?1:-1,e=void 0!==e?e:void 0,n=void 0!==n?n:void 0,this.isAnimated()){for(l="setAnimSizeCell-".concat(this.uid,"-").concat(t.getId()),u=s.a.calculateIntervalCounter(a.width*i,e,s.b.CONF_ANIMS_STEP),c=s.a.calculateIntervalCounter(a.height*o,n,s.b.CONF_ANIMS_STEP),h=u.length,d=s.f.create(l),f=s.b.CONF_ANIMS_MS,p=1;p<h;p++)d.addStep(t.resize.bind(t,u[p],c[p]),f*p);d.start()}else t.resize(e,n);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"lazyZoomCell",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isVertex()&&null!==(n=t.getMxCellState())&&(r=void 0!==n.width&&n.width>0&&void 0!==n.height&&n.height>0?n.shape.bounds:n.text.boundingBox,this._graph.zoomToRect(r),this._cumulativeZoomFactor=this._graph.view.scale);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.constructor.name}},{key:"_on_drawio_drawio_initialized",value:function(){this.constructor.name,this.init_graph()}},{key:"_on_xgraph_mxcell_clicked",value:function(t){this.constructor.name,this.dioClick(t);var e=t.getState();if(e){var n=this.getXCell(e.cell.id);this.$gf.events.emit("xcell_clicked",n)}}}])&&dt(e.prototype,n),a&&dt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}yt.$inject=["$q","uiSegmentSrv"];var mt=function(){function t(e,n,r){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.enable=!1,this.indexTable=0,this.pressed=!1,this.startX=0,this.startWidth=0;var i=0;this.statesTableData={data:this.getStates(),columns:[{index:i++,id:"expand",label:"<>",desc:"Show/Hide detail",width:"30px",sort:"asc",select:!1},{index:i++,id:"id",label:"ID",desc:"Uniq Id",width:"100px",sort:"asc",select:!1},{index:i++,id:"label",label:"Label",desc:"Text/Label",width:"100px",sort:"asc",select:!1},{index:i++,id:"shape",label:"Shape",desc:"Draw.io shape model",width:"100px",sort:"asc",select:!1},{index:i++,id:"level",label:"Lvl",desc:"Current level",width:"45px",sort:"asc",select:!1},{index:i++,id:"rval",label:"R.Val.",desc:"Raw value",width:"80px",sort:"asc",select:!1},{index:i++,id:"fval",label:"F.Val.",desc:"Formated value",width:"80px",sort:"asc",select:!1},{index:i++,id:"colors",label:"Colors",desc:"Shape ID",width:"80px",sort:"asc",select:!1},{index:i++,id:"tags",label:"Tags",desc:"Tags",width:"100px",sort:"asc",select:!1}]},e.editor=this;var o=n.find("#templateInspect");this.parentDiv=o[0];var l=o.find("#StatesTable")[0];this.statesTable=new s.e(this.statesTableData,l),this.ctrl=e.ctrl,e.GFPlugin=this.ctrl.GFPlugin,e.$GF=this.ctrl.$gf,this.$sce=r,this.$gf=this.ctrl.$gf,this.flowchartHandler=this.ctrl.flowchartHandler,this.stateHandler=null===(a=this.flowchartHandler)||void 0===a?void 0:a.getFlowchart().getStateHandler()}var e,n,r;return t.$inject=["$scope","$element","$sce"],e=t,(n=[{key:"initPreview",value:function(t){var e=document.getElementById("preview-".concat(t.xcell.getId()));return null!==e&&(e.innerHTML="",vt.preview(e,t.getXCell())),!0}},{key:"renderStyles",value:function(t){var e=this,n='<div class="gf-table-content" style="text-align: center;">';return["fontColor","fillColor","strokeColor"].forEach((function(r){n="".concat(n,'\n\n      <div style="display:table-cell;vertical-align:middle;">\n        ').concat(e.renderStyle(t,r),"\n      </div>\n      ")})),n+="</div>",this.$sce.trustAsHtml(n)}},{key:"renderStyle",value:function(t,e){var n,r,a=t.getStatus(e),i="";if(!(t.haveStatus(e)&&a.length>0&&"none"!==a))return this.$sce.trustAsHtml(i);switch(e){case"fillColor":n="F",r="Fill color";break;case"strokeColor":n="S",r="Border/stroke color";break;case"fontColor":n="T",r="Text/Font color"}return i='\n      <div title="'.concat(r," : ").concat(a,'"\n          class="gf-inspect-color-picker"\n          style="background-color: ').concat(a,';">\n          <span>').concat(n,"</span>\n      </div>\n    "),this.$sce.trustAsHtml(i)}},{key:"getStates",value:function(){if(this.stateHandler){var t=this.stateHandler.getStatesForInspect();return Object(o.orderBy)(t,["cellId","globalLevel"],["asc"])}return[]}},{key:"anonymize",value:function(){var t,e=null===(t=this.flowchartHandler)||void 0===t?void 0:t.getFlowchart(),n=null==e?void 0:e.getXGraph();n&&n.anonymize()}}])&&gt(e.prototype,n),r&&gt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yt(t,e){return{restrict:"E",scope:!0,templateUrl:"".concat(s.d.getPartialPath(),"inspect/inspectTab.html"),controller:mt}}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _t=["rule_created","rule_updated","rule_changed","rule_deleted"],wt=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.activeRuleIndex=0,this.events=i.a.create(_t),this.$gf=e,this.$gf.rulesHandler=this,this.uid=s.a.genUid(this.constructor.name),this.rules=[],this.data=n,r&&this._convert(r),this.init()}var e,n,a;return e=t,a=[{key:"getDefaultData",value:function(){return{rulesData:[P.getDefaultData()]}}}],(n=[{key:"clear",value:function(){return s.c.debug(this.constructor.name+".clear()"),this.rules.forEach((function(t){return t.clear()})),this.rules=[],this.data.rulesData=[],this}},{key:"init",value:function(){return s.c.debug(this.constructor.name+".init()"),this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),this.$gf.events.connect("panel_closed",this,this._on_global_panel_closed.bind(this)),this}},{key:"update",value:function(){return s.c.debug(this.constructor.name+".refresh()"),this.rules.forEach((function(t){return t.update()})),this}},{key:"change",value:function(){return s.c.debug(this.constructor.name+".change()"),this.rules.forEach((function(t){return t.change()})),this}},{key:"free",value:function(){return s.c.debug(this.constructor.name+".free()"),this.$gf.events.disconnect("debug_asked",this),this.$gf.events.disconnect("panel_closed",this),this.rules.forEach((function(t){return t.free()})),this.clear(),this.events.clear(),this.$gf.rulesHandler=void 0,this}},{key:"setData",value:function(t){return this.data=t,this}},{key:"_convert",value:function(t){var e=this;s.c.info("RuleHandler.import()"),this.clear();var n,a=1;return null!=t&&((n=Array.isArray(t)?t:t.rulesData).length>0&&void 0!==n[0].order&&(n=Object(o.sortBy)(Object(o.sortBy)(n,(function(t){return t.order})))),n.map((function(t){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.addRule("",t)).setOrder(a),a+=1,this.events.emit("rule_created",n);case 4:case"end":return e.stop()}}),e,this)})))}))),this.change(),this}},{key:"getRules",value:function(){return this.rules}},{key:"getRule",value:function(t){if("number"==typeof t)return this.rules[t];for(var e=0;e<this.rules.length;e++){var n=this.rules[e];if(t===n.name)return n}return null}},{key:"addRule",value:function(t,e){var n=P.getDefaultData(),r=new P(this.$gf,t,n,e);return this.rules.push(r),this.data.rulesData.push(n),r.setOrder(this.countRules()),r.events.connect("rule_updated",this,this._on_rule_rule_updated.bind(this)),r.events.connect("rule_changed",this,this._on_rule_rule_changed.bind(this)),r}},{key:"countRules",value:function(){return void 0!==this.rules&&Array.isArray(this.rules)?this.rules.length:0}},{key:"setOrder",value:function(){for(var t=this.rules.length,e=0;e<t;e++)this.rules[e].setOrder(e+1);return this}},{key:"removeRule",value:function(t){s.c.debug(this.constructor.name+".removeRule()",t),t.events.disconnect("rule_updated",this),t.events.disconnect("rule_changed",this);var e=t.getOrder()-1;return t.free(),this.rules.splice(e,1),this.data.rulesData.splice(e,1),this.setOrder(),this}},{key:"cloneRule",value:function(t){s.c.debug(this.constructor.name+".cloneRule()",t);var e=t.getOrder()-1,n=t.getData(),r=P.getDefaultData();this.reduce();var a=new P(this.$gf,r.pattern,r,n);return r.alias="Copy of ".concat(r.alias),this.rules.splice(e,0,a),this.data.rulesData.splice(e,0,r),a.data.reduce=!1,this.activeRuleIndex=e,this.setOrder(),s.a.setFocus(a.uid),a}},{key:"reduce",value:function(){return this.getRules().forEach((function(t){t.reduce=!0})),this}},{key:"moveRuleToUp",value:function(t){var e=t.getOrder()-1,n=this.rules,r=n.length-1;if(0!==e&&0!==r){var a=n[e];a.setOrder(e);var i=n[e-1];i.setOrder(e+1),n[e-1]=a,n[e]=i}}},{key:"moveRuleToDown",value:function(t){var e=t.getOrder()-1,n=this.rules,r=n.length-1;if(e!==r&&0!==r){var a=n[e];a.setOrder(e+2);var i=n[e+1];i.setOrder(e+1),n[e+1]=a,n[e]=i}}},{key:"_on_rule_rule_updated",value:function(t){this.constructor.name,this.events.emit("rule_updated",t)}},{key:"_on_rule_rule_changed",value:function(t){this.constructor.name,this.events.emit("rule_changed",t)}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.constructor.name}},{key:"_on_global_panel_closed",value:function(){this.free()}}])&&bt(e.prototype,n),a&&bt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),kt=n(9),xt=n.n(kt);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ct(t);if(e){var a=Ct(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Mt(this,n)}}function Mt(t,e){if(e&&("object"===Et(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function At(t,e,n){return e&&Dt(t.prototype,e),n&&Dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Lt=function(){function t(){Rt(this,t),this.timeFormat="YYYY-MM-DD HH:mm:ss",this.checked=!1,this.metadata=null,this.div=null,this.checked=!1,this.metrics=new Set}return At(t,[{key:"isChecked",value:function(){return this.checked}},{key:"addMetric",value:function(){this.checked=!0;var t=new Pt;return this.metrics.add(t),t}},{key:"addMetadata",value:function(){return this.checked=!0,this.metadata=new Ft,this.metadata}},{key:"updateDate",value:function(){this.lastChange=s.a.getCurrentDate()}},{key:"destroy",value:function(){this.metrics.clear()}},{key:"getDiv",value:function(t){if(null!==this.div&&void 0!==this.div)return t&&this.div&&t.appendChild(this.div),this.div;if(!this.checked)return null;var e=document.createElement("div");return void 0!==t&&t.appendChild(e),this.metrics.size>0&&(this.getDateDiv(e),this.metrics.forEach((function(t){t.getDiv(e)}))),void 0!==this.metadata&&null!==this.metadata&&this.metadata.getDiv(e),this.div=e,e}},{key:"getDateDiv",value:function(t){var e=document.createElement("div");return void 0!==t&&t.appendChild(e),e.className="graph-tooltip-time tooltip-date",e.innerHTML="".concat(this.lastChange),e}}]),t}(),Pt=function(){function t(){Rt(this,t),this.direction="v",this.color="#8c8980",this.graphs=new Set,this.label="",this.value=""}return At(t,[{key:"setLabel",value:function(t){return this.label=t,this}},{key:"setValue",value:function(t){return this.value=t,this}},{key:"setColor",value:function(t){return null!==t&&(this.color=t),this}},{key:"setDirection",value:function(t){return this.direction=t,this}},{key:"getDiv",value:function(t){var e=document.createElement("div");return e.className="tooltip-metric","h"===this.direction&&(e.style.display="inline-block"),void 0!==t&&t.appendChild(e),this.div=e,this.getTextDiv(e),this.getGraphsDiv(e),e}},{key:"getTextDiv",value:function(t){var e=document.createElement("div");e.className="tooltip-text";var n="";return void 0!==t&&t.appendChild(e),void 0!==this.label&&(n+="".concat(this.label," : "),n+='<span style="color:'.concat(this.color,'"><b>').concat(this.value,"</b></span>")),e.innerHTML=n,e}},{key:"getGraphsDiv",value:function(t){var e=document.createElement("div");return void 0!==t&&t.appendChild(e),this.graphs.size>0&&this.graphs.forEach((function(t){t.getDiv(e)})),e}},{key:"addGraph",value:function(t){var e;switch(t){case"line":e=new It;break;case"bar":e=new Ht;break;default:s.c.error("Graph type unknow",t),e=new Ht}return this.graphs.add(e),e}}]),t}(),Nt=function(){function t(){Rt(this,t),this.color="#8c8980",this.type="line",this.data={series:[{data:[{x:0,y:0}]}]},this.size="100%",this.low=null,this.high=null,this.scaleType="linear"}return At(t,[{key:"getDiv",value:function(t){return this.div}},{key:"setName",value:function(t){return this.name=t,this}},{key:"setColumn",value:function(t){return this.column=t,this}},{key:"setType",value:function(t){return this.type=t,this}},{key:"setSize",value:function(t){return this.size=t,this}},{key:"setMetric",value:function(t){return this.metric=t,this}},{key:"setScaling",value:function(t,e){return this.low=t,this.high=e,this}},{key:"setScale",value:function(t){this.scaleType=t}},{key:"setColor",value:function(t){return null!==t&&(this.color=t),this}},{key:"setParentDiv",value:function(t){return this.parentDiv=t,this}},{key:"getChart",value:function(){return this.chart}}]),t}(),It=function(t){Tt(n,t);var e=Ot(n);function n(){var t;return Rt(this,n),(t=e.call(this)).type="line",t.chartistOptions={showPoint:!1,showLine:!0,showArea:!0,fullWidth:!0,axisX:{showGrid:!1,showLabel:!1,offset:0},axisY:{showGrid:!1,showLabel:!1,offset:0},chartPadding:{top:0,left:0,right:0,bottom:0}},t}return At(n,[{key:"getDiv",value:function(t){if(this.metric){var e="log"===this.scaleType;this.data.series[0].data=this.metric.getData(this.column,e)}var n=document.createElement("div"),r=this.color;return this.div=n,void 0!==t&&t.appendChild(n),n.className="ct-chart ct-golden-section",null!==this.size&&(n.style.width=this.size),null!==this.low&&(this.chartistOptions.low=this.low),null!==this.high&&(this.chartistOptions.high=this.high),this.chart=new xt.a.Line(n,this.data,this.chartistOptions),this.chart.on("draw",(function(t){"line"!==t.type&&"area"!==t.type||("line"===t.type&&t.element.attr({style:"stroke: ".concat(r)}),"area"===t.type&&t.element.attr({style:"fill: ".concat(r)}),t.element.animate({d:{begin:1e3*t.index,dur:1e3,from:t.path.clone().scale(1,0).translate(0,t.chartRect.height()).stringify(),to:t.path.clone().stringify(),easing:xt.a.Svg.Easing.easeOutQuint}}))})),n}}]),n}(Nt),Ht=function(t){Tt(n,t);var e=Ot(n);function n(){var t;return Rt(this,n),(t=e.call(this)).type="bar",t.chartistOptions={axisX:{showGrid:!1,showLabel:!1,offset:0},axisY:{showGrid:!1,showLabel:!1,offset:0},chartPadding:{top:0,left:0,right:0,bottom:0}},t}return At(n,[{key:"getDiv",value:function(t){if(this.metric){var e="log"===this.scaleType;this.data.series[0].data=this.metric.getData(this.column,e)}var n=document.createElement("div"),r=this.color;this.div=n,void 0!==t&&t.appendChild(n),n.className="ct-chart ct-golden-section",null!==this.size&&(n.style.width=this.size),null!==this.low&&(this.chartistOptions.low=this.low),null!==this.high&&(this.chartistOptions.high=this.high),this.chart=new xt.a.Bar(n,this.data,this.chartistOptions);var a=0,i=this.data.series[0].data.length,s=Math.round(50/(i/10)),o=Math.round(250/(i/10));return this.chart.on("draw",(function(t){"bar"===t.type&&(t.element.attr({style:"stroke: ".concat(r)}),a++,t.element.animate({opacity:{begin:a*s,dur:o,from:0,to:1,easing:"ease"}}))})),n}}]),n}(Nt),Ft=function(){function t(){Rt(this,t),this.enableMetadata=!0,this.div=void 0,this.xcell=void 0}return At(t,[{key:"setXCell",value:function(t){return this.xcell=t,this}},{key:"getDiv",value:function(t){var e=document.createElement("div");(e.className="tooltip-metric",this.div=e,void 0!==t&&t.appendChild(e),void 0!==this.xcell)&&this.xcell.getMetadatas().forEach((function(t,n,r){if(null!=n&&n.length>0&&null!=t&&t.length>0){var a=document.createElement("div");a.innerHTML="".concat(n," : <b>").concat(mxUtils.htmlEntities(t),"</b>"),e.appendChild(a)}}));return e}}]),t}();function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(){return(Vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ut(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function Ut(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yt(t)););return t}function jt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yt(t);if(e){var a=Yt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return $t(this,n)}}function $t(t,e){if(e&&("object"===zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zt(t,e,n){return e&&Wt(t.prototype,e),n&&Wt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var qt=["state_initialized","state_updated","state_freed"],Kt=function(){function t(e,n,r){Xt(this,t),this.changed=!1,this.matched=!1,this.globalLevel=-1,this.highestFormattedValue="",this.highestValue=void 0,this.tooltipHandler=null,this.reduce=!0,this._rules=new Map,this.currRules=[],this.currMetrics=[],this.events=i.a.create(qt),this.$gf=e,this.uid=s.a.genUid(this.constructor.name),this.xcell=n,this.shapeState=new ne(r,n),this.tooltipState=new re(r,n),this.iconState=new ae(r,n),this.eventState=new Qt(r,n),this.textState=new te(r,n),this.linkState=new ee(r,n),this._ObjStates=[this.shapeState,this.tooltipState,this.iconState,this.eventState,this.textState,this.linkState],this._variables=s.g.create(),this._status=new Map,this.tooltipHandler=null,this.init()}return Zt(t,[{key:"init",value:function(){var t,e,n,r;return this._initCycle(),this.$gf.events.connect("data_updated",this,this._on_global_data_received.bind(this)),this.$gf.events.connect("data_processed",this,this._on_global_data_processed.bind(this)),null===(t=this.$gf.rulesHandler)||void 0===t||t.events.connect("rule_changed",this,this._on_ruleHandler_rule_changed.bind(this)),null===(e=this.$gf.rulesHandler)||void 0===e||e.events.connect("rule_updated",this,this._on_ruleHandler_rule_updated.bind(this)),null===(n=this.$gf.rulesHandler)||void 0===n||n.events.connect("rule_created",this,this._on_ruleHandler_rule_created.bind(this)),null===(r=this.$gf.rulesHandler)||void 0===r||r.events.connect("rule_deleted",this,this._on_ruleHandler_rule_deleted.bind(this)),this.events.emit("state_initialized",this),this}},{key:"update",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._initCycle();case 2:return t.next=4,this._setCycle();case 4:return this._applyCycle(),this.events.emit("state_updated",this),t.abrupt("return");case 7:case"end":return t.stop()}}),t,this)})))}},{key:"change",value:function(){return this}},{key:"clear",value:function(){return this.currMetrics=[],this.currRules=[],this}},{key:"free",value:function(){var t,e,n,a;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.clear(),this.reset(),this.$gf.events.disconnect("data_updated",this),this.$gf.events.disconnect("data_processed",this),null===(t=this.$gf.rulesHandler)||void 0===t||t.events.disconnect("rule_updated",this),null===(e=this.$gf.rulesHandler)||void 0===e||e.events.disconnect("rule_changed",this),null===(n=this.$gf.rulesHandler)||void 0===n||n.events.disconnect("rule_created",this),null===(a=this.$gf.rulesHandler)||void 0===a||a.events.disconnect("rule_deleted",this),this.events.clear(),r.next=11,this.events.emit("state_freed",this);case 11:case"end":return r.stop()}}),r,this)})))}},{key:"getXCell",value:function(){return this.xcell}},{key:"getLevel",value:function(){return this.globalLevel}},{key:"_setCycle",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"setCycle",s.c.debug("".concat(this.constructor.name,".").concat("setCycle","() : ").concat(this.uid)),(void 0===t?Array.from(this._rules.values()):[t]).forEach((function(t){var e=Date.now();if(!t.hidden){var r=t.getShapeMaps(),a=t.getTextMaps(),i=t.getLinkMaps(),o=t.getEventMaps();n._variables.set(s.b.VAR_STR_RULENAME,t.data.alias),Array.from(t.getMetrics().values()).forEach((function(e){try{n.currMetrics.push(e.getName()),n._variables.set(s.b.VAR_STR_METRIC,e.getName)}catch(t){s.c.error(t)}var l=t.getValueForMetric(e),u=t.getFormattedValue(l),c=t.getThresholdLevel(l),h=t.getThresholdColor(l);n._variables.set(s.b.VAR_NUM_VALUE,l),n._variables.set(s.b.VAR_STR_FORMATED,u),n._variables.set(s.b.VAR_NUM_LEVEL,c),n._variables.set(s.b.VAR_STR_COLOR,h),n._variables.set(s.b.VAR_STR_DATE,s.a.getCurrentDate());var d=!1,f=t.getShapeMapOptions(),p=n.xcell.getDefaultValues(f);r.forEach((function(r){var a=r.data.style;if(!r.hidden&&r.match(p,f,n._variables)){var i=h;r.isEligible(c)&&(d=!0,n.matched=!0,n.shapeState.set(a,i,c)&&n._status.set(a,i)),t.toTooltipize(c)&&(a="tooltip",i=!0,n.tooltipState.set("tooltip",!0,c)&&n._status.set(a,i),n.tooltipState.setTooltip(t,e,h,u,n.xcell.getMetadatas())),t.toIconize(c)&&(a="icon",i=!0,n.iconState.set("icon",!0,c)&&n._status.set(a,i))}})),f=t.getTextMapOptions(),p=n.xcell.getDefaultValues(f),a.forEach((function(t){var e="label";if(!t.hidden&&t.match(p,f,n._variables)&&t.isEligible(c)){d=!0,n.matched=!0;var r=n._variables.replaceText(u),a=t.getReplaceText(n.textState.getMatchValue(e),r);n.textState.set(e,a,c)&&n._status.set(e,a)}})),f=t.getEventMapOptions(),p=n.xcell.getDefaultValues(f),o.forEach((function(t){var e=t.data.style;if(!t.hidden&&t.match(p,f,n._variables)&&t.isEligible(c)){d=!0,n.matched=!0;var r=n._variables.eval(t.data.value);n.eventState.set(e,r,c)&&n._status.set(e,r)}})),f=t.getEventMapOptions(),p=n.xcell.getDefaultValues(f),i.forEach((function(t){var e="link";if(!t.hidden&&t.match(p,f,n._variables)&&t.isEligible(c)){d=!0,n.matched=!0;var r=n._variables.replaceText(t.getLink());n.linkState.set(e,r,c)&&n._status.set(e,r)}})),d&&(n.currRules.push(t.data.alias),c>n.globalLevel&&(n.globalLevel=c,n.highestValue=l,n.highestFormattedValue=u),c>=t.highestLevel&&(t.highestLevel=c,t.highestValue=l,t.highestFormattedValue=u,t.highestColor=h))}))}var l=Date.now();t.execTimes+=l-e})),e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})))}},{key:"_unsetState",value:function(){return this.eventState.unset(),this.textState.unset(),this.linkState.unset(),this.tooltipState.unset(),this.iconState.unset(),this.matched=!1,this}},{key:"getTextLevel",value:function(){return-1===this.globalLevel?"":this.globalLevel.toString()}},{key:"getStatus",value:function(t){var e=this._status.get(t);return null!=e||(null===(e=this.xcell.getStyle(t))&&(e=""),this._status.set(t,e)),e}},{key:"haveStatus",value:function(t){return this._status.has(t)}},{key:"isShape",value:function(){return this.xcell.getMxCell().isVertex()}},{key:"isConnector",value:function(){return this.xcell.getMxCell().isEdge()}},{key:"getShapeName",value:function(){if(this.xcell){var t=this.xcell.getStyle("shape");return null===t?"":t}return"Unknown"}},{key:"getShapeStyles",value:function(){return this.xcell?this.xcell.getMxCell().style:"Unknown"}},{key:"_applyCycle",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("applyCycle",s.c.debug("".concat(this.constructor.name,".").concat("applyCycle","() : ").concat(this.uid)),!this.matched&&!this.changed){t.next=5;break}return this.changed=!0,t.abrupt("return",this._ObjStates.map((function(t){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.apply();case 1:case"end":return e.stop()}}),e)})))})));case 5:return t.abrupt("return");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"reset",value:function(){var t=this;return this._ObjStates.map((function(e){return Object(r.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.reset();case 1:case"end":return t.stop()}}),t)})))})),this._variables.clear(),this._status.clear(),this.globalLevel=-1,this.highestFormattedValue="",this.highestValue=void 0,this.changed=!1,this}},{key:"_initCycle",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("initCycle",s.c.debug("".concat(this.constructor.name,".").concat("initCycle","() : ").concat(this.uid)),!this.changed){t.next=13;break}return t.next=5,Promise.all(this._ObjStates.map((function(t){return Object(r.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.prepare();case 1:case"end":return e.stop()}}),e)})))})));case 5:this._variables.clear(),this._status.clear(),this.globalLevel=-1,this.highestFormattedValue="",this.currMetrics=[],this.currRules=[],this.highestValue=void 0,this.matched=!1;case 13:return t.abrupt("return",this);case 14:case"end":return t.stop()}}),t,this)})))}},{key:"highlightCell",value:function(){return this.xcell.highlight(),this}},{key:"unhighlightCell",value:function(){return this.xcell.highlight(!1),this}},{key:"_matchRule",value:function(t){var e=t.getShapeMapOptions(),n=this.xcell.getDefaultValues(e);return!!t.matchShape(n,e)||(e=t.getTextMapOptions(),n=this.xcell.getDefaultValues(e),!!t.matchText(n,e)||(e=t.getLinkMapOptions(),n=this.xcell.getDefaultValues(e),!!t.matchLink(n,e)||(e=t.getEventMapOptions(),n=this.xcell.getDefaultValues(e),!!t.matchEvent(n,e))))}},{key:"_updateRule",value:function(t){return null!=t&&(this._matchRule(t)?this._rules.set(t.uid,t):this._rules.delete(t.uid)),this}},{key:"_haveRule",value:function(t){return this._rules.has(t.uid)}},{key:"removeRule",value:function(t){return null!=t&&this.hasRule(t)&&(this._rules.delete(t.uid),this.change()),this}},{key:"hasRule",value:function(t){return!!t&&this._rules.has(t.uid)}},{key:"_on_global_data_received",value:function(){this.constructor.name}},{key:"_on_global_data_processed",value:function(){this.constructor.name,this.update()}},{key:"_on_ruleHandler_rule_changed",value:function(t){this.constructor.name,(this._haveRule(t)||this._matchRule(t))&&(this._updateRule(t),this.update())}},{key:"_on_ruleHandler_rule_updated",value:function(t){this.constructor.name,this._updateRule(t)}},{key:"_on_ruleHandler_rule_created",value:function(t){this.constructor.name,this._updateRule(t)}},{key:"_on_ruleHandler_rule_deleted",value:function(t){this.constructor.name,this.removeRule(t)}}]),t}(),Jt=function(){function t(e,n){Xt(this,t),this.keys=[],this.matchedKey=new Map,this.ackKey=new Set,this.changedKey=new Map,this.defaultValue=new Map,this.matchValue=new Map,this.matchLevel=new Map,this.xgraph=e,this.xcell=n,this.init_core()}return Zt(t,[{key:"init_core",value:function(){}},{key:"addValue",value:function(e,n){this.hasKey(e)||this.keys.push(e),this.defaultValue.set(e,n),this.matchValue.set(e,n),this.matchLevel.set(e,t.DEFAULTLEVEL),this.matchedKey.set(e,!1),this.changedKey.set(e,!1)}},{key:"hasKey",value:function(t){return this.keys.includes(t)}},{key:"getDefaultValue",value:function(t){return this.hasKey(t)||this.defaultValue.set(t,this.default_core(t)),this.defaultValue.get(t)}},{key:"getMatchValue",value:function(t){return this.hasKey(t)||this.matchValue.set(t,this.getDefaultValue(t)),this.matchValue.get(t)}},{key:"getTargetValue",value:function(t){return this.isMatched(t)?this.getMatchValue(t):this.isChanged(t)?this.getDefaultValue(t):void 0}},{key:"ack",value:function(t){return void 0!==t&&(this.isMatched(t)?(this.matchedKey.set(t,!1),this.changedKey.set(t,!0)):this.isChanged(t)&&(this.matchedKey.set(t,!1),this.changedKey.set(t,!1)),this.ackKey.add(t)),this}},{key:"isAcked",value:function(t){return this.ackKey.has(t)}},{key:"set",value:function(t,e,n){var r=this.matchLevel.get(t);if(void 0===r){var a=this.default_core(t);return this.addValue(t,a),this.set(t,e,n)}return r<=n&&(this.matchLevel.set(t,n),this.matchedKey.set(t,!0),this.matchValue.set(t,e),!0)}},{key:"apply",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t)if(this.isMatched(t)&&!this.isAcked(t)){n=this.getMatchValue(t);try{this.apply_core(t,n)}catch(e){s.c.error("Error on reset for key "+t,e)}this.ack(t)}else this.isChanged(t)&&!this.isAcked(t)&&(this.reset(t),this.ack(t));else this.keys.forEach((function(t){r.apply(t)}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"default_core",value:function(t){return null}},{key:"apply_core",value:function(t,e){}},{key:"isMatched",value:function(t){var e=this;if(void 0!==t)return!0===this.matchedKey.get(t);var n=!1;return this.keys.forEach((function(t){n=e.isMatched(t)||n})),n}},{key:"isChanged",value:function(t){var e=this;if(void 0!==t)return!0===this.changedKey.get(t);var n=!1;return this.keys.forEach((function(t){n=!!e.isChanged(t)||n})),n}},{key:"getLevel",value:function(e){var n=this;if(void 0!==e){var r=this.matchLevel.get(e);return void 0!==r?r:t.DEFAULTLEVEL}var a=t.DEFAULTLEVEL;return this.keys.forEach((function(t){a=Math.max(n.getLevel(t),a)})),a}},{key:"unset",value:function(t){var e=this;return void 0!==t?(this.matchValue.set(t,this.defaultValue.get(t)),this.matchedKey.set(t,!1),this.matchLevel.set(t,-1)):this.keys.forEach((function(t){e.unset(t)})),this}},{key:"reset",value:function(t){var e=this;if(void 0!==t){this.unset(t);var n=this.getDefaultValue(t);try{this.reset_core(t,n)}catch(e){s.c.error("Error on reset for key "+t,e)}this.changedKey.set(t,!1),this.matchedKey.set(t,!1)}else this.keys.forEach((function(t){e.reset(t)}));return this}},{key:"reset_core",value:function(t,e){}},{key:"prepare",value:function(){return this.ackKey.clear(),this.isChanged()&&this.unset(),this}}]),t}();Jt.DEFAULTLEVEL=-1;var Qt=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=[],a.geo=void 0,a.init_core(),a}return Zt(n,[{key:"init_core",value:function(){this.geo=this.xcell.getDefaultDimension()}},{key:"default_core",value:function(t){return this._get(t)}},{key:"apply_core",value:function(t,e){void 0===e&&(e=null),this._set(t,e)}},{key:"reset_core",value:function(t,e){void 0===e&&(e=null),this._set(t,e)}},{key:"_set",value:function(t,e){switch(void 0!==e&&"null"!==e||(e=null),t){case"class":throw new Error("Class not implemented");case"text":e=String(e),this.xcell.setLabel(e);break;case"tpMetadata":if(null!==e){var n=String(e).split("@");if(n.length>0){var r=n.shift(),a=null;n.length>0&&(a=n.join("@")),this.xcell.setMetadata(r,a)}}break;case"tpText":null!=e&&0!==e.length&&"null"!==e||(e=null),this.xcell.setMetadata("tooltip",e);break;case"visibility":"0"===(e=String(e))?this.xcell.hide():"1"===e&&this.xcell.hide(!1);break;case"fold":"0"===(e=String(e))?this.xcell.collapse(!0):"1"===e&&this.xcell.collapse(!1);break;case"height":if(void 0!==e){var i=Number(e),s=this.getTargetValue("width");this.ack("width"),this.xgraph.setAnimSizeCell(this.xcell,s,i)}break;case"width":if(void 0!==e){var o=Number(e),l=this.getTargetValue("height");this.ack("height"),this.xgraph.setAnimSizeCell(this.xcell,o,l)}break;case"size":if(void 0!==this.geo){var u=Number(e);this.xgraph.setAnimZoomCell(this.xcell,u)}break;case"blink":e?this.xcell.blink(e):this.xcell.blink(e,!1);break;default:var c=t;if(vt.isMxGraphAnimStyle(t)){var h=this._get(c);h=void 0===h?K.getDefaultValue(c):h,this.xgraph.setAnimStyleCell(this.xcell,c,e,h)}else{if(!vt.isMxGraphStyle(c))throw new Error("Unknow type ".concat(c));this.xcell.setStyle(c,e)}}}},{key:"_get",value:function(t){switch(t){case"text":return this.xcell.getLabel();case"visibility":return!this.xcell.isHidden;case"height":return void 0!==this.geo?this.geo.height:void 0;case"width":return void 0!==this.geo?this.geo.width:void 0;case"tpText":return this.xcell.getMetadata("tooltip");case"tpMetadata":return null;case"size":return 100;case"fold":return!0===this.xcell.isCollapsed()?"0":"1";case"blink":return this.xcell.isBlink;default:if(vt.isMxGraphStyle(t)){var e=t;return this.xcell.getStyle(e)}throw new Error("Unknow type ".concat(t))}}}]),n}(Jt),te=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=[],a.init_core(),a}return Zt(n,[{key:"init_core",value:function(){}},{key:"default_core",value:function(t){return this.xcell.getLabel()}},{key:"apply_core",value:function(t,e){this.xcell.setLabel(e)}},{key:"reset_core",value:function(t,e){this.xcell.restoreLabel()}}]),n}(Jt),ee=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=[],a.init_core(),a}return Zt(n,[{key:"init_core",value:function(){}},{key:"default_core",value:function(t){return this.xcell.getDefaultLink()}},{key:"apply_core",value:function(t,e){this.xcell.setLink(e)}},{key:"reset_core",value:function(t,e){this.xcell.restoreLink()}}]),n}(Jt),ne=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=[],a.init_core(),a}return Zt(n,[{key:"init_core",value:function(){this.xcell.enableTooltip(!1)}},{key:"default_core",value:function(t){return this.xcell.getDefaultStyle(t)}},{key:"apply_core",value:function(t,e){void 0===e&&(e=null),this.xgraph.setAnimColorCell(this.xcell,t,e)}},{key:"reset_core",value:function(t,e){this.xcell.restoreStyle(t)}}]),n}(Jt),re=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=["tooltip"],a.init_core(),a}return Zt(n,[{key:"init_core",value:function(){this.addValue("tooltip",!1),this.tooltipHandler=void 0,this.xcell.enableTooltip(!1)}},{key:"setTooltip",value:function(t,e,n,r,a){var i=null,s=t.tooltipLabel;if(null!==this.tooltipHandler&&void 0!==this.tooltipHandler||(this.tooltipHandler=new Lt),t.tooltip){null!==s&&0!==s.length||("serie"===t.metricType&&(s=e.getName()),"table"===t.metricType&&(s=t.metricColumn)),t.tooltipColors&&(i=n);var o=this.tooltipHandler.addMetric().setLabel(s).setValue(r).setColor(i).setDirection(t.graphDirection);if(t.tooltipForGraph)o.addGraph(t.graphType).setColor(i).setColumn(t.metricColumn).setMetric(e).setSize(t.graphSize).setScaling(t.graphLow,t.graphHigh).setScale(t.graphScale)}t.tooltipMetadata&&this.tooltipHandler.addMetadata().setXCell(this.xcell),this.tooltipHandler.updateDate()}},{key:"apply",value:function(t){var e=this,a=Object.create(null,{apply:{get:function(){return Vt(Yt(n.prototype),"apply",e)}}});return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==t&&"tooltip"===t?this.isMatched(t)&&!0===this.getMatchValue(t)&&(null!=this.tooltipHandler&&this.tooltipHandler.isChecked()&&this.xcell.enableTooltip().setTooltipHandler(this.tooltipHandler),a.apply.call(this,t)):this.keys.forEach((function(t){n.apply(t)}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"prepare",value:function(){return Vt(Yt(n.prototype),"prepare",this).call(this),this.reset(),this}},{key:"reset",value:function(t){var e=this;return void 0!==t&&"tooltip"===t?(this.xcell.enableTooltip(!1),this.tooltipHandler=void 0,Vt(Yt(n.prototype),"reset",this).call(this,t)):this.keys.forEach((function(t){e.reset(t)})),this}}]),n}(Jt),ae=function(t){jt(n,t);var e=Gt(n);function n(t,r){var a;return Xt(this,n),(a=e.call(this,t,r)).keys=[],a.init(),a}return Zt(n,[{key:"init",value:function(){}},{key:"default_core",value:function(t){return!1}},{key:"apply_core",value:function(t){var e=this;return void 0!==t&&"icon"===t?this.isMatched(t)&&!0===this.getMatchValue(t)?this.isChanged(t)||this.xcell.addOverlay("WARNING/ERROR"):this.isChanged(t)&&this.reset_core(t):this.keys.forEach((function(t){e.apply_core(t)})),this}},{key:"reset_core",value:function(t){var e=this;return void 0!==t&&"icon"===t?this.xcell.removeOverlay():this.keys.forEach((function(t){e.reset_core(t)})),this}}]),n}(Jt);function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var se=["state_created","state_updated","state_changed","state_deleted"],oe=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.edited=!1,this.events=i.a.create(se),this.$gf=e,this.uid=s.a.genUid(this.constructor.name),this.states=new Map,this.xgraph=n,this.init()}var e,n,a;return e=t,(n=[{key:"update",value:function(){return s.c.debug("".concat(this.constructor.name,".").concat("refresh","() : ").concat(this.uid)),this.states.forEach((function(t){return t.update()})),this}},{key:"change",value:function(){return s.c.debug("".concat(this.constructor.name,".").concat("change","() : ").concat(this.uid)),this.states.forEach((function(t){return t.change()})),this}},{key:"init",value:function(){return s.c.debug("".concat(this.constructor.name,".").concat("init","() : ").concat(this.uid)),this._eventsConnect(),this.init_states(),this}},{key:"free",value:function(){var t=this;this.states.forEach((function(e){return Object(r.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.free(),t.next=3,this.events.emit("state_deleted",e);case 3:case"end":return t.stop()}}),t,this)})))})),this.clear(),this.events.clear(),this._eventsDisconnect()}},{key:"clear",value:function(){var t=this;return this.states.forEach((function(e){e.free(),t.events.emit("state_deleted",e)})),this.states.clear(),this}},{key:"_eventsConnect",value:function(){this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this))}},{key:"_eventsDisconnect",value:function(){this.$gf.events.disconnect("debug_asked",this)}},{key:"init_states",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clear(),e=this.xgraph.getXCells(),Promise.all(e.map((function(t){return Object(r.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.addState(t);case 1:case"end":return e.stop()}}),e,this)})))}))),t.abrupt("return",this);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setXGraph",value:function(t){return this.xgraph=t,this}},{key:"getStates",value:function(){return this.states}},{key:"getStatesForInspect",value:function(){return Array.from(this.states.values())}},{key:"getState",value:function(t){return this.states.get(t)}},{key:"addState",value:function(t){var e=new Kt(this.$gf,t,this.xgraph);return this.states.set(e.uid,e),this.events.emit("state_created",e),e}},{key:"matchXGraph",value:function(t){return this.xgraph.uid===t.uid}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.constructor.name}}])&&ie(e.prototype,n),a&&ie(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ue=["flowchart_initialized","flowchart_updated","flowchart_changed","flowchart_freed","graph_changed"],ce=function(){function t(e,n,r,a,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.visible=!1,this.reduce=!1,this.events=i.a.create(ue),this.$gf=e,this.uid=s.a.genUid(this.constructor.name),this.data=a,this.data.name=n,this.container=r,o&&this._convert(o),this.init()}var e,n,a;return e=t,a=[{key:"getDefaultData",value:function(){return{name:"Main",xml:"",csv:"",download:!1,type:"xml",url:"http://<YourUrl>/<Your XML/drawio file/api>",zoom:"100%",center:!0,scale:!0,lock:!0,enableAnim:!0,tooltip:!0,grid:!1,bgColor:null}}}],(n=[{key:"init",value:function(){s.c.debug("".concat(this.constructor.name,".").concat("init","() : ").concat(this.uid)),this.init_xgraph(),this.init_stateHandler(),this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),this.events.emit("flowchart_initialized",this)}},{key:"update",value:function(){s.c.debug("".concat(this.constructor.name,".").concat("refresh","() : ").concat(this.uid)),this.update_graph(),this.events.emit("flowchart_updated",this)}},{key:"change",value:function(){this.change_xgraph(),this.events.emit("flowchart_changed",this)}},{key:"free",value:function(){var t,e,n;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(t=null==this?void 0:this.xgraph)||void 0===t||t.events.disconnect("graph_changed",this),this.$gf.events.disconnect("debug_asked",this),null===(e=this.xgraph)||void 0===e||e.free(),null===(n=this.stateHandler)||void 0===n||n.free(),r.next=6,this.events.emit("flowchart_freed",this);case 6:this.events.clear(),this.clear();case 8:case"end":return r.stop()}}),r,this)})))}},{key:"clear",value:function(){var t,e;return null===(t=this.xgraph)||void 0===t||t.clear(),null===(e=this.stateHandler)||void 0===e||e.clear(),this}},{key:"name",get:function(){return this.data.name},set:function(t){var e;t&&0!==t.length&&t!==this.data.name&&((null===(e=this.$gf.flowchartHandler)||void 0===e?void 0:e.getFlowchart(t))?this.$gf.notify("Flowchart with name ".concat(t," already exit"),"error"):this.data.name=t)}},{key:"type",get:function(){return this.data.type},set:function(t){this.data.type!==t&&(this.data.type=t,this.change())}},{key:"source",get:function(){return"csv"===this.data.type?this.data.csv:this.data.xml},set:function(t){if("xml"===this.type){if(this.data.xml===t)return;if(t=ht.a.isEncoded(t)?ht.a.decode(t):t,!1===ht.a.isValidXml(t))return void this.$gf.notify("Invalid XML format","error");this.data.xml=this.transferXml(t)}if("csv"===this.type){if(this.data.csv===t)return;this.data.csv=t}this.change()}},{key:"download",get:function(){return this.data.download},set:function(t){t!==this.data.download&&(this.data.download=t,this.change())}},{key:"url",get:function(){return this.data.url},set:function(t){t!==this.data.url&&(this.data.url=t,this.change())}},{key:"background",get:function(){var t;return null!==(t=this.data.bgColor)&&void 0!==t?t:""},set:function(t){t!==this.data.bgColor&&(this.data.bgColor=null!=t?t:"",this._colorBackgroundContainer(t))}},{key:"scale",get:function(){return this.data.scale},set:function(t){t!==this.data.scale&&this.xgraph&&(this.data.scale=t,this.scaleGraph(t))}},{key:"center",get:function(){return this.data.center},set:function(t){t!==this.data.center&&this.xgraph&&(this.data.center=t,this.centerGraph(t))}},{key:"tooltip",get:function(){return this.data.tooltip},set:function(t){t!==this.data.tooltip&&this.xgraph&&(this.data.tooltip=t,this.enableTooltip(t))}},{key:"grid",get:function(){return this.data.grid},set:function(t){t!==this.data.grid&&this.xgraph&&(this.data.grid=t,this.enableGrid(t))}},{key:"lock",get:function(){return this.data.lock},set:function(t){t!==this.data.lock&&this.xgraph&&(this.data.lock=t,this.enableLock(t))}},{key:"animation",get:function(){return this.data.enableAnim},set:function(t){t!==this.data.enableAnim&&this.xgraph&&(this.data.enableAnim=t,this.enableAnimation(t))}},{key:"zoom",get:function(){return this.data.zoom},set:function(t){t!==this.data.zoom&&this.xgraph&&(this.data.zoom=t,this.zoomGraph(t))}},{key:"_convert",value:function(t){return s.c.info("flowchart[".concat(this.data.name,"].import()")),(t.download||!1===this.data.download)&&(this.data.download=t.download),t.source&&(this.data.type=t.source.type,this.data.xml=t.source.xml.value,this.data.url=t.source.url.value),t.options&&(this.data.zoom=t.options.zoom,this.data.center=t.options.center,this.data.scale=t.options.scale,this.data.lock=t.options.lock,this.data.tooltip=t.options.tooltip,this.data.grid=t.options.grid,this.data.bgColor=t.options.bgColor),t.type&&(this.data.type=t.type),t.xml&&(this.data.xml=t.xml),t.csv&&(this.data.csv=t.csv),t.url&&(this.data.url=t.url),t.zoom&&(this.data.zoom=t.zoom),(t.center||!1===t.center)&&(this.data.center=t.center),(t.scale||!1===t.scale)&&(this.data.scale=t.scale),(t.lock||!1===t.lock)&&(this.data.lock=t.lock),(t.enableAnim||!1===t.enableAnim)&&(this.data.enableAnim=t.enableAnim),t.tooltip&&(this.data.tooltip=t.tooltip),(t.grid||!1===t.grid)&&(this.data.grid=t.grid),t.bgColor&&(this.data.bgColor=t.bgColor),this}},{key:"getData",value:function(){return this.data}},{key:"init_stateHandler",value:function(){return this.stateHandler&&this.stateHandler.free(),this.xgraph&&(this.stateHandler=new oe(this.$gf,this.xgraph)),this}},{key:"init_xgraph",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.$gf,t.prev=1,t.abrupt("return",this.resolveSource().then((function(t){void 0!==n.xgraph&&n.xgraph.free(),n.xgraph=new vt(n.$gf,n.container,n.data.type,t),n.xgraph.events.connect("graph_changed",n,n._on_flowchart_graph_changed.bind(n)),n.update_graph(),n.events.emit("graph_changed",n.xgraph)})));case 5:t.prev=5,t.t0=t.catch(1),e.notify("Unable to initialize graph","error"),s.c.error("Unable to initialize graph",t.t0);case 9:return t.abrupt("return");case 10:case"end":return t.stop()}}),t,this,[[1,5]])})))}},{key:"change_xgraph",value:function(){var t=this.$gf;try{this.init_xgraph(),t.clearNotify()}catch(e){t.notify("Unable to initialize graph","error"),s.c.error("Unable to initialize graph",e)}return this}},{key:"getStateHandler",value:function(){return this.stateHandler}},{key:"getXGraph",value:function(){return this.xgraph}},{key:"update_graph",value:function(){var t;return this.scaleGraph(),this.centerGraph(),this.enableGrid(),this.enableTooltip(),this.enableLock(),this.zoomGraph(),this.enableAnimation(),this._colorBackgroundContainer(this.data.bgColor),null===(t=this.xgraph)||void 0===t||t.update(),this}},{key:"enableLock",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lock;return this.xgraph&&this.xgraph.enableLock(t),this}},{key:"enableAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.animation;return this.xgraph&&this.xgraph.enableAnimation(t),this}},{key:"enableTooltip",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tooltip;return this.xgraph&&this.xgraph.enableTooltip(t),this}},{key:"scaleGraph",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale;return null===(t=this.xgraph)||void 0===t||t.scaleDisplay(e),this}},{key:"_colorBackgroundContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.background;return this.container.style.backgroundColor=t||"",this}},{key:"getNamesByOptions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key",n=[];return this.xgraph&&(n="key"===e?this.xgraph.getDefaultValues(t):this.xgraph.getDefaultValuesWithKey(t,t.metadata)),n}},{key:"enableDioREssources",value:function(t){return this.xgraph&&this.xgraph.enableDioRessources(t),this}},{key:"resolveSource",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.$gf,r="",!this.download){e.next=12;break}return a=n.resolveVars(this.data.url),n.notify("Loading content definition for ".concat(this.data.name),"info"),e.next=7,ht.a.loadFile(a);case 7:r=e.sent,n.clearNotify(),null!==r&&t&&(r=n.resolveVars(r)),e.next=20;break;case 12:if(this.source&&0!==this.source.length){e.next=18;break}return e.next=15,ht.a.getTemplate(this.type);case 15:r=e.sent,"xml"===this.type&&(this.data.xml=r),"csv"===this.type&&(this.data.csv=r);case 18:ht.a.isEncoded(r)&&(r=ht.a.decode(r)),r=n.resolveVars(this.source);case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this)})))}},{key:"centerGraph",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.center;return null===(t=this.xgraph)||void 0===t||t.centerDisplay(e),this}},{key:"zoomGraph",value:function(){return arguments.length>0&&void 0!==arguments[0]||this.zoom,this.xgraph&&this.xgraph.zoomDisplay(this.data.zoom),this}},{key:"enableGrid",value:function(){return arguments.length>0&&void 0!==arguments[0]||this.grid,this.xgraph&&this.xgraph.gridDisplay(this.data.grid),this}},{key:"minify",value:function(){this.data.xml=s.a.utils.minify(this.data.xml)}},{key:"prettify",value:function(){this.data.xml=s.a.utils.prettify(this.data.xml)}},{key:"decode",value:function(){ht.a.isEncoded(this.data.xml)&&(this.data.xml=ht.a.decode(this.data.xml))}},{key:"encode",value:function(){if(!ht.a.isEncoded(this.data.xml)){var t=ht.a.encode(this.data.xml);this.data.xml=t||this.data.xml}}},{key:"transferXml",value:function(t){var e=ht.a.parseXml(t).querySelector("mxGraphModel");return e?(new XMLSerializer).serializeToString(e):t}},{key:"getContainer",value:function(){return this.container}},{key:"toFront",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.visible=!0,this.container.className="gf-flowchartShow",t&&this.update_graph(),this}},{key:"toBack",value:function(){return this.visible=!1,this.container.className="gf-flowchartHide",this}},{key:"isVisible",value:function(){return this.visible}},{key:"_on_flowchart_graph_changed",value:function(){this.constructor.name,this.xgraph&&this.init_stateHandler()}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.constructor.name}}])&&le(e.prototype,n),a&&le(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function he(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var de=["flowchart_created","flowchart_deleted"],fe=function(){function t(e,n,r){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flowcharts=[],this.currentFlowchartName="Main",this.firstLoad=!0,this.newMode=!1,this.sequenceNumber=0,this.mousedownTimeout=0,this.mousedown=0,this.onEdit=!1,this.postedId=void 0,this.editorWindow=null,this.events=i.a.create(de),this.$gf=e,this.$gf.flowchartHandler=this,this.uid=s.a.genUid(this.constructor.name),this._parentDiv=this.$gf.ctrl.flowchartsDiv,this.data=n,this.currentFlowchartName="Main",document.body.onmousedown=function(){a.mousedown=0,window.clearInterval(a.mousedownTimeout),a.mousedownTimeout=window.setInterval((function(){a.mousedown+=1}),200)},document.body.onmouseup=function(){a.mousedown=0,window.clearInterval(a.mousedownTimeout)},r&&this._convert(r),this.init()}var e,n,a;return e=t,a=[{key:"getDefaultData",value:function(){return{editorUrl:s.b.CONF_EDITOR_URL,editorTheme:s.b.CONF_EDITOR_THEME,flowcharts:[ce.getDefaultData()],allowDrawio:!0}}}],(n=[{key:"update",value:function(){this.updateFlowchart()}},{key:"change",value:function(){this.setCurrentFlowchart("Main")}},{key:"free",value:function(){this.flowcharts.forEach((function(t){return t.free()})),this.$gf.events.disconnect("debug_asked",this),this.$gf.events.disconnect("panel_closed",this),this.clear()}},{key:"init",value:function(){this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),this.$gf.events.connect("panel_closed",this,this._on_global_panel_closed.bind(this))}},{key:"editorUrl",get:function(){return this.data.editorUrl},set:function(t){this.data.editorUrl=t}},{key:"editorTheme",get:function(){return this.data.editorTheme},set:function(t){this.data.editorTheme=t}},{key:"allowDrawio",get:function(){return this.data.allowDrawio},set:function(t){this.data.allowDrawio!==t&&(this.data.allowDrawio=t,this.change())}},{key:"_convert",value:function(t){var e,n=this;return t&&(1===(e=Array.isArray(t)?t:t.flowcharts).length&&(this.currentFlowchartName="Main",e[0].editorTheme&&(this.data.editorTheme=e[0].editorTheme),e[0].editorUrl&&(this.data.editorUrl=e[0].editorUrl),(e[0].allowDrawio||!1===e[0].allowDrawio)&&(this.data.allowDrawio=e[0].allowDrawio)),this.data.editorTheme=t.editorTheme?t.editorTheme:this.data.editorTheme,this.data.editorUrl=t.editorUrl?t.editorUrl:this.data.editorUrl,(t.allowDrawio||!1===t.allowDrawio)&&(this.data.allowDrawio=t.allowDrawio),this.data.flowcharts=[],Array.isArray(e)&&e.forEach((function(t){n.addFlowchart(t.name,t).toBack()})),this.currentFlowchart=this.getFlowchart("Main")),this.change(),this}},{key:"clear",value:function(){return this.flowcharts.forEach((function(t){t.clear()})),this.flowcharts=[],this.data.flowcharts=[],this}},{key:"getFlowchart",value:function(t){if(t&&"string"==typeof t)for(var e=this.flowcharts.length,n=0;n<e;n++){var r=this.flowcharts[n];if(r.name===t)return r}if(t&&"number"==typeof t)return this.flowcharts[t];var a=this.getCurrentFlowchart();return void 0!==a?a:this.flowcharts[0]}},{key:"getFlowchartById",value:function(t){for(var e=this.getFlowcharts(),n=0;n<e.length;n++){var r=e[n];if(r.uid===t)return r}}},{key:"getFlowcharts",value:function(){return this.flowcharts}},{key:"countFlowcharts",value:function(){return void 0!==this.flowcharts&&Array.isArray(this.flowcharts)?this.flowcharts.length:0}},{key:"getFlowchartTmpName",value:function(){return 0===this.sequenceNumber&&(this.sequenceNumber=this.countFlowcharts()),"Flowchart-".concat(this.sequenceNumber++)}},{key:"isMultiFlowcharts",value:function(){return this.flowcharts.length>1}},{key:"isCurrentfirst",value:function(){return 0===this.getCurrentIndex()}},{key:"isCurrentLast",value:function(){return this.getCurrentIndex()===this.flowcharts.length-1}},{key:"getCurrentIndex",value:function(){return this.currentFlowchart?this.flowcharts.indexOf(this.currentFlowchart):0}},{key:"setCurrentFlowchart",value:function(t){return void 0===t?(this.currentFlowchart=this.getFlowchart("Main"),this.currentFlowchartName=this.currentFlowchart.name,this.currentFlowchart.toFront(),this.currentFlowchart):void 0===this.currentFlowchart?(this.currentFlowchart=this.getFlowchart(t),this.currentFlowchartName=this.currentFlowchart.name,this.currentFlowchart.toFront(),this.currentFlowchart):(this.currentFlowchart.name!==t&&this.currentFlowchart.toBack(),this.currentFlowchart=this.getFlowchart(t),this.currentFlowchartName=t,this.currentFlowchart.toFront(),this.currentFlowchart)}},{key:"setNextFlowchart",value:function(){var t=this.getCurrentIndex();if(t<this.flowcharts.length-1){var e=this.flowcharts[t+1].name;this.setCurrentFlowchart(e)}}},{key:"setPreviousFlowchart",value:function(){var t=this.getCurrentIndex();if(0!==t){var e=this.flowcharts[t-1].name;this.setCurrentFlowchart(e)}}},{key:"getCurrentFlowchart",value:function(){return this.currentFlowchart}},{key:"getCurrentFlowchartName",value:function(){var t=this.getCurrentFlowchart();return void 0!==t?t.name:"Main"}},{key:"createContainer",value:function(){var t=document.createElement("div");return t.style.margin="auto",t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.touchAction="none",t.style.border="none",t.style.cursor="default",t.style.right="0px",t.style.left="0px",t.style.bottom="0px",t.style.top="0px",this._parentDiv.appendChild(t),t}},{key:"addFlowchart",value:function(t,e){var n=ce.getDefaultData(),r=this.createContainer(),a=new ce(this.$gf,t,r,n,e);return this.flowcharts.push(a),this.data.flowcharts.push(n),a}},{key:"removeFlowchart",value:function(t){var e=this.getFlowchart(t);e.free();var n=this.flowcharts.indexOf(e);this.flowcharts.splice(n,1),this.data.flowcharts.splice(n,1),e.clear()}},{key:"render",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.mousedown&&!this.firstLoad||(this.firstLoad=!1,this.update(),this.$gf.ctrl.renderingCompleted());case 1:case"end":return t.stop()}}),t,this)})))}},{key:"updateFlowchart",value:function(){return this.flowcharts.forEach((function(t){return t.update()})),this}},{key:"updateMetrics",value:function(){return this}},{key:"updateRules",value:function(){return this}},{key:"refreshStates",value:function(){return this.flowcharts.forEach((function(t){var e;return null===(e=t.getStateHandler())||void 0===e?void 0:e.update()})),this}},{key:"listenMessage",value:function(t){if(void 0!==t.data&&t.data.length>0&&"fc-"===t.data.substring(0,3)){var e=t.data.substring(3),n=this.getFlowchartById(e);this.currentFlowchart=n,void 0!==n&&(this.$gf.notify("Sending current data to draw.io editor","info"),t.source.postMessage(n.data.xml,t.origin),this.postedId=n.uid)}else{if(this.onEdit&&void 0!==t.data&&t.data.length>0&&"fc-"!==t.data.substring(0,3)&&void 0!==this.currentFlowchart&&void 0!==this.postedId){var r=this.getFlowchartById(this.postedId);void 0!==r&&(this.$gf.notify("Received data from draw.io editor, refresh in progress","info"),r.source=t.data,this.change(),this.render())}(this.onEdit&&t.data||0===t.data.length)&&(window.removeEventListener("message",this.listenMessage.bind(this),!1),this.editorWindow&&this.editorWindow.close(),this.onEdit=!1,this.postedId=void 0,this.$gf.notify("Draw.io editor closed","info"))}}},{key:"openDrawEditor",value:function(t){var e=this.getFlowchart(t),n=this.data.editorUrl,r=this.data.editorTheme,a="".concat(n,"?embed=1&spin=1&libraries=1&ui=").concat(r,"&ready=fc-").concat(e.uid,"&src=grafana");this.editorWindow=window.open(a,"MxGraph Editor","width=1280, height=720"),this.onEdit=!0,this.$gf.notify("Opening current flowchart on draw.io editor","info"),window.addEventListener("message",this.listenMessage.bind(this),!1)}},{key:"getFlowchartNames",value:function(){return this.flowcharts.map((function(t){return t.data.name}))}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.constructor.name}},{key:"_on_global_panel_closed",value:function(){this.constructor.name,this.free()}}])&&he(e.prototype,n),a&&he(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pe(t){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ve(){return(ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ge(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function ge(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=we(t)););return t}function me(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ye(t,e)}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=we(t);if(e){var a=we(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _e(this,n)}}function _e(t,e){if(e&&("object"===pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function we(t){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ee(t,e,n){return e&&xe(t.prototype,e),n&&xe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Te=["metric_initialized","metric_updated","metric_freed"],Se=function(){function t(e,n){ke(this,t),this.type="unknown",this.uid=s.a.genUid(this.constructor.name),this.metrics={},this.name="",this._nullPointMode="connected",this._GHValue=null,this.events=i.a.create(Te),this.$gf=e,this.dataList=n}return Ee(t,[{key:"setDataList",value:function(t){return this.dataList=t,this}},{key:"getName",value:function(){return void 0!==this.name&&null!==this.name||s.c.error("Metric => getName : Name is null"),this.name}},{key:"getValue",value:function(t,e){return null}},{key:"isValidDate",value:function(t,e){return D.isValidDate(this.getValue(t,e))}},{key:"findValue",value:function(t,e){return null}},{key:"getData",value:function(t){return[]}},{key:"getColumnsName",value:function(){return[]}},{key:"clear",value:function(){this.dataList=void 0,this.metrics={}}},{key:"update",value:function(t){this._GHValue=void 0!==t?this.findValue(t):null,this.events.emit("metric_updated",this)}},{key:"change",value:function(){}},{key:"init",value:function(){this.events.emit("metric_initialized",this)}},{key:"free",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clear(),t.next=3,this.events.emit("metric_freed",this);case 3:this.events.clear();case 4:case"end":return t.stop()}}),t,this)})))}}]),t}(),Oe=function(t){me(n,t);var e=be(n);function n(t,r){var a;return ke(this,n),(a=e.call(this,t,r)).type="serie",a.init(),a}return Ee(n,[{key:"init",value:function(){return this.metrics=this._seriesHandler(),this._addCustomStats(),this.name=this.metrics.alias,ve(we(n.prototype),"init",this).call(this),this}},{key:"_seriesHandler",value:function(){var t=void 0;return this.dataList&&((t=p.getTimeSeries(this.dataList)).flotpairs=t.getFlotPairs(this._nullPointMode)),t}},{key:"_addCustomStats",value:function(){try{var t=this.metrics.flotpairs.length;this.metrics.stats.last_time=this.metrics.flotpairs[t-1][0],this.metrics.stats.current=this.metrics.flotpairs[t-1][1],this.metrics.stats.current_notnull=null;for(var e=t-1;(null===this.metrics.flotpairs[e][1]||void 0===this.metrics.flotpairs[e][1])&&e>=0;)e-=1;for(e>=0&&(this.metrics.stats.current_notnull=this.metrics.flotpairs[e][1]),this.metrics.stats.first=this.metrics.flotpairs[0][1],this.metrics.stats.first_notnull=null,e=0;(null===this.metrics.flotpairs[e][1]||void 0===this.metrics.flotpairs[e][1])&&e<t;)e+=1;e<t&&(this.metrics.stats.first_notnull=this.metrics.flotpairs[e][1])}catch(t){s.c.error("Unable to add custom stats",t)}}},{key:"getValue",value:function(t){arguments.length>1&&void 0!==arguments[1]||this.name;try{return this.metrics.stats[t]}catch(t){return s.c.error("datapoint for serie is null",t),null}}},{key:"findValue",value:function(t){var e=0,n=this.metrics.flotpairs.length-1,r=!(n>0);t=Math.round(t);for(var a=null;!r;){var i=e+Math.round((n-e)/2);this.metrics.flotpairs[i][0]===t&&(a=this.metrics.flotpairs[i][1],r=!0),!r&&e<i&&i<n?(t>this.metrics.flotpairs[i][0]&&(e=i),t<this.metrics.flotpairs[i][0]&&(n=i)):(a=this.metrics.flotpairs[i][0]>t&&i>=1?this.metrics.flotpairs[i-1][1]:this.metrics.flotpairs[i][1],r=!0)}return a}},{key:"getData",value:function(){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.metrics.flotpairs.map((function(e){return t?{x:e[0],y:Math.log10(e[1])}:{x:e[0],y:e[1]}}))}},{key:"getColumnsName",value:function(){return["Time",this.name]}}]),n}(Se),Me=function(t){me(n,t);var e=be(n);function n(t,r){var a;return ke(this,n),(a=e.call(this,t,r)).tableColumnOptions={},a.tableColumn="",a.allIsNull=!0,a.allIsZero=!0,a.type="table",a.init(),a}return Ee(n,[{key:"init",value:function(){var t;return this.metrics=this._tableHandler(),this.name=null===(t=this.dataList)||void 0===t?void 0:t.refId,ve(we(n.prototype),"init",this).call(this),this}},{key:"_tableHandler",value:function(){var t,e,n,r={datapoints:[],columnNames:{},stats:{}};return null===(t=this.dataList)||void 0===t||t.columns.forEach((function(t,e){r.columnNames[e]=t.text,"time"===t.text.toString().toLowerCase()&&(r.timeIndex=e,r.timeColumn=t.text)})),this.tableColumnOptions=r.columnNames,Object(o.find)(null===(e=this.dataList)||void 0===e?void 0:e.columns,["text",this.tableColumn])||this._setTableColumnToSensibleDefault(),null===(n=this.dataList)||void 0===n||n.rows.forEach((function(t){var e={};t.forEach((function(t,n){var a=r.columnNames[n];e[a]=t})),r.datapoints.push(e)})),this.metrics.flotpairs=this._getFlotPairs(this._nullPointMode,r),r}},{key:"_setTableColumnToSensibleDefault",value:function(){this.dataList&&(1===this.dataList.columns.length?this.tableColumn=this.dataList.columns[0].text:this.tableColumn=Object(o.find)(this.dataList.columns,(function(t){return"time"!==t.type})).text)}},{key:"_getFlotPairs",value:function(t,e){var n=[],r="connected"===t,a="null as zero"===t;for(var i in e.allIsNull=!0,e.allIsZero=!0,e.columnNames){var l=e.columnNames[i];e.stats[l]={},e.stats[l].name=l,e.stats[l].total=0,e.stats[l].max=-Number.MAX_VALUE,e.stats[l].min=Number.MAX_VALUE,e.stats[l].logmin=Number.MAX_VALUE,e.stats[l].avg=null,e.stats[l].current=null,e.stats[l].current_notnull=null,e.stats[l].first=null,e.stats[l].first_notnull=null,e.stats[l].delta=0,e.stats[l].diff=null,e.stats[l].range=null,e.stats[l].timeStep=Number.MAX_VALUE;var u=void 0,c=void 0,h=0,d=void 0,f=0,p=!0;try{for(var v=0;v<e.datapoints.length;v++){if(e.timeColumn&&(u=e.datapoints[v][e.timeColumn]),c=e.datapoints[v][l],void 0!==d){var g=u-d;g<e.stats[l].timeStep&&(e.stats[l].timeStep=g)}if(d=u,null===c){if(r)continue;a&&(c=0)}null!==c&&(Object(o.isNumber)(c)&&(e.stats[l].total+=c,this.allIsNull=!1,h++),c>e.stats[l].max&&(e.stats[l].max=c),c<e.stats[l].min&&(e.stats[l].min=c),null===e.stats[l].first?e.stats[l].first=c:f>c?(p=!1,v===e.datapoints.length-1&&(e.stats[l].delta+=c)):(e.stats[l].delta+=p?c-f:c,p=!0),f=c,c<e.stats[l].logmin&&c>0&&(e.stats[l].logmin=c),0!==c&&(this.allIsZero=!1)),n.push([u,c])}}catch(t){s.c.error("Unable to aggregate data",t)}u&&(e.stats[l].last_time=u),e.stats[l].max===-Number.MAX_VALUE&&(e.stats[l].max=null),e.stats[l].min===Number.MAX_VALUE&&(e.stats[l].min=null),n.length&&!this.allIsNull&&(e.stats[l].avg=e.stats[l].total/h,e.stats[l].current=n[n.length-1][1],null===e.stats[l].current&&n.length>1&&(e.stats[l].current=n[n.length-2][1])),null!==e.stats[l].max&&null!==e.stats[l].min&&(e.stats[l].range=e.stats[l].max-e.stats[l].min),null!==e.stats[l].current&&null!==e.stats[l].first&&(e.stats[l].diff=e.stats[l].current-e.stats[l].first),e.stats[l].count=n.length}return n}},{key:"getValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Value";try{return this.metrics.stats[e][t]}catch(t){return s.c.error("datapoint for table is null",t),null}}},{key:"findValue",value:function(t,e){var n=0,r=this.metrics.datapoints.length-1,a=!(r>0&&this.metrics.datapoints[n][this.metrics.timeColumn]<t);t=Math.round(t);for(var i=null;!a;){var s=n+Math.round((r-n)/2);this.metrics.datapoints[s][this.metrics.timeColumn]===t&&(i=this.metrics.datapoints[s][e],a=!0),!a&&n<s&&s<r?(t>this.metrics.datapoints[s][this.metrics.timeColumn]&&(n=s),t<this.metrics.datapoints[s][this.metrics.timeColumn]&&(r=s)):(i=this.metrics.datapoints[s][this.metrics.timeColumn]>t&&s>=1?this.metrics.datapoints[s-1][e]:this.metrics.datapoints[s][e],a=!0)}return i}},{key:"getColumnIndex",value:function(t){for(var e in this.tableColumnOptions)if(t===this.tableColumnOptions[e])return Number(e);return null}},{key:"getColumnsName",value:function(){var t=[];for(var e in this.tableColumnOptions)t.push(this.tableColumnOptions[e]);return t}},{key:"getData",value:function(t){var e=this;return this.metrics.timeColumn?this.metrics.datapoints.map((function(n){return{x:n[e.metrics.timeColumn],y:n[t]}})):this.metrics.datapoints.map((function(e){return e[t]}))}}]),n}(Se);function Ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Re=["metric_created","metric_updated","metric_deleted"],De=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataList=[],this.tables=new Map,this.series=new Map,this.metrics=new Map,this.events=i.a.create(Re),this.$gf=e,this.$gf.metricHandler=this,this.uid=s.a.genUid("MetricHandler"),this.init()}var e,n,a;return e=t,(n=[{key:"change",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.$gf,this.clear(),t.next=4,Promise.all(this.dataList.map((function(t){return Object(r.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.addMetric(t);case 1:case"end":return e.stop()}}),e,this)})))}))).catch((function(t){}));case 4:return e.events.emit("data_processed"),t.abrupt("return");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"update",value:function(t){return s.c.debug("".concat(this.constructor.name,".").concat("refresh","() : ").concat(this.uid)),this.metrics.forEach((function(e){return e.update(t)})),this}},{key:"init",value:function(){s.c.debug("".concat(this.constructor.name,".").concat("init","() : ").concat(this.uid));var t=this.$gf;return t.events.connect("data_updated",this,this._on_global_data_updated.bind(this)),t.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),t.events.connect("panel_closed",this,this._on_global_panel_closed.bind(this)),this}},{key:"free",value:function(){var t=this,e=this.$gf;return s.c.debug("".concat(this.constructor.name,".").concat("free","() : ").concat(this.uid)),this.metrics.forEach((function(e){e.free(),t.events.emit("metric_deleted",e)})),e.events.disconnect("data_updated",this),e.events.disconnect("debug_asked",this),e.events.disconnect("panel_closed",this),e.events.disconnect("editmode_closed",this),this.clear(),this}},{key:"setDataList",value:function(t){this.dataList=t}},{key:"addMetric",value:function(t){return"table"===t.type?this.addTable(t):this.addSerie(t)}},{key:"removeMetric",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uid,r=t.type,t.free(),"serie"===r&&this.series.delete(n),"table"===r&&this.tables.delete(n),this.metrics.delete(n),e.next=8,this.events.emit("metric_deleted",t);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"addTable",value:function(t){var e=new Me(this.$gf,t);return this.tables.set(e.uid,e),this.metrics.set(e.uid,e),this.events.emit("metric_created",e),e}},{key:"addSerie",value:function(t){var e=new Oe(this.$gf,t);return this.series.set(e.uid,e),this.metrics.set(e.uid,e),this.events.emit("metric_created",e),e}},{key:"getNames",value:function(t){return this.getMetrics(t).map((function(t){return t.getName()}))}},{key:"getMetrics",value:function(t){return"serie"===t?Array.from(this.series.values()):"table"===t?Array.from(this.tables.values()):Array.from(this.metrics.values())}},{key:"isTypeOf",value:function(t){return("serie"===t||"table"===t)&&this.series.size>0}},{key:"findMetrics",value:function(t,e){return this.getMetrics(e).filter((function(e){return s.a.matchString(e.getName(),t,!0)}))}},{key:"refreshMetrics",value:function(t){return this.metrics.forEach((function(e){e.update(t)})),this}},{key:"getColumnsName",value:function(t,e){var n=this.findMetrics(t,e),r=[];return n.forEach((function(t){r=r.concat(t.getColumnsName())})),r}},{key:"clear",value:function(){var t=this;this.metrics.forEach((function(e){t.removeMetric(e)}))}},{key:"isMultipleType",value:function(){return this.isTypeOf("serie")&&this.isTypeOf("table")}},{key:"getMetricNames",value:function(){var t=[],e="",n=this.isMultipleType();return n&&(e="Series/"),this.series.forEach((function(n){return t.push("".concat(e).concat(n.getName()))})),n&&(e="Tables/"),this.tables.forEach((function(n){n.getColumnsName().forEach((function(r){return t.push("".concat(e).concat(n,"/").concat(r))}))})),t}},{key:"_on_global_data_updated",value:function(t){this.constructor.name,this.setDataList(t),this.change()}},{key:"_on_global_debug_asked",value:function(){this.constructor.name}},{key:"_on_global_panel_closed",value:function(){this.constructor.name,this.free()}}])&&Ce(e.prototype,n),a&&Ce(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ae(t){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ne(t,e,n){return e&&Pe(t.prototype,e),n&&Pe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function He(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ve(t);if(e){var a=Ve(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Fe(this,n)}}function Fe(t,e){if(e&&("object"===Ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ze(t)}function ze(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ve(t){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ue=function(t){n.$inject=["$scope","$injector","$rootScope","templateSrv"],function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ie(t,e)}(n,t);var e=He(n);function n(t,r,a,i){var l;return Le(this,n),(l=e.call(this,t,r)).graphOverTimeStamp=0,l.onMapping=!1,l.uid=s.a.genUid(l.constructor.name),l.graphHoverTimer=void 0,l.mouseIn=!1,l.firstLoad=!0,l.uid,l.$gf=s.a.create(t,i,l.dashboard,ze(l)),l.$rootScope=a,l.$scope=t,t.editor=ze(l),l.version=s.d.getVersion(),l.templateSrv=i,l.changedSource=!0,l.changedData=!0,l.changedOptions=!0,l.parentDiv=document.createElement("div"),l.flowchartsDiv=document.createElement("div"),l.panelDefaults=n.getDefaultData(),Object(o.defaults)(l.panel,l.panelDefaults),l.panel.graphId="flowchart_".concat(l.panel.id),l.containerDivId="container_".concat(l.panel.graphId),Object.assign({},l.panel),window.setTimeout((function(){l._on_grafana_refreshed()}),1e3),l.events.on("render",l._on_grafana_rendered.bind(ze(l))),l.events.on("refresh",l._on_grafana_refreshed.bind(ze(l))),l.events.on("data-received",l._on_grafana_data_received.bind(ze(l))),l.events.on("data-error",l._on_grafana_data_error.bind(ze(l))),l.events.on("data-snapshot-load",l._on_grafana_data_received.bind(ze(l))),l.events.on("init-edit-mode",l._on_grafana_mode_edited.bind(ze(l))),l.events.on("panel-teardown",l._on_grafana_TearDown.bind(ze(l))),p.appEvents.on("graph-hover",l._on_grafana_graph_hover.bind(ze(l)),l.$scope),p.appEvents.on("graph-hover-clear",l._on_grafana_graph_hover_clear.bind(ze(l)),l.$scope),l.dashboard.events.on("template-variable-value-updated",l._on_grafana_template_variable_value_updated.bind(ze(l)),t),l}return Ne(n,[{key:"init_ctrl",value:function(){this._eventsConnect(),this.init_handlers()}},{key:"free",value:function(){this.free_ctrl()}},{key:"free_ctrl",value:function(){this._eventsDisconnect(),this.free_handlers()}},{key:"change",value:function(){this.free_ctrl(),this.init_ctrl()}},{key:"_eventsConnect",value:function(){this.$gf.events.connect("debug_asked",this,this._on_global_debug_asked.bind(this)),this.$gf.events.connect("panel_closed",this,this._on_global_panel_closed.bind(this)),this.$gf.events.connect("editmode_closed",this,this._on_global_editmode_closed.bind(this)),this.$gf.events.connect("mapping_enabled",this,this._on_global_mapping_enabled.bind(this)),this.$gf.events.connect("mapping_disabled",this,this._on_global_mapping_disabled.bind(this))}},{key:"_eventsDisconnect",value:function(){this.$gf.events.disconnect("debug_asked",this),this.$gf.events.disconnect("panel_closed",this),this.$gf.events.disconnect("mapping_enabled",this),this.$gf.events.disconnect("mapping_disabled",this)}},{key:"init_handlers",value:function(){if(s.c.debug("".concat(this.constructor.name,".").concat("initHandlers","()")),this.metricHandler||(this.metricHandler=new De(this.$gf)),!this.rulesHandler){var t=wt.getDefaultData();this.rulesHandler=new wt(this.$gf,t,this.panel.rulesData),this.panel.rulesData=t}if(this.panel.newFlag&&0===this.rulesHandler.countRules()&&this.rulesHandler.addRule(".*"),!this.flowchartHandler){var e=fe.getDefaultData();this.flowchartHandler=new fe(this.$gf,e,this.panel.flowchartsData),this.panel.flowchartsData=e}this.panel.newFlag&&this.flowchartHandler&&0===this.flowchartHandler.countFlowcharts()&&this.flowchartHandler.addFlowchart("Main").init()}},{key:"free_handlers",value:function(){var t,e,n;null===(t=this.metricHandler)||void 0===t||t.free(),null===(e=this.rulesHandler)||void 0===e||e.free(),null===(n=this.flowchartHandler)||void 0===n||n.free(),this.metricHandler=void 0,this.rulesHandler=void 0,this.flowchartHandler=void 0}},{key:"_setGraphHover",value:function(){var t;null===(t=this.metricHandler)||void 0===t||t.refreshMetrics(this.graphOverTimeStamp)}},{key:"_isClosedMode",value:function(){return!(!this.panel.gf_isEdited||this.panel.isEditing)&&(delete this.panel.gf_isEdited,this.events,this._eventsDisconnect(),this._eventsConnect(),this.$gf.events.emit("editmode_closed"),!0)}},{key:"link",value:function(t,e,n,r){this.$panelElem=e;var a=this.$panelElem.find("#flowcharting-section");this.parentDiv=a[0];var i=a.find("#flowcharting-panel-content");this.flowchartsDiv=i[0],this.notify("Initialisation MXGRAPH/DRAW.IO Libs"),this.notify("Load configuration"),this.panel.gf_isEdited&&delete this.panel.gf_isEdited,ht.a.init(),this.init_ctrl(),this.panel.version,s.d.getVersion(),this.clearNotify(),this.panel.version=this.version,!0===this.panel.isEditing&&(this.panel.gf_isEdited=!0)}},{key:"isMouseInPanel",value:function(){return this.mouseIn}},{key:"displayMultiCursor",value:function(){return!!this.flowchartHandler&&this.flowchartHandler.isMultiFlowcharts()}},{key:"displayFirstCursor",value:function(){return!!this.flowchartHandler&&!this.flowchartHandler.isCurrentfirst()}},{key:"displayLastCursor",value:function(){return!!this.flowchartHandler&&!this.flowchartHandler.isCurrentLast()}},{key:"displayNextFlowchart",value:function(){this.flowchartHandler&&this.flowchartHandler.setNextFlowchart()}},{key:"displayPreviousFlowchart",value:function(){this.flowchartHandler&&this.flowchartHandler.setPreviousFlowchart()}},{key:"_on_grafana_mode_edited",value:function(){this.constructor.name,this.uid,"isEditing=".concat(this.panel.isEditing),this.addEditorTab("Flowcharts",st,2),this.addEditorTab("Rules",rt,3),this.addEditorTab("Inspect",yt,4)}},{key:"_on_grafana_TearDown",value:function(){this.constructor.name,this.uid,"isEditing=".concat(this.panel.isEditing),this.$gf.events.emit("panel_closed")}},{key:"_on_grafana_graph_hover",value:function(t){var e;this.constructor.name,this.uid;var n=this.flowchartHandler;if(this.dashboard.sharedTooltipModeEnabled()&&void 0!==n){this.graphHoverTimer=t.pos.x;void 0===this.graphHoverTimer&&(this.graphHoverTimer=s.f.create("graph-hover"));var r=s.b.CONF_GRAPHHOVER_DELAY;this.graphHoverTimer.addStep(this._setGraphHover.bind(this),r).start()}else null===(e=this.graphHoverTimer)||void 0===e||e.cancel(),this.graphHoverTimer=void 0}},{key:"_on_grafana_graph_hover_clear",value:function(t){var e,n;this.constructor.name,this.uid,void 0!==this.flowchartHandler&&void 0!==this.graphHoverTimer&&(null===(e=this.graphHoverTimer)||void 0===e||e.cancel(),this.graphHoverTimer=void 0,null===(n=this.metricHandler)||void 0===n||n.refreshMetrics())}},{key:"_on_grafana_refreshed",value:function(){var t;this.constructor.name,this.uid,null===(t=this.flowchartHandler)||void 0===t||t.update(),this.firstLoad=!1}},{key:"_on_grafana_template_variable_value_updated",value:function(){this.constructor.name,this.uid,this.$gf.events.emit("variables_changed"),this.flowchartHandler}},{key:"_on_grafana_rendered",value:function(){var t;this.constructor.name,this.uid,!this._isClosedMode()&&(null===(t=this.flowchartHandler)||void 0===t||t.update())}},{key:"_on_grafana_data_received",value:function(t){this.constructor.name,this.uid,this.dataList=t,this.$gf.events.emit("data_updated",t)}},{key:"_on_grafana_data_error",value:function(){this.constructor.name,this.uid,this.render()}},{key:"_on_global_debug_asked",value:function(){this.constructor.name,this.uid,this.panel}},{key:"_on_global_panel_closed",value:function(){this.constructor.name,this.uid,this.free()}},{key:"_on_global_editmode_closed",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.constructor.name,this.uid,this.notify("Configuration updating..."),this.free_ctrl(),this.init_ctrl(),t.next=6,new Promise((function(t){return setTimeout(t,100)}));case 6:return this.$gf.events.emit("data_updated",this.dataList),this.clearNotify(),t.abrupt("return");case 9:case"end":return t.stop()}}),t,this)})))}},{key:"_on_global_mapping_enabled",value:function(){this.constructor.name,this.uid,this.onMapping=!0,this.flowchartsDiv.style.cursor='url("'.concat(s.d.getStaticPath(),'cursor-marker.svg") 8 16, crosshair'),this.flowchartsDiv.scrollIntoView(),this.flowchartsDiv.focus()}},{key:"_on_global_mapping_disabled",value:function(){this.constructor.name,this.uid,this.onMapping=!1,this.flowchartsDiv.style.cursor="auto"}},{key:"$onDestroy",value:function(){s.f.stop()}},{key:"notify",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je.INFO_MESSAGE;if(this.message)this.message.setMessage(t,e);else{var n=this.$panelElem.find("#flowcharting-section"),r=n.find("#flowcharting-message");this.message=new je(r[0]),this.notify(t,e)}}},{key:"clearNotify",value:function(){this.message&&this.message.clearMessage()}}],[{key:"getDefaultData",value:function(){return{format:"short",valueName:"current",rulesData:wt.getDefaultData(),flowchartsData:fe.getDefaultData(),version:s.d.getVersion()}}}]),n}(a.MetricsPanelCtrl);Ue.templateUrl="./partials/module.html";var je=function(){function t(e){Le(this,t),this.uid=s.a.genUid(),this.container=e;var n=this.container.querySelector("#message-text");null==n?(this.message=document.createElement("span"),this.container.appendChild(this.message)):this.message=n}return Ne(t,[{key:"setMessage",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.INFO_MESSAGE;return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.container||!this.message){r.next=15;break}this.message.innerHTML=e,r.t0=n,r.next=r.t0===t.INFO_MESSAGE?5:r.t0===t.ERROR_MESSAGE?7:r.t0===t.WARNING_MESSAGE?9:11;break;case 5:return this.message.style.color=t.INFO_COLOR,r.abrupt("break",13);case 7:return this.message.style.color=t.ERROR_COLOR,r.abrupt("break",13);case 9:return this.message.style.color=t.WARNING_COLOR,r.abrupt("break",13);case 11:return this.message.style.color=t.INFO_COLOR,r.abrupt("break",13);case 13:s.f.create("message-".concat(this.uid)).addStep(this.clearMessage.bind(this),s.b.CONF_GFMESSAGE_MS),this.container.style.display="";case 15:case"end":return r.stop()}}),r,this)})))}},{key:"clearMessage",value:function(){this.container&&this.message&&(this.container.style.display="none",this.message.innerHTML=""),s.f.stop("message-".concat(this.uid))}}]),t}();je.ERROR_MESSAGE="error",je.ERROR_COLOR="red",je.INFO_MESSAGE="info",je.INFO_COLOR="white",je.WARNING_MESSAGE="warning",je.WARNING_COLOR="yellow",n.d(e,"PanelCtrl",(function(){return Ue})),p.loadCss()}])}));
//# sourceMappingURL=module.js.map